Дата,Заголовок,Ссылка,Текст,Лайки
2022-12-24,Половой вопрос — 2,https://www.habr.com/ru/post/707514/,"UPD: “С пеной у рта доказывать правду неистово, смотрите-смотрите-смотрите, вот она истина». Модераторы заблокировали мне возможность комментировать мою же статью. Хотите дискуссию - пишите в личку.Стоит ли бороться за гендерное равенство? Автор популярной статьи ""Какие бы у меня возникли проблемы, если бы я боролся за гендерный баланс в ИТ?"" считает, что нет. Давайте разбираться по пунктам, в чём  он не прав.Статистика и исследованияЧто в РоссииА что если?Личная история и мамонтыВиноваты только мужчины?Почему половой вопрос - 2?Статистика и исследованияОдним из основных зарубежных трендов последних лет является тема диверсификации состава Советов директоров – представленности в советах директоров различного возраста, национальности и пола, что обеспечивает многосторонний взгляд на управление, увеличивает интерес инвесторов, позволяет снизить риски и повысить прибыль.  Исследования показывают, что чем выше доля женщин в высшем руководстве компании, тем выше прибыль ее акционеров. Например, за время исследования института Credit Suisse «The CS Gender 3000: вознаграждение за перемены» опережающая динамика компаний с 25% женщин на руководящих постах составила 2,8% ежегодного прироста (CAGR), а с более чем половиной женщин – 10,3%. У фирм, где у руля стоят в основном женщины, и сверх доходность по акциям – 12% ежегодно (с 2008 года), против 9% скорректированного ежегодного прироста по компаниям, входящим в индекс MSCI. Рынок готов платить за них премиальную цену в 19% по мультипликатору P/B (капитализация компании в ее отношении к балансовой стоимости).А вот другие исследования: у компаний, которым удалось увеличить присутствие женщин в СД и руководстве корпораций с 0 до 30%, маржа чистой прибыли в среднем возросла на 15%. В течение 24 месяцев после назначения женщин на позицию CEO наблюдался 20-процентный рост динамики цен на акции. При назначении женщины на позицию CFO – 6% рост прибыльности и 8% рост доходности акций.Свежие данные McKinsey&Company: компании, в которых доля женщин-управленцев более 30%, с большей вероятностью опередят по эффективности компании с долей женщин 10-30%. А те в свою очередь будут выглядеть лучше компаний, где доля женщин еще ниже или их нет совсем.Объем исследований, предметом которых является взаимосвязь между гендерным разнообразием и производительностью компаний, растет с каждым годом. В основном это данные, основанные на анализе деятельности компаний на развитых рынках. В России сообщество «Женщины в Советах директоров» впервые проанализировало деятельность в 2019 году ТОП-100 российских компаний – рост капитализации диверсифицированых компаний превысил среднерыночный на 30% (по медиане), а разница в динамике стоимости компаний со смешанными и моногендерными советами директоров составила 130% в пользу смешанных.В целом активизация признания женщин в качестве равных представителей в топ-менеджменте стало следствием кризиса 2008 года: именно тогда многим стало ясно, что компетенции женщин в риск-менеджменте учитывались слишком мало.Существует мнение, что одной из причин кризиса 2008 года было так называемое «групповое мышление». По мнению Главы МВФ Кристин Лагард мужское доминирование в банковской индустрии сделало крах Lehman Brothers более вероятным. Прошло больше 10 лет с кризиса Lehman Brothers, и директор МВФ Кристин Лагард активно говорит о важности диверсификации управленческих команд «Если бы вместо Lehman Brothers были бы Lehman Sisters, то мир был бы совсем иной».Что в России?Доля женщин в Советах директоров российских публичных компаний – одна из самых низких: в 3,2 раза меньше, чем в западноевропейских странах. Мужчины составляют 91-94 % членов Советов директоров. 43% российских компаний из ТОП-100 не имеют женщин в составе Советов.Женщины слабо представлены в органах политической власти. В 2019 г. в нижней палате парламента доля женщин составила 15,8%, в верхней – 18,2%. В региональных парламентах число женщин не превышает 15%.По показателю «Гендерное равенство» в последние 14 лет Россия ухудшает свои позиции. В рейтинге «Индекс гендерного разрыва» в 2006 г. страна занимала 49-е место, в 2016 г. – 75-е, в 2020 г. – 81-е из 153 стран. Позиции России ухудшились по параметрам: «экономическое участие и возможности» (22-е место в 2006 г. и 33-е – в 2020 г.) и «политическое участие» (108-е место в 2006 г. и 122-е – в 2020 г.)По оценкам Международной организации труда (МОТ), гендерный разрыв в оплате труда в России – 27,9% ­– не вызван объективными условиями рынка труда. По данным российских профсоюзов, разрыв составляет в среднем 40%. Разрыв в размерах пенсий мужчин и женщин увеличился с 5,5 % в 2016 г. до 11% в 2018 г.Женщины менее уверены в себе и в большинстве случаев согласны на любую работу, потому что женщине сложнее устроиться. 13,8% домохозяйств – одинокие матери, 27% таких семей за чертой бедности; каждый 3-ий плательщик алиментов не платит; 93% неимущих пенсионеров – женщины.А что если?Если бы в России экономическая активность женщин была бы такая же, как в Норвегии, то ВВП был бы на 4% выше и размер экономики был выше экономики Германии. Если бы Россия уравняла экономическую активность женщин и мужчин, то это добавило бы российскому ВВП 13–14%.Речь сейчас идет не просто о количественном увеличении доли женщин в руководстве. Я говорю о том, что на стратегическом уровне управления необходимо увеличивать долю самого многочисленного (54% населения России – женщины) и высококвалифицированного сегмента (63% высококвалифицированных специалистов –женщины) населения России. Это позволит управленческим командам выстроить более сбалансированную работу и принимать максимально эффективные решения.  Увеличение экономической активности женщин в России могло бы значительно подстегнуть рост российского ВВП. Уровень участия женщин в рабочей силе составил 55,4 % (мужчин – 70,6 %); уровень занятости – 52,9 % (мужчин – 67,3 %), уровень безработицы – 4,4 % (мужчин – 4,8 %) при том, что индекс человеческого развития женщин в России выше, чем у мужчин вследствие того, что женщины живут в среднем на 11 лет дольше и продолжительность обучения у них выше.По данным Минэкономразвития равный уровень занятости мужчин и женщин мог бы обеспечить рост ВВП на 13-14% или на 14 триллионов рублей. В чем причины того, что финансовые показатели компании выигрывают от гендерного разнообразия топ-менеджмента? Недопредставленность   женщин в корпоративных советах директоров может вести к увеличению факторов риска из-за недостаточного разнообразия точек зрения.Женщины контролируют 80% потребительских расходов. В эпоху диктата потребителя они определяют потребительские тренды;Компании с женщинами в советах директоров менее склонны к риску и имеют в среднем более низкий уровень долга;Компании, в состав советов которых входит больше женщин, с большей вероятностью «создают устойчивое будущее», в том числе путем создания сильных структур управления с высоким уровнем прозрачности;Сбалансированные советы показывают лучшую эффективность в периоды роста и кризисов;Женщины более ответственны, лучше ведут переговоры, они более терпеливы, более погружены в детали, более многофункциональны;Gender diversity способствует созданию среды, стимулирующей создание новых идей инновационное мышление;Диверсификация состава управленческих команд также способствует более качественному формированию пула талантов, так как 61% женщин смотрят на гендерное разнообразие руководства команды работодателя при выборе работы.Личная история и мамонтыХозяйка на кухне, шл.ха в постели, Игорь Владимирович на собрании совета директоров.Итак, лет пять назад меня попросили (вернее, уведомили через посредника) уволиться. Мне нравилась моя работа и я хотела вкладываться в то, что делаю. Однако когда я вернулась после декрета и сказала, что не хочу уходить, трое мужчин из совета директоров отвели меня в переговорку и сказали, что это решенный на их общем голосовании вопрос.«Понимаешь, Галя, это история. Мужчины охотятся на мамонтов. Женщины стоят у котла. Ты не будешь работать».Публично все мило улыбаются и говорят о том, что совсем не видят разницы между работником-мужчиной и женщиной. На практике дискриминация имеет место быть. И это происходит не только при приёме на работу. И не только со стороны мужчин.Виноваты только мужчины?Нет. Это общая проблема и предрассудки всего общества.«Бабушка пришла с подружками поплескаться в бассейне и привела внучку.– Какая ты вся красивая, ну только посмотрите! И купальник какой красивый! И бантики! И шапочка красивая! И сама ты очень-очень красивая! Вот красотулечка!!За 5 минут девочке успели раз тридцать сказать, что она – красивая.Я тихо корчилась за шкафчиком и внутри себя орала: «А еще умная и сильная! УМНАЯ И СИЛЬНАЯ! Ну скажи ты ей! Ну хотя бы – смелая!!!»Не. Красивая. Красивая и точка. Эх… Бесконечно говорить о том, что «ты у меня самая красивая» нужно взрослым девочкам, которых уже вырастили со вбитой в голову шпалой «ты существуешь, пока эстетична». Можно таймер ставить, раз в семь минут поднимать голову от монитора и как попка-дурак: «Кто тут такая раскрасавица? Лерочка тут такая раскрасавица!» А подрастающее поколение, как по мне, можно еще сберечь. Хвалить за что-то еще. За изобретательность, самостоятельность, за мнение свое.Я вот всех, кого вижу, стараюсь хвалить за смелость.Мне кажется, ее многим не хватает. Слишком мы травмированы тем, что любая инициатива наказуема».Когда я поступала в ВУЗ у меня был выбор. Матмех (где я набрала максимум баллов) или модный Гуманитарный факультет на кафедре Социологии. Выбрала ""модный"". Ой как пожалела. Потом думала, почему так получилось, ведь мне всегда нравилась математика и всё с ней у меня было замечательно. А было так.Во-первых, девушка должна быть литературно-подкована и многогранна. Гуманитарного склада ума. С ней должно быть ""о чём поговорить"", обсудить историю и философию. Это симпатичнее для большинства. Математички - просто заучки.Во-вторых, я понятия не имела в 2005, чем занимаются выпускники мат-меха. Гугла у меня не было. Был стационарный компьютер без интернета. Спросила в приёмной комиссии. Мне ответила философски - ""станешь кем угодно"". А мама предположила, что буду всю жизнь сидеть у компьютера. Такая перспектива меня напугала. Социология же обещала куда более интересную карьеру, да и для девочек подходила больше.Мы живем в мужском мире. Официально у всех равные права, но кто-то немного ровнее. И эта ситуация плохо влияет не только на женщин, но и на мужчин. Потому что им тоже задаются социальные роли - ""добытчик"", ""защитник"", ""герой"".Мужчины у нас не плачут, не ходят к психиатру и не жалуются. Достигаторы и вершители.Почему половой вопрос - 2?Потому что я уже писала здесь статью на эту тему и после этого меня отправили в бан.Статью удалили и я не успела собрать золотые комментарии. За час она собрала больше 6 тысяч просмотров, а все читатели разделились на 2 лагеря:Половой дискриминации не существует. Я все выдумала.Конечно, женщин реже берут на работу, потому что они от природы глупее, постоянно думают о детях и у них гормональные сбои - то ПМС, то недо*рах.У меня никак не получилось столкнуть этих комментаторов между собой. Они объединились в общем хоре: ""ох уж эта женская логика"".Считается, что проблема надуманная, а феминистки - это такие неудовлетворенные жизнью женщины, которые борются с ветряным мельницами.Считается, что работодателю без разницы, кого принимать на службу, лишь бы работник был хороший. И что нет никакой несправедливости в оплате труда женщин и мужчин. Просто мужчины добиваются обычно больших результатов.Считается, что анекдоты про женскую логику безобидны. И что женщина за рулём - это, конечно, забавно, но имеет место быть.Считается, что женщина имеет право на карьеру, но истинное её счастье - в семье. И нужно обязательно рассказать ей об этом, а то часики-то тикают.Считается, что раз встречаются женщины на руководящих постах или бизнесе, то проблемы в социуме нет. Вот оно равноправие. И таких женщин мало не потому, что пробиваются только сверхпрофессионалы, которые шли «вопреки». А потому что женщины природно немного глупее мужчин, и у них всегда меньше амбиций. А когда они рожают ребёнка, то становятся рассеянными и демотивированными, теряют квалификацию.ИсточникиСпасибо за предоставленные материалы и исследования Елене Речкаловой - независимому директору, члену советов директоров, заместителю сопредседателя Комиссии Российского союза промышленников и предпринимателей по банкам и банковской деятельности, в недавнем прошлом руководителю бизнеса лидирующих розничных банков, преподавателю Факультета финансов и банковского дела (ФФБ) РАНХиГС.   ",-31
2021-11-22,Половой отбор с точки зрения программиста,https://www.habr.com/ru/post/590729/,"Когда я был молодым наивным юношей, из полезных материалов был разве что труд Протопопова ""Трактат о любви, как ее понимает жуткий зануда"". Сейчас материалов куда больше - везде можно прочитать про ""баланс значимости"", ""френдзону"", даны названия разным явлениям, например, ""завиноватить"" итд.Однако, несмотря на то, что эта информация помогает с практической точки зрения, то есть отвечает на вопрос ""что делать"", мне хотелось бы сделать реверс-инжинеринг и разобраться, зачем это сделано, то есть зачем у нас в голове именно такая прошивка. В чем польза этого с эволюционной точки зрения?Для простоты представим ситуацию: молодой межпланетный Демиург в качестве курсовой работы получил планету Земля с примитивными людьми. Ему надо разработать прошивки для самцов и самок, чтобы homo могли максимально быстро развиваться и адаптироваться к совершенно непредсказуемому развитию общества и среды.Попытка номер 1Итак, наш начинающий демиург вначале начинает работать над прошивкой самок, потому что окончательный выбор осуществляют они (см. Протопопов и концепция ""незаменимости самки""). Первое, что ему приходит в голову при написании программы, это завязаться на какие-либо male.Hardware.Properties, например:ВолосатостьСилаБыстрота бегаРостГребень или пушистый хвост (см теория гандикапа)УмС последним пунктом все плохо, непонятно, как его оценивать (умен ли живущий с мамой Перельман?). Распознавалку остальных признаков написать просто, но все это ведет вид к эволюционному тупику - всегда можно представить изменения среды, когда данный признак пойдет во вред - например, надо прятаться, и рост вредит. Собственно, сложность задачи в том, что надо оптимизировать, как это можно определить в одной опции MS SQL:Поэтому ни на один признак в male.hardware мы опираться не можем. Грустный демиург отмечает этот факт и пишет, что в этом случае единственное, на что можно опираться - выживаемость. Выжил - молодец, можно спариваться.За свою работу демиург получает 3 с двумя минусами. В рецензии указано, что наблюдения о невозможности зацепиться за физические признаки разумны, но использования просто статистики выживаемости тоже есть эволюционный тупик - он загоняет вид в текущую оптимальную ""долину"" выживаемости, практически блокируя ""туннелирование"" через ""перевалы"" к другим возможностям. Демиургу дают вторую попытку.Попытка номер 2. SoftwareПоразмыслив, демиург решает использовать male.Software.Properties, полностью отказавшись от анализа male.Hardware (*)примечание о legacy кодеВ текущей версии homo не удалось вычистить полностью все завязки на male.Hardware, при прочих равных самки предпочитают крупных и сильных самцов, что не исключает успеха у таких людей как Стивен Хокинг.А именно, демиург решает использовать для анализа успешность самца, но тут же сталкивается с тем, что непонятно, как это закодировать. Разумеется, очевидные варианты типа:наличие короны на головеналичие приставки ""senior"" в названии должностимарка машиныколичество рабов, итдслишком локальны и специфичны для определенной исторической эпохи, они явно не тянут на универсальный вариант. Демиург снова хотел сдаться, но тут ему в голову приходит гениальная мысль: кто как не самец сам знает, успешен он или нет? По своему внутреннему ощущению, по настрою, по уверенности в себе. Вот этот признак и надо анализировать самкам. Причем с точки зрения теории гандикапа, этот признак хорош тем, что (как и требуется от гандикапных признаков) one can't fake it. Самодостаточность и спокойную уверенность в себе почти невозможно изображать, и точно нельзя изображать долго.Гениальность дизайнаВ данном подходе интересно то, что он нарушает идеологию 'более высокий уровень строится на более низком с инкапсуляцией того, что делается уровнем ниже'. В IT одной из таких внешне странных технологий является технология TRIM для SSD дисков.Лет 20 назад, до появления SSD дисков, технология, которая отбрасывает диску (то есть на самый низкий уровень) информацию о том, свободен сектор или нет (а это знает файловая система уровнем выше) казалась бы дикой и нарушающей базовые принципы дизайна.Дизайн полового отбора (гениально) создает поток информации, идущий от верхних уровней вниз. Если input для чувства голода это простой сигнал из желудка, то input для сексуальной привлекательности завязан на полный (но в значительной степени подсознательный!) анализ ситуации самцом. Высшие структуры коры мозга произведут вычисления (выдержит ли мой бизнес пандемию? или пора выпиливаться?) и отбросят результат вниз, на самоощущение, которое будет считано самкой, благодаря высокому EQ by design у females.Я восхищен гениальностью этого дизайна. Трудно представить себе более длинную петлю обратной связи, берущую ""вывод"" у самых высших функций мозга и закорачивающую этот вывод на вход одного из самых древних инстинктов.О прошивке самцовЕсли физические признаки самцов не так важны, как их soft (см. однако, замечание о legacy code), то оценка самок очень сильно завязаны на их фенотип, то есть hard. Впрочем, только тело рассматривать было бы слишком примитивно у социальных животных, поэтому самка своим видом передает ряд важных сообщений о том, как она устроена в жизни. И вот здесь вовсю расцвел принцип гандикапа - у homo, в отличие от павлинов с их хвостом, гандикап полностью переехал на ""женскую"" сторону.СвойствоВ чем гандикапMessage / сигнал самцуДлинные ногтиСложно работать физическимогу позволить не работатьДлинные волосыТребуют уходанеудобно в джунгляхрассадник паразитовесть время на этоза меня охотятся другиея живу в чистотеВысокие каблукинельзя быстро бегатьи не нужно, живу в безопасностиДлинные платьянельзя быстро бегатьуход за материей--//--я живу в чистотеО половом диморфизмеВикипедия относит homo sapiens к видам со средним уровнем полового диморфизма. Однако, в основном это относится к hardware. Как мы видили выше, для homo очень много ушло в software, и, споря с википедией, заявлю, что вид homo sapiens - это вид с чудовищно высоким уровнем диморфизма в software. Возьмем кошек. В природе они ловят мышей, а в квартире - ловят солнечные зайчики и мурлычат. При том, что опытный кошатник легко отличит кота от кошки по лицу, по поведению они мало отличаются - кроме времени течки, а наши кастрированные диванные друзья вообще практически никак не отличаются по поведению. А как у homo? Ниже пример несколько утрированный, так что отнеситесь к нему с долей юмора, но вот день сферического парня в вакууме:Поцарапали пару минут лицо бритвойЗакинули колеса в машинуПоехали на шиномонтажПринесли шины назадПописали кодПосмотрели о политике на форумеПоиграли в игруА как проходит день у, опять-таки, самочки в состоянии активного поиска (а люди сексуальны почти всегда, а не 10% времени, как кошки!)Утренний уход за собой, полтора часаФитнесСелфиИнстаграмШопинг, примеряшечкиШопинг, обувашечкиБровкиПрическаРесторанКлубЗанятия эти не имеют ничего общего с мужскими, математически говоря, эти вектора ортогональны друг другу. Конечно, пример несколько утрированный, хотя я знаю многих, кто живет именно так. Впрочем, ничего удивительного для вида, у которого инстинкт столь завязан на soft.Слив значимостиУ самцов есть в прошивке общая проблема. Предположим, вы выходите к своей машине и ее не обнаруживаете на том месте, где ее оставили. Эвакуировали? Украли? Нервы, достаем телефон, начинаем решать проблему. Это логично: проблема -> fix it. Мы не говорим: ну украли, и ладно, другую найду машину.К сожалению, в отношениях это приводит к обратному эффекту. Про слив значимости написано очень много, не буду повторяться, я просто хотел отметить две вещи:Этот мужской баг простителен, потому что растет из стандартного алгоритма (fix it)Я вижу забавную аллегорию такой ситуации с некоторыми играми, например, ""не брать червей"" - вы хотите сбросить червей всем силами, но наоборот, ходить с них как раз нельзя!Мы, технари, часто видим лучше и проще, чем психологи - гуманитарии. Так что давайте обсудим, с чем вы согласны, с чем - нет.",17
2011-06-09,Половой вопрос,https://www.habr.com/ru/post/121016/,"Регистрационные формы сегодня встречаются по всему интернету, и очень важно, чтобы они были составлены правильно. Информация, собираемая ими (такая как имя, возраст или пол), может быть использована сервисом для персонализированного взаимодействия с нами. Это ведет к ощущению комфорта на ресурсе, и следовательно повышает шансы на то, что пользователь вернётся на сайт. 

Тот факт, что пользователь посетил Facebook больше одного раза, и готов предоставить самую банальную информацию о себе, такую как пол, можно использовать как прогноз того, что он останется на сайте.Почему пол важен на фейсбуке

Получается, что даже такие, кажущиеся незначительными, данные о пользователе могут иметь большое значение, поэтому стоит потратить немного времени на то, чтобы убедиться, что вопросы, которые вы спрашиваете у пользователей, уместны и честны. Чтобы происллюстрировать это, давайте взглянем на вопрос о поле из примера выше. Многие сайты предоставляют лишь два варинта: 



Иногда можно встретить и третий вариант:



Хотя это и даёт возможность людям ускользнуть от предоставления информации, все равно такие формы не решают вопрос исключений (некоторые люди считают себя принадлежащими к обоим полам), но это не главная проблема. Она же состоит в том, что посетители не понимают, зачем от них требуются эти данные и как они будут использованны. 

Предлагается следующее решение, которое используется на оригинальном ресурсе bagcheck.com:


Такое решение, как убеждены авторы, показывает пользователям сайта, зачем их спрашивают о поле (и да, посетители их ресурса знают, что такое притяжательное местоимение!) Это так же заставляет их думать, что ресурс заботится об их персональных предпочтениях.",-6
2022-07-18,Половое созревание начинается все раньше. Почему — никто не знает,https://www.habr.com/ru/post/677528/,"Сегодня у некоторых девочек молочные железы начинают увеличиваться уже в 6-7 лет. Исследователи выясняют, какую роль в этом могут играть ожирение, химикаты и стресс.Марша Херман-Гидденс в конце 1980-х впервые заметила, что в физиологии маленьких девочек что-то начинает меняться. Тогда она руководила группой по изучению случаев насилия над детьми, работая в Медицинском центре при Университете Дьюка в Дареме, штат Северная Каролина. При осмотре девочек, подвергшихся насилию, доктор Херман-Гидденс заметила, что у некоторых из шести-семилеток уже начинала увеличиваться грудь.«Казалось, так не должно быть», — говорит Херман-Гидденс, ныне занимающая пост адъюнкт-профессора в Школе глобального общественного здравоохранения Университета Северной Каролины в Чапел-Хилле. Она задумалась, входят ли такие скороспелые девочки в группу риска по фактору возможного полового надругательства, но не смогла найти данные, которые позволили бы проследить, в каком возрасте начинается пубертат у девочек в США. Поэтому решила собрать эти данные сама.Спустя десять лет она опубликовала исследование, в котором были учтены более 17 000 девочек со всей страны, проходившие профилактический осмотр у педиатра. Количественный анализ показал, что в середине 1990-х увеличение груди у девочек (как правило, это первый признак полового созревания) начиналось примерно в десятилетнем возрасте, то есть, более чем на год раньше, чем фиксировалось ранее. Еще явственнее эта планка снизилась у черных девочек; у них грудные железы в среднем начинают развиваться в возрасте 9 лет.Медицинское сообщество было шокировано этими данными, многие усомнились в аховой новой тенденции, которую заприметила никому не известная терапевт-ассистент, вспоминает доктор Херман-Гидденс. По ее словам, они были ошеломлены.Но это исследование оказалось водоразделом в медицинском понимании пубертата. С тех пор прошло уже не одно десятилетие, и последующие исследования, проведенные в десятках стран, подтвердили: возраст полового созревания у девочек, начиная с 1970-х, снижается примерно на три месяца в десятилетие, начиная с 1970-х.  У мальчиков наблюдается схожий паттерн, правда, не столь ярко выраженный. Сложно отделить причину и следствие, но раннее половое созревание может отрицательно сказываться на здоровье, особенно у девочек. Девочки, сравнительно рано вошедшие в пубертат, находятся в группе риска по поводу депрессии, тревожности, алкогольной и наркотической зависимости и по другим психологическим проблемам – по сравнению со сверстницами, которые начали созревать позже. Кроме того, у таких скороспелых девочек уже в зрелом возрасте может быть повышен риск развития рака молочной железы или рака шейки матки.Неизвестно, какой фактор риска – или, вероятнее, комбинация таких факторов – лежит в основе такой нарастающей скороспелости, зависят ли её темпы от расы или от пола. По-видимому, некоторую роль играет ожирение, но им одним эти перемены не объяснить. Исследователи проверяют и другие потенциальные факторы влияния, в том числе, стресс, а также уточняют, какова может быть роль определенных веществ, входящих в состав пластика. По неизвестным причинам врачи во всем мире зафиксировали всплеск случаев раннего развития пубертата в период пандемии.«Эти явственные изменения наблюдаются у всех наших детей, и мы не знаем, как их предотвратить – даже если бы хотели, — говорит доктор Андерс Юль, педиатр-эндокринолог из Копенгагенского университета, недавно опубликовавший две исследовательские работы по данному феномену, — не знаем причину». ОжирениеПримерно в то время, когда доктор Херман-Гидденс опубликовала свою знаковую работу, исследовательская группа под руководством доктора Юля изучала развитие молочных желез на материале когортного исследования, в котором участвовали 1100 девочек из Копенгагена. Датчанки, в отличие от американок, развивались в соответствии с паттерном, давно фигурирующим в медицинской литературе: молочные железы у девочек начинали увеличиваться в среднем в 11 лет. «Мне довелось дать немало интервью по поводу американского “пубертатного бума”, мы тогда так назвали это явление, — говорит доктор Юль, — и я тогда сказал, что в Дании такого не происходит».   На тот момент доктор Юль предположил, что сравнительно раннее начало пубертатного периода в США может быть связано с детским ожирением, в Дании не наблюдавшимся.Еще в 1970-е ожирение у девочек называли причиной раннего возникновения первых месячных. С тех пор многочисленные исследования показали, что девочки с избыточным весом или ожирением обычно сталкиваются с месячными ранее, чем девочки, имеющие нормальный вес.В рамках одного исследования, растянувшегося на десятилетия и охватившего почти 1200 девочек из штата Луизиана (опубликовано в 2003 году) детское ожирение также связали с ранним началом менструаций. При каждом стандартном отклонении сверх стандартного детского веса вдвое возрастала вероятность, что менструации у данной девочки начнутся ранее 12 лет.В 2021 году исследователи из Британии обнаружили двойную функцию лептина. Этот гормон, выделяемый жировыми клетками, притупляет голод, а также воздействует на те зоны мозга, которые регулируют половое развитие. Мыши и люди с определенными генетическими мутациями, влияющими на эти зоны, претерпевают запоздалое половое развитие. «Думаю, вполне бесспорно, что в наши дни ожирение является основным фактором, способствующим раннему половому созреванию», — отмечает доктор Натали Шоу, педиатр-эндокринолог из Национального института экологической медицины, изучавшая воздействие ожирения на пубертат.Тем не менее, добавляет она, ранний пубертат наблюдается и у девочек с вполне нормальным весом. «Ожирением всего этого не объяснить», — говорит доктор Шоу, — «просто данное явление возникло слишком быстро». ХимикатыПримерно через десять лет после первого исследования Херман Гидденс доктор Юль стал отмечать, что и в Копенгагене стало расти количество сообщений о раннем половом созревании, в основном – о девочках, у которых в 7-8 лет округлялись молочные железы.«Тогда мы подумали, а насколько вообще реален этот феномен»? — сказал доктор Юль. Либо, предположил он, родители и врачи просто «истерят» из-за новостной повестки, сформировавшейся после исследования Херман-Гидденс?  Исследование от 2009 года, охватившее почти 1000 школьниц из Копенгагена, показало, что средний возраст укрупнения молочных желез снизился на год по сравнению с данными из более раннего упомянутого здесь исследования. Среднее значение немного не дотягивает до 10 лет, вообще у девочек по этому показателю наблюдается разброс от 7 до 12 лет. Кроме того, все раньше начинаются менструации – первый эпизод фиксируется примерно в 13 лет, то есть, примерно на 4 месяца ранее, чем наблюдалось прежде.  «Это очень явственное изменение за очень краткое время», — отмечает доктор Юль. Но, в отличие от врачей из США, он не склонен списывать все на ожирение: в 2009 году индекс массы тела у датских детей не изменился по сравнению с 1990-ми.Доктор Юль стал одним из самых активных апологетов альтернативной теории: ключевую роль играет химический фактор. Он сказал, что по результатам исследования 2009 года, раньше всех созревали те девочки, в моче у которых наблюдался наивысший уровень фталатов – веществ, добавляемых в пластик для повышения износоустойчивости. Фталаты сегодня везде, от винилового ламината до пищевой упаковки.Фталаты относятся к более широкому классу химикатов, называемых «эндокринными дизрапторами». Эти вещества влияют на функцию гормонов и за последние несколько десятилетий повсеместно распространились в окружающей среде. Но факты, которые позволили бы считать их причиной раннего полового созревания, пока неубедительны.В обзорной статье, опубликованной в апреле 2022 года, доктор Юль и команда его коллег проанализировали сотни исследований, посвященных эндокринным дизрапторам и рассматривающим их влияние на пубертат. Эти исследования весьма отличались с методологической точки зрения; одни проводились на мальчиках, другие на девочках, проверялись самые разные химикаты, причем, учитывалось их воздействие в разном возрасте. Наконец, для анализа удалось отобрать 23 исследования, достаточно схожих для прямого сравнения, но и этот анализ не выявил явной связи между конкретным химикатом и возрастом полового созревания.«Серьезный вывод заключается в том, что для исследования этого вопроса пока мало как публикаций, так и конкретных данных», — говорит доктор Расс Хаузер, эпидемиолог-эколог из Гарвардской школы общественного здоровья им. Т. Х. Чана и соавтор этого анализа.Доктор Хаузер говорит, что из-за такого дефицита данных многие ученые скептически восприняли эту теорию, но сам недавно написал о том, как эндокринные дизрапторы влияют на половое созревание у мальчиков. «Мы не располагаем достаточными данными, чтобы убедительно продемонстрировать вред конкретного класса химикатов». Стресс и ритм жизниРаннему половому созреванию (как минимум, у девочек) могут способствовать и другие факторы. Сексуальное насилие, пережитое в раннем детстве, связывают с ранним наступлением пубертата. Но причинно-следственные связи здесь провести сложно. Стресс или травма могут способствовать раннему половому развитию, либо, как предположила несколько десятилетий назад доктор Херман-Гидденс, те девочки, которые физически созревают раньше, могут чаще подвергаться домогательствам.По-видимому, те девочки, у чьих матерей были в анамнезе душевные расстройства также склонны к раннему достижению пубертата, равно как и девочки, не живущие со своими биологическими отцами. Некоторые составляющие образа жизни, например, гиподинамия, также связывают с изменениями в сроках наступления пубертата. А во время пандемии педиатры-эндокринологи со всего мира наблюдали рост сообщений о том, что у девочек раньше начинается пубертат. Исследование, опубликованное в Италии в феврале нынешнего года, затрагивает 328 девочек, обследованных в пяти клиниках из разных регионов страны за семимесячный период в 2020 году – в сравнении со 140 девочками, обследованными за тот же период в 2019 году (у мальчиков никаких отличий найдено не было). Вероятно, то же самое может происходить в Индии, Турции и США. «Я спрашивал коллег по всей стране, и мне отвечали, что, да, наблюдается примерно такой же тренд», — говорит доктор Пол Капловиц, почетный профессор педиатрии в Национальной детской больнице в Вашингтоне, округ Колумбия. Непонятно, обусловлен ли этот тренд возросшим стрессом, все более сидячим образом жизни или тем, что возраст родителей к моменту рождения ребенка все ближе к 40.Скорее всего, процесс обусловлен несколькими факторами одновременно. Многие из упомянутых проблем непропорционально более актуальны именно для семей с низким достатком, что отчасти может объяснять расовые отличия в сроках начала пубертатного периода у детей из США. Новая нормальность?На протяжении десятилетий в медицинской литературе стадии полового созревания определялись по так называемой шкале Таннера, в основу которой были положены тщательные наблюдения за развитием примерно 700 девочек и мальчиков в период с 1949 по 1971 год; эти дети жили в одном сиротском приюте в Англии.Согласно этой шкале, нормальное половое созревание начинается от 8 лет и старше у девочек или от 9 лет и старше у мальчиков. Если половое созревание начинается раньше этой отсечки, то врач проверяет ребенка на редкое гормональное отклонение, так называемое «преждевременное половое созревание центрального происхождения». В таком случае первые признаки пубертата могут возникать еще в раннем детстве. Детям с таким расстройством часто показана томография мозга и последующий прием рецептурных блокирующих препаратов, задерживающих половое созревание до нормального возраста.Но некоторые эксперты настаивают, что данный «тревожный порог» должен быть понижен. В противном случае, утверждают они, под наблюдение специалистов могут попадать совершенно здоровые дети, которые будут подвергаться ненужным медицинским вмешательствам – физически калечащим и при этом дорогим. «Существует и масса других данных, свидетельствующих, что 8 лет – неоптимальный порог для отсечения нормального от ненормального», — считает доктор Капловиц. В 1999 году он доказывал, что возраст начала полового созревания следует понизить до 7 лет у белых девочек и до 5 лет у черных. «Не задалось», — вспоминает он. Однако этот тезис был подкреплен недавним исследованием группы доктора Юля, согласно которому из 205 скороспелых детей младше 8 лет, прошедших томографию мозга, только у 1,8% девочек и 12,5% мальчиков были выявлены медицинские отклонения, свидетельствующие о преждевременном половом созревании центрального происхождения.Но понижение этого порога воспринимается противоречиво; многие педиатры настаивают, что риск возможных расстройств по-прежнему достаточно велик и оправдывает дополнительные предосторожности. Другие, например, доктор Херман-Гидденс, считают, что такие изменения свидетельствуют о полноценной проблеме в области общественного здравоохранения и на самом деле должны считаться частью нормы.  ",16
2011-02-07,Поиск подстроки и смежные вопросы,https://www.habr.com/ru/post/113266/,"Здравствуйте, уважаемое сообщество! Недавно на Хабре проскакивала неплохая обзорная статья о разных алгоритмах поиска подстроки в строке. К сожалению, там отсутствовали подробные описания каких либо из упомянутых алгоритмов. Я решил восполнить данный пробел и описать хотя бы парочку тех, которые потенциально можно запомнить. Те, кто еще помнит курс алгоритмов из института, не найдут, видимо, ничего нового для себя.

 Сначала хотел бы предотвратить вопрос «на кой это надо? все уже и так написано». Да, написано. Но во-первых, полезно знать как работает используемые тобой иструменты на более низком уровне чтобы лучше понимать их ограничения, а во-вторых, есть достаточно большие смежные области, где работающей из коробочки функции strstr() окажется недостаточно. Ну и в-третьих, вам может неповезти и придется разрабатывать под мобильную платформу с неполноценным runtime, а тогда лучше знать на что подписываетесь, если решитесь самостоятельно его дополнять (чтобы убедиться, что это не сферическая проблема в вакууме, достаточно попробовать wcslen() и wcsstr() из Android NDK).

А разве просто поискать нельзя?
Дело в том, что очевидный способ, который все формулирует как «взять и поискать», является отнюдь не самым эффективным, а для такой низкоуровневой и сравнительно частовызываемой функции это немаловажно. Итак, план такой:

Постановка задачи: здесь перечислены определения и условные обозначения.
Решение «в лоб»: здесь будет описано, как делать не надо и почему.
Z-функция: простейший вариант правильной реализации поиска подстроки.
Алгоритм Кнута-Морриса-Пратта: еще один вариант правильного поиска.
Другие задачи поиска: вкратце пробегусь по ним без подробного описания.



Постановка задачи
 Канонический вариант задачи выглядит так: есть у нас строка A (текст). Необходимо проверить, есть ли в ней подстрока X (образец), и если есть, то где она начинается. То есть именно то, что делает функция strstr() в C. Дополнительно к этому можно еще попросить найти все вхождения образца. Очевидно, что задача имеет смысл только если X не длинее A.
 Для простоты дальнейшего объяснения введу сразу пару понятий. Что такое строка все, наверное, понимают — это последовательность символов, возможно пустая. Символы, или буквы, принадлежат некоторому множеству, которое называют алфавитом (данный алфавит, вообще говоря, может не иметь ничего общего с алфавитом в бытовом понимании). Длина строки |A| — это, очевидно, количество символов в ней. Префикс строки A[..i] — это строка из i первых символов строки A. Суффикс строки A[j..] — это строка из |A|-j+1 последних символов. Подстроку из A будем обозначать как A[i..j], а A[i] — i-ый символ строки. Вопрос про пустые суффиксы и префиксы и т.д. не трогаем — с ними разобраться не сложно по месту. Еще есть такое понятие как сентинел — некий уникальный символ, не встречающийся в алфавите. Его обозначают значком $ и дополняют допустимый алфавит таким символом (это в теории, на практике проще применить дополнительные проверки, чем придумать такой символ, которого не могло бы оказаться во входных строках).
 В выкладках будем считать символы в строке с первой позиции. Код писать традиционно проще отсчитывая от нуля. Переход от одного к другому не составляет трудностей.

Решение «в лоб»
 Прямой поиск, или, как еще часто говорят, «просто взять и поискать»- это Первое решение, которое приходит в голову неискушенному программисту. Суть проста: идти по проверяемой строке A и искать в ней вхождение первого символа искомой строки X. Когда находим, делаем гипотезу, что это и есть то самое искомое вхождение. Затем остается проверять по очереди все последующие символы шаблона на совпадение с соответствующими символами строки A. Если они все совпали — значит вот оно, прямо перед нами. Но вот если какой-то из символов не совпал, то ничего не остается, как признать нашу гипотезу неверной, что возвращает нас к символу, следующему за вхождением первого символа из X.
 Многие люди ошибаются в этом пункте, считая, что не надо возвращаться назад, а можно продолжать обработку строки A с текущей позиции. Почему это не так легко продемонстрировать на примере поиска X=«AAAB» в A=«AAAAB». Первая гипотеза нас приведет к четвертому символу A: ""AAAAB"", где мы обнаружим несоответствие. Если не откатиться назад, то вхождение мы так и не обнаружим, хотя оно есть.
 Неправильные гипотезы неизбежны, а из-за таких откатываний назад при плохом стечении обстоятельств может оказаться, что мы каждый символ в A проверили около |X| раз. То есть вычислительная сложность сложность алгоритма O(|X||A|). Так поиск фразы в параграфе может и затянуться...
 Справедливости ради следует отметить, что если строки невелики, то такой алгоритм может работать быстрее «правильных» алгоритмов за счет более предсказуемого с точки зрения процессора поведения.

Z-функция
 Одна из категорий правильных способов поиска строки сводится к вычислению в каком-то смысле корреляции двух строк. Сначала отметим, что задача сравнения начал двух строк проста и понятна: сравниваем соответствующие буквы, пока не найдем несоответствие либо какая-нибудь из строк закончится. Рассмотрим множество всех суффиксов строки A: A[|A|..] A[|A|-1..],… A[1..]. Будем сравнивать начало самой строки с каждым из ее суффиксов. Сравнение может дойти до конца суффикса, либо оборваться на каком-то символе ввиду несовпадения. Длину совпавшей части и назовем компонентой Z-функции для данного суффикса.
То есть Z-функция — это вектор длин наибольшего общего префикса строки с ее суффиксом. Ух! Отличная фраза, когда надо кого-то запутать или самоутвердиться, а чтобы понять что же это такое, лучше рассмотреть пример.
 Исходная строка «ababcaba». Сравнивая каждый суффикс с самой строкой получим табличку для Z-функции:



суффикс
строка

Z


ababcaba
ababcaba
->
8


babcaba
ababcaba
->
0


abcaba
ababcaba
->
2


bcaba
ababcaba
->
0


caba
ababcaba
->
0


aba
ababcaba
->
3


ba
ababcaba
->
0


a
ababcaba
->
1




 Префикс суффикса это ничто иное, как подстрока, а Z-функция — длины подстрок, которые встречаются одновременно в начале и в середине. Рассматривая все значения компонент Z-функции, можно заметить некоторые закономерности. Во-первых, очевидно, что значение Z-функции не превышает длины строки и совпадает с ней только для «полного» суффикса A[1..] (и поэтому это значение нас не интересует — мы его будем опускать в своих рассуждениях). Во-вторых, если в строке есть некий символ в единственном экземпляре, то совпасть он может только с самим собой, и значит он делит строку на две части, а значение Z-функции нигде не может превысить длины более короткой части.
 Использовать эти наблюдения предлагается следующим образом. Допустим в строке «ababcabсacab» мы хотим поискать «abca». Берем эти строчки и конкатенируем, вставляя между ними сентинел: «abca$ababcabсacab». Вектор Z-функции выглядит для такой строки так:



a  b  c  a  $  a  b  a  b  c  a  b  с  a  c  a  b


17 0  0  1  0  2  0  4  0  0  4  0  0  1  0  2  0




 Если отбросить значение для полного суффикса, то наличие сентинела ограничивает Zi длиной искомого фрагмента (он является меньшей половиной строки по смыслу задачи). Но вот если этот максимум и достигается, то только в позициях вхождения подстроки. В нашем примере четверками отмечены все позиции вхождения искомой строки (отметьте, что найденные участки расположены внахлест друг с другом, но все-равно наши рассуждения остаются верны). 
 Ну, значит если мы сможем быстро строить вектор Z-функции, то поиск с его помощью всех вхождений строки сводится к поиску в нем значения ее длины. Вот только если вычислять Z-функцию для каждого суффикса, то будет это явно не быстрее, чем решение «в лоб». Выручает нас то, что значение очередного элемента вектора можно узнать опираясь на предыдущие элементы.
 Допустим, мы каким-то образом посчитали значения Z-функции вплоть до соответствующего i-1-ому символу. Рассмотрм некую позицию r<i, где мы уже знаем Zr.
Значит Zr символов начиная с этой позиции точно такие же, как и в начале строки. Они образуют так называемый Z-блок. Нас будет интересовать самый правый Z-блок, то-есть тот, кто заканчивается дальше всех (самый первый не в счет). В некоторых случаях самый правый блок может быть нулевой длины (когда никакой из непустых блоков не покрывает i-1, то самым правым будет i-1-ый, даже если Zi-1= 0).

 Когда мы будем рассматривать последующие символы внутри этого Z-блока, сравнивать очередной суффикс с самого начала не имеет смысла, так как часть этого суфикса уже встречалась в начале строки, а значит уже была обработана. Можно будет сразу пропускать символы аж до конца Z-блока.


 А именно, если мы рассматриваем i-й символ, находящийся в Zr-блоке, то есть соответствующий символ в начале строки на позиции k=i-r+1. Функция Zk нам уже известна. Если она меньше, чем оставшееся до конца Z-блока расстояние Zr-(i-r), то сразу можем быть уверены, что вся область совпадения для этого символа лежит внутри r-того Z-блока и значит результат будет тот же, что и в начале строки: Zi=Zk. Если же Zk >= Zr-(i-r), то Zi тоже больше или равна Zr-(i-r). Чтобы узнать насколько именно она больше, нам надо будет проверять следующие за Z-блоком символы. При этом в случае совпадения h этих символов с соответствующими им в начале строки, Zi увеличивается на h: Zi=Zk + h. В результате у нас может появиться новый самый правый Z-блок (если h>0).

 Таким образом, сравнивать символы нам приходится только правее самого правого Z-блока, причем за счет успешных сравнений блок «продвигается» правее, а неуспешные сообщают, что вычисление для данной позиции окончено. Это обеспечивает нам построение всего вектора Z-функции за линейное по длине строки время.
 Применив этот алгоритм для поиска подстроки получим сложность по времени O(|A|+|X|), что значительно лучше, чем произведение, которое было в первом варианте. Правда, нам пришлось хранить вектор для Z-функции, на что уйдет дополнительной памяти порядка O(|A|+|X|). На самом деле, если не нужно находить все вхождения, а достаточно только одного, то можно обойтись и O(|X|) памяти, так как длина Z-блока все-равно не может быть больше чем |X|, кроме этого можно не продолжать обработку строки после обнаружения первого вхождения.
 Напоследок, пример функции, вычисляющей Z-функцию. Просто модельный вариант без каких либо хитростей.


void z_preprocess(vector<int> & Z, const string & str)
{
        const size_t len = str.size();

        Z.clear();
        Z.resize(len);
        if (0 == len)
                return;

        Z[0] = len;

        for (size_t curr = 1, left = 0, right = 1; curr < len; ++curr)
        {
                if (curr >= right)
                {
                        size_t off = 0;
                        while ( curr + off < len && str[curr + off] == str[off] )
                                ++off;
                        Z[curr] = off;
                        right = curr + Z[curr];
                        left = curr;
                }
                else
                {
                        const size_t equiv = curr - left;
                        if (Z[equiv] < right - curr)
                                Z[curr] = Z[equiv];
                        else
                        {
                                size_t off = 0;
                                while ( right + off < len && str[right - curr + off] == str[right + off] )
                                        ++off;
                                Z[curr] = right - curr + off;
                                right += off;
                                left = curr;
                        }
                }
        }
}



Алгоритм Кнута-Морриса-Пратта (КМП)
 Не смотря на логическую простоту предыдущего метода, более популярным является другой алгоритм, который в некотором смысле обратный Z-функции — алгоритм Кнута-Морриса-Пратта (КМП). Введем понятие префикс-функции. Префикс-функция для i-ой позиции — это длина максимального префикса строки, который короче i и который совпадает с суффиксом префикса длины i. Если определение Z-функции не сразило оппонента наповал, то уж этим комбо вам точно удастся поставить его на место :) А на человеческом языке это выглядит так: берем каждый возможный префикс строки и смотрим самое длинное совпадение начала с концом префикса (не учитывая тривиальное совпадение самого с собой). Вот пример для «ababcaba»:



префикс
префикс
p


a
a
0


ab
ab
0


aba
aba
1


abab
abab
2


ababc
ababc
0


ababca
ababca
1


ababcab
ababcab
2


ababcaba
ababcaba
3 




 Опять же наблюдаем ряд свойств префикс-функции. Во-первых, значения ограничены сверху своим номером, что следует прямо из определения — длина префикса должна быть больше префикс-функции. Во-вторых, уникальный символ точно так же делит строку на две части и ограничивает максимальное значение префикс-функции длиной меньшей из частей — потому что все, что длиннее, будет содержать уникальный, ничему другому не равный символ.
 Отсюда получается интересующий нас вывод. Допустим, мы таки достигли в каком-то элементе этого теоретического потолка. Это значит, что здесь закончился такой префикс, что начальная часть совпадает с конечной и одна из них представляет «полную» половинку. Понятно, что в префиксе полная половинка обязана быть спереди, а значит при таком допущении это должна быть более короткая половинка, максимума же мы достигаем на более длинной половинке.
 Таким образом, если мы, как и в предыдущей части, конкатенируем искомую строчку с той, в которой ищем, через сентинел, то точка вхождения длины искомой подстроки в компоненту префикс-функции будет соответствовать месту окончания вхождения. Возьмем наш пример: в строке «ababcabсacab» мы ищем «abca». Конкатенированный вариант «abca$ababcabсacab». Префикс-функция выглядит так:



a  b  c  a  $  a  b  a  b  c  a  b  с  a  c  a  b


0  0  0  1  0  1  2  1  2  3  4  2  3  4  0  1  2




 Снова мы нашли все вхождения подстроки одним махом — они оканчиваются на позициях четверок. Осталось понять как же эффективно посчитать эту префикс-функцию. Идея алгоритма незначительно отличается от идеи построения Z-функции.

 Самое первое значение префикс-функции, очевидно, 0. Пусть мы посчитали префикс-функцию до i-ой позиции включительно. Рассмотрим i+1-ый символ. Если значение префикс-функции в i-й позиции Pi, то значит префикс A[..Pi] совпадает с подстрокой A[i-Pi+1..i]. Если символ A[Pi+1] совпадет с A[i+1], то можем спокойно записать, что Pi+1=Pi+1. Но вот если нет, то значение может быть либо меньше, либо такое же. Конечно, при Pi=0 сильно некуда уменьшаться, так что в этом случае Pi+1=0. Допустим, что Pi>0. Тогда есть в строке префикс A[..Pi], который эквивалентен подстроке A[i-Pi+1..i]. Искомая префикс-функция формируется в пределах этих эквивалентных участков плюс обрабатываемый символ, а значит нам можно забыть о всей строке после префикса и оставить только данный префикс и i+1-ый символ — ситуация будет идентичной.

 Задача на данном шаге свелась к задаче для строки с вырезанной серединкой: A[..Pi]A[i+1], которую можно решать рекурсивно таким же способом (хотя хвостовая рекурсия и не рекурсия вовсе, а цикл). То есть если A[PPi+1] совпадет с A[i+1], то Pi+1=PPi+1, а иначе снова выкидываем из рассмотрения часть строки и т.д. Повторяем процедуру пока не найдем совпадение либо не дойдем до 0.

 Повторение этих операций должно насторожить — казалось бы получается два вложенных цикла. Но это не так. Дело в том, что вложенный цикл длиной в k итераций уменьшает префикс-функцию в i+1-й позиции хотя бы на k-1, а для того, чтобы нарастить префикс-функцию до такого значения, нужно хотя бы k-1 раз успешно сопоставить буквы, обработав k-1 символов. То есть длина цикла соответствует промежутку между выполнением таких циклов и поэтому сложность алгоритма по прежнему линейна по длине обрабатываемой строки. С памятью тут такая-же ситуация, как и с Z-функцией — линейная по длине строки, но есть способ сэкономить. Кроме этого есть удобный факт, что символы обрабатываются последовательно, то есть мы не обязаны обрабатывать всю строку, если первое вхождение мы уже получили.
Ну и для примера фрагмент кода:


void calc_prefix_function(vector<int> & prefix_func, const string & str)
{
    const size_t str_length = str.size();

    prefix_func.clear();
    prefix_func.resize(str_length);
    if (0 == str_length)
        return;

    prefix_func[0] = 0;

    for (size_t current = 1; current < str_length; ++current)
    {
        size_t matched_prefix = current - 1;
        size_t candidate = prefix_func[matched_prefix];
        while (candidate != 0 && str[current] != str[candidate])
        {
            matched_prefix = prefix_func[matched_prefix] - 1;
            candidate = prefix_func[matched_prefix];
        }

        if (candidate == 0)
            prefix_func[current] = str[current] == str[0] ? 1 : 0;
        else
            prefix_func[current] = candidate + 1;
    }
}


Не смотря на то, что алгоритм более замысловат, реализация его даже проще, чем для Z-функции.

Другие задачи поиска
 Дальше пойдет просто много букв о том, что этим задачи поиска строк не ограничиваются и что есть другие задачи и другие способы решения, так что если кому не интересно, то дальше можно не читать. Эта информация просто для ознакомления, чтобы в случае необходимости хотя бы осознавать, что «все уже украдено до нас» и не переизобретать велосипед.
 Хоть вышеописанные алгоритмы и гарантируют линейное время выполнения, звание «алгоритма по умолчанию» получил алгоритм Бойера-Мура. В среднем он тоже дает линейное время, но еще и имеет лучше константу при этой линейной функции, но это в среднем. Бывают «плохие» данные, на которых он оказываются не лучше простейшего сравнения «в лоб» (ну прямо как с qsort). Он на редкость запутан и рассматривать его не будем — все-равно не упомнить. Есть еще ряд экзотических алгоритмов, которые ориентированы на обработку текстов на естественном языке и опираются в своих оптимизациях на статистические свойства слов языка.
 Ну ладно, есть у нас алгоритм, который так или иначе за O(|X|+|A|) ищет подстроку в строке. А теперь представим, что мы пишем движок для гостевой книги. Есть у нас список запрещенных матерных слов (понятно, что так не поможет, но задача просто для примера). Мы собираемся фильтровать сообщения. Будем каждое из запрещенных слов искать в сообщении и… на это у нас уйдет O(|X1|+|X2|+...+|Xn|+n|A|). Как-то так себе, особенно если словарь «могучих выражений» «великого и могучего» очень «могуч». Для этого случая есть способ так предобработать словарь искомых строк, что поиск будет занимать только O(|X1|+|X2|+...+|Xn|+|A|), а это может быть существенно меньше, особенно если сообщения длинные.
 Такая предобработка сводится к построению бора (trie) из словаря: дерево начинается в некотором фиктивном корне, узлы соответствует буквам слов в словаре, глубина узла дерева соответствует номеру буквы в слове. Узлы, в которых заканчивается слово из словаря называются терминальными и помечены неким образом (красным цветом на рисунке).

 Полученное дерево является аналогом префикс-функции алгоритма КМП. С его помощью можно найти все вхождения всех слов словаря в фразе. Надо идти по дереву, проверяя наличие очередного символа в виде узла дерева, попутно отмечая встречающиеся терминальные вершины — это вхождения слов. Если соответствующего узла в дереве нет, то как и в КМП, происходит откат выше по дереву по специальным ссылкам. Данный алгоритм носит название алгоритма Ахо-Корасика. Такую же схему можно применять для поиска во время ввода и предсказания следующего символа в электронных словарях.
 В данном примере построение бора несложно: просто добавляем в бор слова по очереди (нюансы только с дополнительными ссылками для «откатов»). Есть ряд оптимизаций, направленный на сокращение использования памяти этим деревом (т.н. сжатие бора — пропуск участков без ветвлений). На практике эти оптимизации чуть ли не обязательны. Недостатком данного алгоритма является его алфавитозависимость: время на обработку узла и занимаемая память зависят от количества потенциально возможных детей, которое равно размеру алфавита. Для больших алфавитов это серьезная проблема (представляете себе набор символов юникода?). Подробнее про это все можно почитать в этом хабратопике или воспользовавшись гуглояндексом — благо инфы по этомоу вопросу много.
 Теперь посмотрим на другую задачу. Если в предыдущей мы знали заранее, что мы должны будем найти в поступающих потом данных, то здесь с точностью до наоборот: нам заранее выдали строчку, в которой будут искать, но что будут искать — неизвестно, а искать будут много. Типичный пример — поисковик. Документ, в котором ищется слово, известен заранее, а вот слова, которые там ищут, сыпятся на ходу. Вопрос, опять же, как вместо O(|X1|+|X2|+...+|Xn|+n|A|) получить O(|X1|+|X2|+...+|Xn|+|A|)?
 Предлагается построить бор, в котором будут все возможные суффиксы имеющейся строки. Тогда поиск шаблона сведется к проверки наличия пути в дереве, соответствующего искомому шаблону. Если строить такой бор перебором всех суффиксов, то эта процедура может занять O(|A|2) времени, да и по памяти много. Но, к счастью, существуют алгоритмы, которые позволяют построить такое дерево сразу в сжатом виде — суффиксное дерево, причем сделать это за O(|A|). Недавно на Хабре была по этому поводу статья, так что интересующиеся могут прочитать про алгоритм Укконена там.
 Плохо в суффиксном дереве, как обычно, две вещи: то, что это дерево, и то, что узлы дерева алфавитозависимы. От этих недостатков избавлен суффиксный массив. Суть суффиксного массива заключается в том, что если все суффиксы строки отсортировать, то поиск подстроки сведется к поиску группы расположенных рядом суффиксов по первой букве искомого образца и дальнейшего уточнения диапазона по последующим. При этом сами суффиксы в отсортированном виде хранить незачем, достаточно хранить позиции, в которых они начинаются в исходных данных. Правда, временные зависимости у данной структуры несколько хуже: единичный поиск будет обходиться O(|X| + log|A|) если подумать и сделать все аккуратно, и O(|X|log|A|) если не заморачиваться. Для сравнения в дереве для фиксированного алфавита O(|X|). Но зато то, что это массив, а не дерево, может улучшить ситуацию с кэшированием памяти и облегчить задачу предсказателю переходов процессора. Строится суффиксный массив за линейное время с помощью алгоритма Kärkkäinen-Sanders (уж извините, но плохо представляю как это должно звучать на русском). Нынче это один из самых популярных методов индексирования строк.
 Вопросов приближенного поиска строк и анализа степени похожести мы тут касаться не будем совсем — слишком большая область для того, чтобы запихнуть в эту статью. Просто упомяну, что там люди зря хлеб не ели и придумали много всяких подходов, поэтому если столкнетесь с подобной задачей — найдите и почитайте. Весьма возможно такая задача уже решена.

 Спасибо тем, кто читал! А тем, кто дочитал досюда, спасибо особенное!

UPD: Добавил ссылку на содержательную статью про бор (он же луч, он же префиксное дерево, он же нагруженное дерево, он же trie).",79
2020-04-30,[Вопрос] В России запрещено порно?,https://www.habr.com/ru/company/vdsina/blog/467535/,"
По закону порнографией может быть признано что угодно: литература, предметы, программный код, аудио, танцы, хлебобулочные изделия

Я взрослый человек. Могу ли я легально смотреть порно, сохранять порно на компьютер, снимать домашнее порно или стримить его через веб-кам сервисы, находясь в России? Удивительно, но однозначного ответа на этот вопрос нет.

Из-за правовых коллизий нет четкого ответа, можно ли взрослым людям употреблять порно в любом виде или нет. Формально запрещено только незаконное производство и распространение порнографии, но нигде не упоминается, что такое законное порно, и может ли оно существовать. Также закон не дает определения того, что такое порно для взрослых. Из-за этого порнографией может быть признано все, что угодно: литература, рисунки, предметы, песни и т.д.

Вы смотрите порно? Чувствуете себя преступником? 

Внимание: в статье рассматривается только порно со взрослыми совершеннолетними людьми, предназначенное для таких же взрослых людей. Проблемы возрастных ограничений не затрагиваются.

Что такое порно?
Правовая часть вопроса отлично разобрана в статье Натальи Богатыревой на Т—Ж: Хочу снимать порнофильмы. Что мне за это будет? Я буду пользоваться выдержками из этой статьи, но рекомендую сперва прочитать ее для лучшего погружения в тему.

Думаете порно это только видео и картинки? Нет, в законе нет четкого определения что такое порно для взрослых людей, и каждый раз это решается индивидуально. Если эксперты решат, что ваш код это порно — будьте добры отсидеть в тюрьме. 

В 2010 году появились новые законы, с которыми пришли блокировки интернета: ФЗ «О защите детей от информации, причиняющей вред их здоровью и развитию» ст. 2 ФЗ от 29.12.10 № 436-ФЗ. В них появилось определения порнографии, но только в контексте информации для несовершеннолетних.
Определение применимо только для решения вопросов о возрастной маркировке продукции. Порнография — это натуралистические изображения или описания:
* Половых органов человека.
* Полового акта.
* Сопоставимого действия сексуального характера, в том числе в отношении животного.
Наталия Богатырева, Тинькоф журнал

Распространение порно
Итак, я, взрослый мужчина, решил посмотреть порно. Чтобы это сделать, мне нужно, чтобы его кто-то предварительно изготовил и распространил. По закону последнее является уголовным преступлением.
 Согласно уголовному кодексу нельзя:

Изготавливать и перевозить через границу России порнографические материалы или предметы в целях распространения, публичной демонстрации или рекламирования.
Распространять, публично демонстрировать или рекламировать порнографические материалы или предметы.

ч. 1 ст. 242 УК РФ

Наверняка многие помнят истории, как люди лайкали видео вконтакте, после чего ролик добавлялся к ним на страницу, и за это их судили за распространение порно. Распространение порнографии через интернет — это отягчающее обстоятельство. Наказание за это строже. Можно получить срок от двух до шести лет. Как судят за порно-картинки в личной переписке вконтакте.

Из этого следует, что любой порнографический контент, опубликованный в интернете, даже пересланный в личных сообщениях или по почте — есть уголовное преступление. Из этого у меня следует вопрос: когда вы смотрите порно в интернете, ощущаете ли соучастие в чем-то, за что могут посадить на шесть лет? 

Блокировка порносайтов
Если любое распространение порно запрещено, значит и все сайты под запретом. Так, например, в какой-то момент Роскомнадзор забанил Pornhub, а потом разбанил, когда на сайте появилась авторизация через Вконтакте для подтверждения возраста. При этом в самом Вконтакте порно едва ли меньше чем на PornHub и без всякой проверки возраста. То есть тут явно заявляется, что взрослым порно смотреть можно. Но почему тогда блокируются все другие порно-сайты, например торрент-трекеры? Какой в этом смысл? И почему тогда людей судят за добавление в избранное порновидео?


Главная страница PornHub при запросе с российского IP требует авторизоваться через Вконтакте.

PornHub достаточно популярен в России, очень много моделей и пар снимают свои домашние видео в раздел PornHub Community. По букве закона — за это грозит шесть лет тюрьмы. Но как на самом деле?

Я лично не вижу в действиях исполнительной власти никакой логики и последовательности. В связи с этим у меня есть целый ряд вопросов, на которые никто не может внятно ответить. 

Можно смотреть порно?
Под смотреть я имею в виду скачивать себе на компьютер, лайкать на сайтах и добавлять в избранное, комментировать видео, сохранять в закладки.

Можно хранить порно?
Пока я смотрю видео в браузере, оно сохраняется у меня на компьютере и будет доступно без интернета, то есть сохранено на компьютер — это по сути хранение. Является ли это уголовным преступлением? 

Можно ли снимать порно?
Что если у нас с женой отличная 4K камера, осветительные приборы и желание снять домашнее порно, на сколько лет нас за это посадят? Можно ли эту запись хранить дома? А показывать друзьям на вечеринках? А что, если залить ее в PornHub Community? 

Можно ли хостить порно?
Что если я захочу не заливать наше домашнее видео на PornHub, а захочу захостить его на своем сервере? Можно ли мне так же, как PornHub-у повесить плашку 18+ и меня не забанят и не посадят? Или это работает иначе? Можно ли покупать сервера для этого в России или нужно только зарубежом? 

Ответ Vdsina
Мы стараемся исполнять законодательство Российской Федерации и поэтому на серверах расположенных в дата-центрах РФ размещать порно у нас нельзя. Однако у нас также доступны серверы в Нидерландах, где размещать порно с совершеннолетними можно без ограничений. 

",66
2020-03-25,Выпуск#33: ITренировка — актуальные вопросы и задачи от ведущих компаний,https://www.habr.com/ru/company/spice/blog/494054/,"Привет! У кого какой день карантина? Побочная сила коронвариуса — он убил все остальные новости. А все остальные новости, как известно, плохие, так что это хорошая новость. 


В общем, мы посовещались и решили на этой неделе предложить задачки на тему… вирусов. Спокойно, заразиться через их решения нельзя )

Мойте руки, оставайтесь дома, не трогайте свое лицо, ждите ответов на задачки ровно через неделю.

P.S. Ответы на задачки из прошлого выпуска уже опубликованы.

Вопросы
1. Diseases and Tests
Dinoo is worried that he might have a rare disease. He decides to get himself tested, and suppose that the testing methods for this disease are correct 99 percent of the time (in other words, if he has the disease, it shows that he does with 99 percent probability, and if he doesn’t have the disease, it shows that he does not with 99 percent probability). Suppose this disease is actually quite rare, occurring randomly in the general population in only one of every 10,000 people.
If his test results come back positive, what are his chances that he actually have the disease?

A. 0.99
B. 0 .90
C. 0.10
D. 0.01
ПереводДину беспокоится, что у него может быть редкая болезнь. Он решает пройти тестирование и предполагает, что методы тестирования на эту болезнь верны в 99 процентах случаев (другими словами, если у него есть болезнь, тест покажет, что он болен с 99-процентной вероятностью, а если у него нет болезни, тест покажет, что он не болен с 99-процентной вероятностью). Предположим, что это заболевание на самом деле довольно редкое, случайно встречающееся в общей популяции только у одного из каждых 10 000 человек.
Если результаты его анализов окажутся положительными, каковы его шансы на то, что он действительно болен этой болезнью?
2. Strict Pill Schedule Problem
You are on a strict medical regimen that requires you to take two types of pills each day. You must take exactly one A pill and exactly one B pill at the same time. The pills are very expensive, and you don’t want to waste any. So you open the bottle of A pills and tap one out into your hand. Then you open the bottle of B pills and do the same thing – but you make a mistake, and two B pills come out into your hand with the A pill. But the pills are all exactly identical. There is no way to tell A pills apart from B pills. Is it possible to satisfy your regimen and take exactly one of each pill at the same time, without wasting any pills?


ПереводВы находитесь на строгом медицинском режиме, который требует от вас принимать два типа таблеток каждый день. Вы должны принять ровно одну таблетку A и ровно одну таблетку B одновременно. Таблетки очень дорогие, и вы не хотите тратить их впустую. Итак, вы открываете пузырек с таблетками A и вытряхиваете одну из них себе на ладонь. Затем вы открываете флакон с таблетками В и делаете то же самое – но вы ошибаетесь, и две таблетки B высыпаются в вашу руку вместе с таблеткой А. Но таблетки все совершенно одинаковые. Нет никакого способа отличить таблетки A от таблеток B. Можно ли соблюсти в данном случае свой режим и принять ровно по одной таблетке в одно и то же время, не тратя впустую таблеток?
Задачи
1. Задача о вирусе в колонии бактерий
В колонию, состоящую из N бактерий, попадает один вирус. В первую минуту он уничтожает одну бактерию, затем делится на два новых вируса. Одновременно каждая из оставшихся бактерий тоже делится на две новые. В следующую минуту возникшие два вируса уничтожают две бактерии, и затем оба вируса и все оставшиеся бактерии снова делятся и так далее.

Будет ли эта колония при указанных условиях жить бесконечно долго или в конце концов погибнет?
2. Sort the way!
A new deadly virus has infected large population of a planet. A brilliant scientist has discovered a new strain of virus which can cure this disease. Vaccine produced from this virus has various strength depending on midichlorians count. A person is cured only if midichlorians count in vaccine batch is more than midichlorians count of person. A doctor receives a new set of report which contains midichlorians count of each infected patient, Practo stores all vaccine doctor has and their midichlorians count. You need to determine if doctor can save all patients with the vaccines he has. The number of vaccines and patients are equal.

Input Format:
First line No of test cases t followed by contains the number of vaccines — N. Second line contains N integers, which are strength of vaccines. Third line contains N integers, which are midichlorians count of patients.

Output Format:
Print a single line containing ′1′ for Yes or '0' for No.

Constraints:
1<=T<=150
1<=N<=10
Strength of vaccines and midichlorians count of patients fit in integer.

Sample Input:
2
5
123 146 454 542 456
100 328 248 689 200
8
87 93 50 22 63 28 91 60 
64 27 41 27 73 37 12 69 

Sample Output:
0
ПереводНовый смертельный вирус заразил большинство населения планеты. Ученый открыл новый штамм вируса, который может вылечить эту болезнь. Вакцина, полученная из этого вируса, имеет различную силу в зависимости от количества мидихлорианов. Человек вылечивается только в том случае, если количество мидихлорианов в партии вакцины больше, чем количество мидихлорианов в человеке. Врач получает новый набор отчетов, который содержит количество мидихлорианов каждого инфицированного пациента, Practo хранит все вакцины, которые есть у врача, и их количество мидихлорианов. Вам нужно определить, может ли врач спасти всех пациентов с помощью вакцин, которые у него есть. Количество вакцин и пациентов одинаково.

Входной формат:
Первая строка содержит количество тестов t, за которой следует число вакцин — N. Вторая строка содержит N целых чисел, которые являются силой вакцин. Третья строка содержит N целых чисел, которые являются количеством мидихлориан у пациентов.

Выходной формат:
Выведите одну строку, содержащую «1» для да или «0» Для нет.

Ограничения:
1<=T<=150
1<=N<=10
Сила вакцин и количество мидихлорианов у пациентов укладываются в целое число.

Пример входных данных:
2
5
123 146 454 542 456
100 328 248 689 200
8
87 93 50 22 63 28 91 60 
64 27 41 27 73 37 12 69 

Пример вывода:
0
Ответы
Вопрос 1Ответ D — вероятность того, что у него есть эта болезнь, меньше 1 процента.

Объяснение:
После обсуждения причин удивительной вероятности (ниже) вы должны увидеть, как изменение параметров влияет на результат. Был бы результат столь же удивительным, если бы болезнь была более распространенной? Как изменится вероятность, если вы допустите, что процент ложных подтверждений и ложных отрицаний был разным?

Этот факт может быть выведен с помощью так называемой теоремы Байеса, которая помогает нам найти вероятность события A при условии события B, записанного P (A|B) с точки зрения вероятности события B при условии события A, записанного P (B|A) и вероятностей A и B:
P(A|B) = P(A)P(B|A) / P(B) => P(B) = P(A)P(B|A)/P(A/B)

В нашем случае событие А — это событие, когда у него есть эта болезнь, а событие В — это событие, когда тест положителен.
Таким образом, P(B|not A) — это вероятность “ложноположительного результата”: что у него положительный тест, даже если у него нет болезни. Здесь P (B|A)=0.99, P (A)=0.0001, и P (B) может быть выведено путем обусловливания того, происходит ли событие A или нет:
P(B)=P(B|A)P(A)+P(B|not A)P(not A) или 0.99*0.0001+0.01*0.9999.
Таким образом, соотношение, которое вы получаете из теоремы Байеса, составляет менее 1 процента.

Основная причина, по которой мы получаем такой удивительный результат, заключается в том, что болезнь настолько редка, что число ложных срабатываний значительно превышает число людей, которые действительно болеют этой болезнью. Это можно увидеть, подумав о том, что мы можем ожидать в 1 миллионе случаев. Из этих миллионов человек около 100 будут иметь эту болезнь, и около 99 из этих случаев будут правильно диагностированы как имеющие ее. В противном случае около 999 900 из миллиона не будут иметь заболевания, но из этих случаев около 9999 из них будут ложноположительными (результаты тестов, которые являются положительными из-за ошибок). Итак, если его анализы положительны, то вероятность того, что у него действительно есть болезнь, составляет около 99/(99+9999), что дает примерно ту же долю, что и выше 0.0098 или менее 1 процента!
Вопрос 2Решение: 
Шаг 1: Разрежьте каждую таблетку пополам.

Шаг 2: Возьмите одну половину от каждой пары и сформируйте две пары, скажем, пару А и пару В.

Шаг 3: Возьмите еще одну таблетку из флакона А, разрежьте ее пополам.

Шаг 4: Положите каждую половинку в обе пары. Теперь каждая стопка содержит две половинки от каждого типа таблеток, поэтому вы просто берете одну из стопок (а другую на следующий день).

Задача 1Ответ: колония обречена.

Решение. Легко проверить, что количество бактерий и вирусов будет меняться со временем по следующему закону:


Отсюда ясно, что при t = N количество бактерий обратится в ноль.
Задача 2#include<iostream>
using namespace std;
int main()
 {
	int t;
	cin>>t;
	while(t--)
	{
	    int n,p=1;
	    cin>>n;
	    int a[n],b[n];
	    for(int i=0;i<n;i++)
	    cin>>a[i];
	    for(int i=0;i<n;i++)
	    cin>>b[i];
	    sort(a,a+n);
	    sort(b,b+n);
	    for(int i=0;i<n&&p;i++)
	    if(a[i]<b[i])
	    p=0;
	    cout<<p<<""\n"";
	}
	//code
	return 0;
}",4
2012-11-25,Доброфон — бесплатные телефонные консультации по любым вопросам,https://www.habr.com/ru/post/150234/,"

Иногда у нас возникает внезапная необходимость поговорить с живым человеком. Спросить совета, получить консультацию, поделиться идеей, рассказать смешную историю или просто поговорить ни о чем. Не всегда бывает удобно беспокоить этим друзей.

Мы попробовали решить эту задачу и сделали Доброфон – горячую линию куда можно позвонить в любое время и поговорить с реальным человеком тет–а–тет. Операторы разделены на категории в зависимости от квалификации и пола. 
Все, разумеется, бесплатно и создано исключительно для эстетического удовольствия. 

В Доброфон можно позвонить через: 


Skype
Стационарный телефон — доступны прямые номера во многих странах и шлюзы в крупных городах
Приложение вконтакте
WebRTC-виджет (работает только в браузере Chrome)
Flash-виджет
Веб-интерфейс Gmail и Google Talk
iNUM
SIP


В статье будет описана техническая сторона организации call-центра и тонкости подключения всех внешних линий. 



Бекенд работает на asterisk. Все входящие линии, соответственно, подключены к нему.
Операторы подключаются к серверу через SIP. 

Все операторы разделены на три категории и имеют соответствующий трехзначный внутренний номер:


1. Квалифицированные операторы  (внутренние номера 1xx) — как правило, это люди, имеющие высшее образование и профессионально разбирающиеся в какой-то области. 
2. Операторы девушки (внутренние номера 2xx) — валидирована только половая пренадлежность и отсутствие дефектов речи
3. Операторы мужчины (внутренние номера 3xx) — валидирована только половая пренадлежность и отсутствие дефектов речи


Все аккаунты занесены статические очереди в queues.conf согласно своей категории. Плюс четвертая категория «случаный оператор» в которой звонок направляется всем операторам сразу. 

Из конфигов asterisk примечательным является только extensions.conf[internal]

;; разрешаем операторам звонить друг другу по внутренним номерам
 exten => _XXX,1,Dial(SIP/${EXTEN},60,tT)
 exten => _XXX,n,Hangup

[default]

;; From call@dobrofon.com
exten => call,1,Goto(menu,s,1)
exten => call,n,Hangup()

;; Звонки с tropo.com на skype
exten => trop,1,Set(CALLERID(name)=${CALLERID(num)}); Заносим Skype-логин из callerid(num) в callerid(name)
exten => trop,n,Set(CALLERID(num)=Skype); В callerid(num) записываем строку Skype
exten => trop,n,Goto(menu,s,1)
exten => trop,n,Hangup()

;; From Skype Connect 
exten => 99051000164280,1,Set(CALLERID(num)=Skype); В callerid(num) записываем строку Skype, при этом в callerid(name) уже есть Skype-логин звонящего
exten => 99051000164280,n,Goto(menu,s,1)
exten => 99051000164280,n,Hangup()

;; From FlashWidget 
exten => flash,1,Set(CALLERID(num)=Flash) ;;; В callerid(num) записываем строку Flash
exten => flash,n,Goto(menu,s,1)
exten => flash,n,Hangup()

;;;;;;;
;;;;;;; Main menu
;;;;;;;

[menu]
 exten => s,1,Answer()
 exten => s,2,Background(hello); запись «вас приветствует доброфон»
 exten => s,3,ExecIf($[${CALLERID(num)} = Skype]?Wait(1)
 exten => s,4,ExecIf($[${CALLERID(num)} = Skype]?Background(dialpad); Если звонят со скайпа проиграть запись о том что нужно включить номеронабиратель в верхней части окна
 exten => s,5,ExecIf($[${CALLERID(num)} = Skype]?Wait(1)
 exten => s,6,Background(main); Основное меню 
 exten => s,n,WaitExten(2)

;; cлучайный оператор
 exten => 0,1,Set(CALLERID(num)=${CALLERID(num)}_R); К строке callerid(num) дописывается название категории которую выбрал звонящий, чтобы оператор имел представление о том что хочет услышать звонящий.
 exten => 0,n,Playback(connect)
 exten => 0,n,Queue(random,tT,,,40) ;; подождать 40 секунд и если никто не взял трубку проиграть «все операторы заняты»
 exten => 0,n,Playback(busy)
 exten => 0,n,Hangup()

exten => 1,1,Set(CALLERID(num)=${CALLERID(num)}_Vip)
 exten => 1,n,Playback(connect)
 exten => 1,n,SIPAddHeader(Alert-Info: <Bellcore-dr5>) ;; Передать в заголовке мелодию звонка (для телефонов Cisco)
 exten => 1,n,Queue(vip,tT,,,40)
 exten => 1,n,Playback(busy)
 exten => 1,n,Hangup()

exten => 2,1,Set(CALLERID(num)=${CALLERID(num)}_Girls)
 exten => 2,n,Playback(rita_begin)
 exten => 2,n,Queue(girls,tT,,,40)
 exten => 2,n,Playback(rita_end)
 exten => 2,n,Hangup()

exten => 3,1,Set(CALLERID(num)=${CALLERID(num)}_Boys)
 exten => 3,n,Playback(connect)
 exten => 3,n,Queue(boys,tT,,,40)
 exten => 3,n,Playback(busy)
 exten => 3,n,Hangup()

;; прямой набор внутреннего номера оператора
 exten => _8XXX,1,Set(CALLERID(num)=${CALLERID(num)}_Direct)
 exten => _8XXX,n,SIPAddHeader(Alert-Info: <Bellcore-dr1>)
 exten => _8XXX,n,Dial(SIP/${EXTEN:1:3},60,tT)

exten => 9,1,Set(CALLERID(num)=${CALLERID(num)}_BOSS)
 exten => 9,n,SIPAddHeader(Alert-Info: <Bellcore-dr1>)
 exten => 9,n,Dial(SIP/100)

;; Timeout random queue 
 exten => t,1,Goto(0,1)

;; Wrong ext 
 exten => i,1,Background(invalid)
 exten => i,n,Goto(s,6)


При такой конфигурации операторы могут видеть через какую входящую линию звонит пользователь и какую цифру (категорию) он выбрал. Так например при звонке через Skype и выборе случайной категории — оператор видит строку Skype_R в поле CallerID(num) и skype-логин звонящего в поле CallerID(name) в своем sip-клиенте.

Так это выглядит на стороне оператора в SIP-клиенте eyeBeam:



Политика дозвона в очередях такова: звонок отправляется всем операторам из выбранной категории одновременно, звонок забирает первый ответивший оператор. 

Операторы могут переводить активный звонок друг другу через blind transfer (решетка и внутренний номер) так и через обычный трансфер (сначала оператор ставит активный звонок на удержание, звонит другому оператору, срашивает «можно я тебе переведу такого-то клиента» и после переводит)

Входящие каналы

Наиболее интересной частью является устройство входящих каналов. Я разберу каждый канал в отдельности.
Ни один из перечисленных ниже провайдеров не платил нам за рекламу (хотя мы и не против), и все описанное является результатом моих личных изысканий. 

Skype

Раньше основной Skype-аккаунт у нас был dobrofon.com
Это бизнес-аккаунт подключенный к услуге Skype Connect, по цене 5€ за одну конкурирующую линию (подробно этот сервис описывается здесь habrahabr.ru/post/144465).

В процессе использования выяснилось, что Skype Connect это обычный аккаунт с настроенной безусловной переадресацией на номер +990. Это виртуальные номера в сети Skype предназначенные для приземления звонков. Звонки на эти номера возможны только из сети Skype и не тарифицируются. 

Стоимость тарифа Skype Connect формируется из количества необходимых конкурирующих линий. То есть если вы хотите иметь возможность принять 10 параллельных звонков через свой Skype-логин, тариф будет 50€ в месяц. 
Но тут открылся интересный хак: количество параллельных линий лимитируется только самим номером +990 который вам выдают, в то время как Skype-логин никак не ограничивается количество параллельных звонков. Из этого следует что если переадресовывать звонки на другой номер, который, например, покрывается подпиской, можно получить аналог Skype Connect за меньшие деньги. Например купить подписку на городские телефоны Москвы, купить многоканальный номер +7(495) и переадресовывать звонки на него. В таком случае количество параллельных линий будет ограничиваться на стороне SIP-провайдера, и Skype Connect можно вообще не покупать. Так же Skype бесплатно звонит на Toll Free номера в Америке (+1800, +1888).

Когда-то давно Skype очень плотно сотрудничал с провайдером Voxeo.com. С тех пор у Voxeo есть пул номеров +990 которые он раздает бесплатно всем желающим через дочерний сервис tropo.com(Этот сервис настолько прекрасен что я расскажу о нем подробно далее). При этом не накладывая жестких ограничений на количество параллельных линий. (На самом деле ограничения есть, но они меряются всплесками при >100 звонков в минуту). Получив такой номер у Voxeo можно изготовить аналогичный SkypeConnect-у аккаунт бесплатно. Правда Voxeo объявил о прекращении поддержки номер +990, так что в скором времени эти номера будут отключены. 

Теперь основной способ дозвона через Skype — это бесплатный номер +990009369990067870

Стационарные телефоны

Мы покупаем прямой московский номер +7 (499) 504-82-76 у Zadarma.com. 

Прямые номера в этих странах нам бесплатно предоставляет провайдер Voxeo:


Так же доступны шлюзы в крупных городах список шлюзовПри дозвоне через шлюзы, используйте добавочный номер 01488

Россия, Екатеринбург +7 (343) 236-62-39
Россия, Нижний Новгород +7 (831) 429-03-34
Россия, Новосибирск +7 (383) 289-98-58
Россия, Санкт-Петербург +7 (812) 309-02-59
Россия, Челябинск +7 (351) 750-35-69
Великобритания, Бирмингем +44 (121) 279-03-24
Великобритания, Ливерпуль +44 (151) 209-01-04
Великобритания, Лондон +44 (20) 3298-41-31
Израиль, Иерусалим +972 (2) 569-50-85
Казахстан, Алматы +7 (727) 323-13-42
Латвия, Рига +371 (67) 88-15-29
Литва, Вильнюс +370 (5) 259-61-71
США, Нью-Йорк +1 (718) 831-71-56

На самом деле этот список намного больше, поэтому если вашего города в нем не оказалось, напишите мне об этом.


Flash-виджет

Наиболее больной вопрос — это звонки через прямо из браузера через Flash. 
Содержать собственный Flash Media Server очень дорого и неудобно. Бесплатные его аналоги вроде RED5 работает очень плохо. Сращивать его с SIP тем более трудоемкая задача. 

Есть несколько провайдеров которые предоставляют услугу Click-to-call виджета для сайта. 
Перепробовав все которые удалось найти, выяснилось, что единственный провайдер который обеспечивает приемлемое качество связи Zingaya.com.
У всех остальных ужасное качество звука, задержки, отсутствие у виджета цифровой клавиатуры и другие недостатки. 


Кроме этого, Zingaya, позволяет передавать произвольный CallerID при звонке. Таким образом при звонках из приложения вконтакте, оператор может видеть ссылку на профиль звонящего.

С недавнего времени Chrome полноценно поддерживает WebRTC. Вместе с этим Zingaya добавили поддержку WebRTC в свой виджет, так что при звонках через хром не используется Falsh и задержки намного лучше. 

GoogleTalk, Gmail и iNum

Наш номер в сети iNum: +883510001340589

GoogleTalk позволяет бесплатно звонить на номера сети iNum.
 Можно также звонить из веб-интерфейса Gmail если установить плагин.


С номером iNum можно делать много чего еще интересного, подробнее об этом можно прочесть в гугле.

SIP

Основной SIP-аккаунт: call@dobrofon.com

Можно также позвонить через внутренние номера некоторых sip-провайдеров. Они перечислены на сайте. 



FAQ

Зачем все это надо? 

Просто так. Мы считаем, что человеческое общение одно из наиболее ценных вещей в жизни. 

Кто операторы?

Добровольцы которым интересно. 

Как стать оператором? 

Любой желающий, при наличии микрофона, SIP-клиента и внятной речи может стать оператором. В первой категории, например, много IT-профессионалов которые скучают на работе, так что ее можно использовать как бесплатную тех. поддержку. 

Для того, чтобы получить внутренний номер, нужно написать мне или ohm в инбокс

Как еще можно участвовать? 

Так мы занимаемся доброфоном исключительно в свободное время, реализовать все задумки не получается из-за нехватки времени. Поэтому к участию приглашаются все: программисты (asterisk, веб-фронтенд, flash, webrtc), дизайнеры, верстальщики и все остальные кто считает что может чем-либо помочь.",111
2010-03-26,"Еще раз о времени, деньгах, свободе, здоровье и других ресурсах личности, а также о двух ее половинках",https://www.habr.com/ru/post/88976/,"В продолжение темы: раз, два, три, четыре.

Сразу скажу, что подход к разгорающемуся холивару «время vs. деньги» (а точнее к вопросу управления личными ресурсами), которого я придерживаюсь, позаимствован мной из вебинара, выложенного в записи на сайте datnews.ru, а автор этого сайта скорее всего позаимствовал его у Тима Ферриса или еще какого-нибудь гуру лайф-менеджмента, и в принципе является самоочевидной истиной, которую, однако, почему-то мало кто способен правильно усвоить и использовать.

Вкратце, подход состоит в следующем: у каждого из нас есть набор уникальных ресурсов, которые в процессе нашей жизнедеятельности могут конвертироваться друг в друга (или расходоваться впустую), но возможности этой конвертации ограничены самими имеющимися ресурсами. То есть они конвертируются не прямо пропорционально и даже не с фиксированным процентом затрат (как валюты в обменнике), а в зависимости от доступного в данное время их количества. Правило первое и последнее: если нам остро не хватает какого-нибудь ресурса, мы вынуждены компенсировать его, расходуя непропорционально большие объемы других ресурсов. Следовательно, стратегия оптимального развития заключается в поддержании долгосрочного баланса между разными типами ресурсов, дабы не было необходимости «топить ассигнациями». В краткосрочном периоде наоборот — локальная концентрация выгоднее, чем соблюдение баланса ради баланса, ибо самые актуальные проекты и проблемы не признают никаких расписаний.



Ресурсами личности можно назвать следующее: время, деньги, свобода, здоровье, эмоциональный ресурс («позитив») и, возможно, еще какие-то. Прежде всего важно определить, какие из них являются для тебя, %username%, самыми дефицитными и проблемными — то есть какие ресурсы оттягивают на себя больше всего других ресурсов, и профиксить эти дыры. Чаще всего, по закону Парето, имеется несколько самых проблемных «бутылочных горлышек», устранение которых способно принести самый значительный результат (дальше уже начинается педантизм и/или гуризм). В упомянутом выше вебинаре один из участников завел спор, является ли ресурсом (в данном значении) информация. Сошлись на том, что не является, поскольку информацию нельзя расходовать (тратить). Информация, однако, может быть составляющей некоего процесса вопроизводства личных ресурсов (времени, денег, здоровья...), то есть «ресурсом» вспомогательным — как и любые знания, навыки, умения и т. д. Помимо участия в процессах воспроизводства ресурсов, эти «скиллы» могут служить индикаторами личных достижений, атрибутами развития личности (которое не следует сводить к одному лишь воспроизводству/умножению ресурсов, но и противопоставлять ему не стоит, как это делают иные «романтики»). Достаточно развитые, уникальные, ценные достижения можно назвать смыслами. Произведение искусства, научное открытие, олимпийский рекорд, инновационный стартап. Классические дерево, дом, ребенок (почему обязательно сын?) — тоже. Подлинный креатив, имхо, заключается именно в придумывании новых смыслов и их реализации. Ключевое отличие ресурсов от смыслов в том, что первые являются «расходным материалом», а вторые расходовать невозможно. Часто употребляемые понятия «средство» и «цель» имеют несколько другой оттенок (цель может стать средством для достижения новой цели, при этом не всякое средство представляет собой ограниченный ресурс).

Выше я упоминал о проблемах, которые может принести дефицит какого-либо ресурса, а что же произойдет при его избытке? Прежде всего нужно отметить, что избытка ресурсов по определению быть не может; превышение какого-либо ресурса над остальными следует рассматривать как нехватку всех остальных и именно на них фокусировать внимание. В некоторых случаях это может оказаться довольно сложной задачей; широко известны примеры выигрышей в лотерею, которые не пошли на пользу их обладателям, или случаи резкой деградации личности при выходе на пенсию. Нечто похожее в свое время один SEOшник назвал «золото-шмоточным периодом».

Поговорим теперь о конкретных ресурсах и о стратегиях, которых стоит придерживаться при их осознаваемом дефиците, адекватном количестве или количестве, существенно превышающем текущие потребности.

1. Деньги. «Когда нет денег» — нет сами знаете чего, как говорил Шнур. Эта ситуация знакома практически каждому, главное здесь — так вложить имеющиеся альтернативные ресурсы, чтобы оборот первого возрастал, а по ходу генерировались знания, опыт и другие рычаги. И смыслы тоже. Доступ к знаниям — первый шаг к выходу из нищеты и не только финансовой, о чем многие из нас, к сожалению, забывают. Подобная стратегия применима и в ситуации, когда первого ресурса хватает (разве что смыслов при этом требуется больше, они позволяют не терять драйв, сохранять ресурс «позитив» и ему подобные). Самое же сложное — когда денег вдруг становится больше в разы. Для того, чтобы эти деньги использовались по назначению, необходима хорошо продуманная стратегия их вложения, чем могут похвастаться немногие. В противном случае превышение денег над остальными ресурсами может сработать против развития личности, нанести удар в спину. Выскажусь экстремально: если у вас нет плана, куда вложить миллиард долларов, вы рискуете получить его под нос и задохнуться.

2. Время. Здесь ключевой момент в том, что времени у всех равное количество — что у бомжа, что у БГ. Имеется в виду текущее время, расходуемое на рутинные дела и краткосрочные проекты. (Некоторые включают в эту категорию еще и общее время жизни и предполагаемые качественные его свойства (возраст), однако такой подход, о чем я дополнительно еще расскажу, таит в себе очень большой и, к сожалению, распространенный в нашем обществе косяк. Очевидно, что продолжительность и качество жизни опираются главным образом на ресурс «здоровье», см. ниже.)  Текущее (регулярное) время представляет собой последовательность вложенных циклов разного уровня: 1) природный цикл (сутки); 2) социальный (неделя); 3) далее идет еще один всем известный цикл, который для женского пола является природным, а для близко общающихся с женским полом — скорее социальным:); и наконец 4) еще один природный цикл (год). Циклическое распределение обуславливает различия в возможностях конвертации между ресурсом «время» и другими ресурсами и в затратах на такую конвертацию. Опять же, действует правило: краткосрочный дисбаланс — благо, если он направлен на обеспечение долгосрочного баланса; долгосрочный дисбаланс — зло.

Исходя из того, что признаком оптимального подхода к ресурсу «время» является значимое увеличение со временем стоимости времени в других ресурсах (для чего требуется формировать скиллы и другие вспомогательные рычаги) при одновременном перемещении фокуса с простого воспроизводства ресурсов на создание смыслов, попробуем оценить подходы авторов упомянутых в начале четырех хабрапостов.

Пост первый («100 долларов в час»). Автор довел стоимость своего ресурса «время» до этой цифры явно не сразу, а в результате планомерной реализации какой-то стратегии. Автор понимает важность баланса и подчеркивает, что не является сторонником тотальной монетизации в ущерб неденежным ресурсам и смыслам. В целом, стратегию автора можно определить как оптимальную (скорее всего, у него есть или готовятся планы, как повысить стоимость часа до 200 долларов, опять же не в ущерб остальной жизни).

Пост второй («Какое время — деньги?») — это попытка критики стратегии первого автора, направленная, однако, в пустоту. Скорее всего, второй автор прочитал пост первого бегло, не вчитываясь в детали. Иначе бы он понял, что никакой тотальной монетизации первый автор не проповедует. Речь идет о максимально эффективном использовании именно времени, выделенного на конвертацию в деньги.

Третий пост («Мое время бесценно») представляет собой рассказ об использовании свободного времени в эмоциональном стиле. Из него сложно понять, на каком уровне цены рабочего времени находится автор сегодня и на какой он вступит завтра, но в целом создается впечатление сбалансированного подхода, реализуемого достаточно давно и успешно, чтобы не иметь необходимости продавать дополнительное время по цене покупателя. Здесь может вызывать озабоченность только долгосрочная устойчивость стратегии перед особо крупными рисками (если темпы развития слишком медленны; чтобы понять, так ли это, нужно знать контекст).

Четвертый пост («О времени и деньгах») подчеркивает важность интенсивного вложения ресурсов (в том числе и свободного времени) с прицелом на будущее. Он как раз о том, как обеспечить рост, развитие, дабы завтра свободного времени было больше и его можно было меньше тратить на работу. Франклин не упоминал о термодинамике и не цитировал древний принцип «Non progredi est regredi», но это сделаю я. Альтернативы подходу «вложить сегодня рубль, чтобы получить завтра два» не существует. Отказ от вложения (абсолютная инертность) ведет в буквальном смысле к смерти, что подтверждается примерами не только личностей, но и целых обществ. Энтропия, однако. Развитие — залог не только самого развития, но и вообще выживания. И хватит искать отмазки так называемого цивилизационного характера, либо ты двигаешь мир вперед, либо потребляешь усилия тех, кто это делает вместо тебя. Никто не обречен на лузерство просто потому, что он родился «не там» или «не тем». Всем нам круто повезло уже хотя бы тем, что мы живем на Земле в 2010 году (и имеем хорошие шансы попасть в 2100 и 2200 и расширить свою сферу обитания, о чем стоит написать отдельно, пока лишь скажу пару ключевых слов «трансгуманизм», «космизм», «сингулярность»). Дорогу осилит идущий.

Перейдем к остальным ресурсам. 3. Свобода. Это ресурс, трудно поддающийся измерению, у которого есть два аспекта: объективный и субъективный. Объективная потребность в свободе состоит в необходимости гибкого реагирования «на ходу» на изменчивые внешние обстоятельства. От ее отсутствия может пострадать самый эффективный, но при этом жестко прописанный план. Субъективный аспект ресурса «свобода» — в его взаимосвязи с другими ресурсами: если какой-либо план делает человека рабом, он мало того что может объективно выгореть, так еще и подорвет остальные ресурсы человека, отбросив его назад. Такие явления, как карьерные кризисы и дауншифтинг — прямое следствие игнорирования потребности в свободе в корпоративных условиях. Однако дауншифтерский подход лично мне сложно назвать элементом оптимальной стратегии развития после неоптимальной карьерной горячки. Скорее это реакция, вынужденная мера в ответ на исчерпание ресурса «свобода». Оптимальный путь состоит в том, чтобы не попадать в подобные ловушки. Хотя, может быть, в будущем самые перспективные занятия и будут осуществляться в режиме «забег на длинную дистанцию + длительный отдых», что с учетом увеличения продолжительности жизни не будет считаться такой бессмысленной потерей времени, как это выглядит сейчас для людей с карьерными и жизненными установками по умолчанию.

4. Здоровье. Парадокс этого ресурса в том, что несмотря на его ключевую важность для продуктивного использования всех остальных ресурсов и для самой жизни вообще, мало кто уделяет ему должное внимание. Причина это опять же в привычке поведения по умолчанию, отталкиваясь от окружающего общества и от опыта прошлого. Человек, ведущий не особо здоровый образ жизни, поступает так скорее всего по двум причинам: 1) «потому что все так делают»; 2) «потому что я так делал раньше». Ситуация усугубляется тем, что если такой человек решит встать на здоровый путь, он сразу столкнется с ограничением возможностей — как личных финансовых (временных и т. д.), так и текущих успехов человечества в укреплении состояния уже изношенного организма; а также, из-за выхода из «зоны комфорта», с эмоциональными неудобствами. Преодолеть все эти тернии и выйти к «звездам», мягко говоря, трудно.

Все же есть у меня причины для оптимизма ввиду того, что человечество, хоть и со скрипом, наращивает темпы медицинских достижений и речь уже заходит, кроме всего прочего, о перспективах увеличения максимальной продолжительности жизни и беспрецедентного повышения ее качества (омоложение, регенерация органов и еще более фантастические перспективы), и эта тема получает все больше внимания. Осознание реальности этих перспектив само по себе способно стать мотивирующим фактором, а понимание необходимости вкладываться для того, чтобы увеличить свой шанс дожить до их реализации и доступности — стимулирует предпринимать специальные действия по укреплению собственного ресурса «здоровье». (Я лично знаю не одного человека, проникшегося ЗОЖ после прочтения книг Ю. А. Никитина и/или некоторых футурологических прогнозов.) Пускать же этот ресурс на самотек все опаснее. «Инвестиции в здоровье», «управление здоровьем» — это уже не роскошь, а необходимость. Оздоровлению образа жизни также способствует распространение новых форм занятости и карьеры, когда традиционные пятничные пьянки вытесняются более здравыми способами времяпровождения по чисто материальным соображениям.

5. Эмоциональный ресурс («позитив», «энергия», «драйв» etc.). Этот ресурс с одной стороны прост, с другой — сложен, и кроме того очень индивидуален. Скажу только, что мало просто достичь позитивного эмоционального состояния, замотивировать себя «конфеткой». Необходимо еще обеспечить, чтобы оно долго держалось и не требовало частой подзарядки сомнительными и затратными методами. Устойчивости может способствовать сбалансированное управление всей совокупностью личных ресурсов, при котором процесс их конвертации, воспроизводства и «прокачки» сопровождается созданием разноплановых и актуальных смыслов и всевозможными трудноописуемыми субъективными ощущениями высокого уровня. Больше, в принципе, говорить нечего. Нужно действовать.

Таковы основные выделяемые мной ресурсы личности. Не удивлюсь, если в комментариях увижу дополнения к этому списку. Он не является законченным и исчерпывающим, тут важен принцип: есть уникальные не сводимые друг к другу напрямую ресурсы, их стоит выделить и научиться ими управлять. Возможно, стоит выделить такой ресурс, как внимание, или какие-то ресурсы, связанные с социумом, с близостью общения.

Напоследок пару слов о противостоянии, которое я заметил между некоторыми из вышеупомянутых постов, написанных по сути об одном и том же на разных «языках». У каждого здорового человека есть два полушария мозга и две половины личности — грубо говоря, рациональная и эмоциональная. И часто бывает так, что одна из этих половин начинает угнетать другую, что приводит ко всяческим неприятным вещам. В частности, это может выражаться в отрицательной реакции на текст, написанный в стиле другой половины, или на ее методы поведения. Вот и в данном случае налицо недовольство одного из авторов якобы «неправильным» подходом другого, хотя в действительности это всего лишь реакция на непривычную форму выражения мыслей. Я, например, скорее рационалист. Мне доставляет удовольствие сам процесс, к примеру, познания через формулу, «почему небо голубое». А вот однажды я встретил человека, который рассказывал об этой формуле совсем в другом ключе: мол, после ее изучения он перестал радоваться голубому небу так, как раньше. Или кто-то там чуть ли не давится пивом из-за того, что вспоминает, что оно состоит из атомов%(. Нечто подобное произошло и здесь. Один хабраюзер увидел, что другой меряет время деньгами, и сразу же поспешил прочитать мораль, почему так делать нельзя и как следует относиться ко времени. Третий хабраюзер на это ответил своим, кардинально отличным подходом, подкрепленным исторической цитатой. Чей же подход правильнее?

По-настоящему продуктивный путь состоит в использовании преимуществ «альтернативного способа мышления» вместо попыток его подавить. Я. однако, не буду здесь петь дифирамбы тотальному релятивизму, абсолютной толерантности и прочим симптомам постмодернизма головного мозга. Здесь очень важно различать, где заканчивается конструктивная деятельность «другой стороны» и начинается посягательство на твою территорию, и предупреждать его. Прежде всего, продуктивное взаимодействие необходимо наладить между содержимым собственной черепной коробки. Как и с ресурсами, недостатки слабого звена здесь способны свести на нет преимущества сильного — там когнофобия, тут эмоциональное выгорание. Кстати, у успешных хакеров, а также у представителей ряда других интересных профессий и вообще людей с неординарными способностями, по некоторым данным, особо развиты именно связи между двумя полушариями мозга и между различными его отделами. Именно они, по всей видимости, определяют способность к использованию того способа мышления, который лучше всего соответствует ситуации, вместо малоконструктивной борьбы за доминирование. Какая-то половина в конкретном случае все равно оказывается развитее другой, но при этом обучается взаимодействовать с другой половиной и стимулировать тем самым ее развитие.

Так что, господа и дамы эмоционального склада ума, если прочтение данного текста, как и вышеупомянутых постов 1 и 4, вызывает у вас внутреннее раздражение, задумайтесь лучше — почему, и попробуйте наладить контакт со своей внутренней «аналитической машиной» ака левым полушарием, которое якобы лишает вас радостей жизни. Сегодня много пишут о важности правополушарного мышления, о роли креативного подхода в экономике. Направлены такие статьи и книги в основном на менеджеров, аналитиков и других «левополушарных» личностей, принимающих решения. Я же хочу подчеркнуть важность взаимопонимания и с другой стороны, о котором сегодня говорят не так часто. Мы имеем возможность сегодня обмениваться этими сообщениями благодаря тому, что когда-то одни замечательные люди проявили достаточную усидчивость, а другие — творческое озарение, одни годами выверяли формулы и провели сотни экспериментов, как Эдисон, другие исписали сотни бумаги в поисках «правильных» дизайнерских штрихов, а некоторые занимались и тем, и другим понемногу. Согласитесь, глупо выяснять отношения, как в детском саду, какая конфигурация половых мыслительных органов однозначно лучше. Сегодня, в век увеличивающихся возможностей, каждому из нас доступны преимущества тех и других подходов, в сочетании которых (во всех их вариациях) зарыты самые вкусные инновации и самые большие залежи разнообразного позитива. За сим, как говорит левополушарный Онотоле, спасибо за внимание, до свидания.",31
2017-08-02,Будут ли птицы атаковать небоскреб и другие вопросы воздушного общежития. Часть 1,https://www.habr.com/ru/company/lakhtacenter/blog/370671/,"О птицах забеспокоились еще на заре петербургской мегастройки Лахта Центра. Через побережье Невской Губы пролегают традиционные пути миграции пернатых – появились опасения, что птицы могут изменить маршруты и места гнездования из-за крупных строительных работ. Сейчас — новые тревоги — говорят, что пернатые по каким-то причинам будут не облетать небоскреб, а разбиваться об него. И даже цифру называют: 30 тысяч птичьих смертей в год. Такое вообще возможно?


Главная птичья опасность в регионе? Или нет?  
Разберемся!

В чем суть вопроса
Находясь в Лахте сложно поверить, что это — территория крупнейшего в России мегаполиса – тут больше природного, чем в любой другой части Петербурга.

 

На старте проекта зеленый вопрос пытался заместить исторический дискурс Охты. Например, появились требования спасти «… живописного вида популяцию растительных клопов-краевиков Coreus marginatus L», которая по мнению отдельных авторов обосновалась именно на участке строительства, невзирая на отсутствие на территории бывшей пескобазы собственно растительности.


Пескобаза «Рудас» — место строительства небоскреба

Пожалуй, внезапное обнаружение барханного кота в лахтинских песчаных дюнах смотрелось бы куда более органично… 


Барханный кот. Фото отсюда

Но вот «птичий вопрос» не из тех, что можно отнести к инерции поиска недостатков. Основания для его постановки действительно были. И вот почему.

Птицам нравится побережье Невской Губы — ее заросшее мелководье дает пернатым кров и пищу. Тут – крупный «перевалочный пункт», где они останавливаются на отдых в своем пути далее на северо-восток. Для кого-то эти места – и вовсе не привал, а конечная остановка – родное гнездо. В общей сложности через побережье с разными целями летят сотни тысяч птиц. 


Заказник «Северное побережье Невской Губы» — в 6 км. от Лахты. Заросли тростника и рогоза (в народе — «камыш») очень нравятся птицам. Скрин из сюжета ТК Санкт-Петербург.

Какое место на их путевой карте занимает именно Лахта? Представляет ли небоскреб опасность для пернатых? Как этично поделить воздушное пространство? На такие вопрос могли ответить только орнитологи. Их и пригласили — в числе первых исследователей новой строительной территории. 
С 2011 года орнитологический мониторинг ведут специалисты Биологического факультета СПбГУ. Вот уже седьмой год такие исследования проводятся каждую весну, лето и осень. Перед тем, как дать ответы на все вопросы, узнаем, как их получают — как работают орнитологи. 

Без чего не обойтись орнитологу
Чем орнитолог отличается от человека обычного помимо собственно научной подготовки? Острым зрением и острым слухом. 


Таблица Сивцева. Два нижних ряда — зрение 1,5 и зрение 2!

Вас когда-нибудь занимал вопрос, почему окулист ставит «единицу» по зрению, если вы прочитали третий ряд снизу? Для кого тогда два самых нижних ряда? Они для тех, у кого зрение превышает стандартный хороший человеческий показатель. Орнитолог почти наверняка прочитает нижние строчки. Хорошее зрение — необходимость для наблюдений за пернатыми. 

Еще орнитологи на слух определяют разные виды птиц – по пению. И речь не о курице и жаворонке. А, к примеру, о разных видах чаек. 

Арсенал для наблюдений
Впрочем, от технических приспособлений ни один современный ученый не отказывается. Главное оружие орнитолога – бинокль.


Орнитологический бинокль

Наши орнитологи использовали приборы с 10 и 16-ти кратным увеличением – это оптическая наблюдательная техника специального назначения. Для сравнения: театральные бинокли, которые почти все держали в руках, имеют кратность, не превышающую 5, а чаще – 2,5 раз.

Тяжелая артиллерия орнитологического арсенала – подзорная труба от 60 до 100х, которая позволяет разглядеть птиц на расстоянии нескольких километров в зависимости от погодных условий. Впрочем, так далеко для задач исследования в Лахте заглядывать не нужно. Подзорная труба используется для уточнения нюансов – определения близких видов, половых различий.


Когда птица не хочет, чтобы ее заметили: дымчатый лягушкорот, сидящий на гнезде. Даже с трубой не сразу заметишь. Фото отсюда

Трубу используют только со штативом – чтобы избежать вибрации изображения — чем больше увеличение, тем это критичнее. 
Еще одна полезная в работе вещь – диктофон. С ним все ясно: увидел – записал. 


Оборудование орнитологического центра Поморие, Болгария. Фото отсюда.

База
Основа орнитологии – наблюдение. Значит, нужен хороший наблюдательный пункт. В лесу для этого иногда строят орнитологические вышки, но более типичное место работы ученых – это просто естественное место с хорошим обзором – край поля, лесная опушка, берег моря. 


Орнитологическая вышка. Фото отсюда

В Лахте вышку строить не пришлось – нашелся старый пирс на восточной оконечности береговой линии, прилегающей к стройке. 


На заре стройки


И сегодня

Плюсов много – на возвышении, хороший обзор и на воду, и на небо, и на стройку. 


С этого пирса орнитологи ведут оперативный мониторинг в Лахте

Вторая точка наблюдений — на западе стройки. С нее виден пролет птиц, которые сворачивают на север перед площадкой. В зону влияния строительства эта часть не попадает, но там гнездятся каменки, галстучники и чайки.

Работа включает не только мониторинг с точек, но и сами маршруты до пунктов и между ними. При проходе орнитолог фиксирует все, что удалось заметить. Это называется «наблюдение по маршруту». 

График наблюдений
Вот новость для тех, кто придерживается теории про «сов» и «жаворонков», подводя под нее базу про «природные биоритмы». На самом деле никаких ранних и поздних пташек не существует. Есть очень небольшое количество видов, более активных по ночам. Совы, кстати, действительно из них. 
Основная масса пернатых живет по непривычному человеку графику. Утренний подъем – за полчаса до восхода. Днем – отдых. Затем – вторая смена, которая заканчивается спустя полчаса после заката. 

Орнитологи подстраиваются под график подопечных. Наблюдения в Лахте идут по 4 часа утром и вечером, стартуя за 30 минут до рассвета и завершаясь спустя 30 минут после захода. 


Сова. Активна и днем. Фото отсюда

Во время миграции режим активности птиц и вовсе ломается – 75% пернатых летят по ночам, днем едят и снова в путь. 


Ночь? Пора в дорогу. Ночная съемка миграции птиц в заповеднике Аскания Нова. Фото отсюда

Метод
Из вышесказанного ясно, что первичный сбор информации идет по принципу – смотрим кто летает, на каких высотах, что делает. Методики отличаются нюансами. Вот как пример научной изобретательности — мониторинг птиц на фоне лунного диска. 


Фото отсюда

Да, ученые просто фиксируют всех птиц, летящих на фоне луны. Птичий силуэт хорошо различим – значит, можно установить видовую принадлежность. Для ночных наблюдений – хороший выход. После данные «лунного мониторинга» вносят в компьютер, и специальная программа с помощью коэффициентов экстраполирует цифры. В Лахте методику тоже пробовали, но не очень удачно – петербургская луна подводит. Чаще такие наблюдения ведут в южных широтах с ясными лунными ночами. 

Граница
Поле наблюдений в Лахте совпадает с зоной влияния строительства. Оно определено учеными как окружность с радиусом в 500 метров от башни Лахта Центра. Итого – километр до дальней границы в горизонтальной плоскости. В вертикальной – меньше: основная плотность потока птиц идет на высотах от 30 до 100 метров. С этой точки зрения между зданием в 70 метров и небоскребом разницы нет.


Для птицы разницы между башней и жилой высоткой нет — основная плотность потока — на отметках до 100 м. Фото Ивана Смелова

Бывают ли птицы, которые летят выше? Конечно, есть те, кто вылетает за рамки нормального распределения. Например, высоко движутся гуси – для них привычен транзит на отметках 200-300 метров и даже выше. 

Если говорить о чемпионах, птицы высокого полета – это кондоры, аисты, грифы… Горного гуся заставали на плюс 10 175 м., правда, при перелетах над Гималаями, так что отметка при отсчете от горной тверди будет ниже. Официальный рекорд по высоте принадлежит грифу Рюппеля (африканскому сипу) — в 1973 году в Кот-Д’Ивуар птица этого вида столкнулась с пассажирским самолетом на высоте 11 277 м. 


Сип. Фото отсюда 

К счастью для нашей авиации, эти виды в Петербурге и Ленобласти не водятся. Пернатых, предпочитающих стандартные высоты, успешно отгоняют подальше от ВПП сапсанами – штатными «сотрудниками» орнитологической службы Пулково. 
Сокол-сапсан — еще один рекордсмен среди птиц. И даже больше — самое быстрое животное на планете. В 2005 в штатах зафиксировали скорость 389, 46 км/ч, которую развила птица, ныряя за жертвой. Официальная запись рекорда.
Может и лахтинскому небоскребу перенять этот опыт? Завести таких же соколов – просто чтобы всех распугивать, для их же, птиц, блага? 


Сапсан Пулково. «Сапсану» РЖД за ним не угнаться. Фото the Village отсюда

А вот теперь узнаем, имеется ли в этом необходимость. 

Вопрос № 1. Летают ли птицы над Лахтой?
Тут есть две новости. Начну с хорошей. Летают. В период с 15 апреля по 27 июня в 2017 году, наблюдая 1 раз в 10 дней, ученые насчитали около 20 тысяч птиц. Как пернатые реагируют на стройку? 

Для ответа важно понимать такой нюанс.

По отношению к человеческой деятельности птиц можно поделить на две группы. Первые – те, кто избегает людей, вторые – те, кто людей не боится и даже извлекает для себя выгоду из хозяйственной деятельности вида Homo sapiens. Голуби, чайки, вороны, воробьи – этих птиц вы знаете «в лицо», даже если мало интересуетесь живой природой. Просто потому что это — пернатые «горожане», такие же жители мегаполисов, как мы с вами. 


Чайкам в Петербурге даже поставили небольшой памятник — как одному из символов города

Согласно отчетам, абсолютное большинство потока в районе Лахты – из числа таких урбанизированных птичьих видов. Эти пернатые не боятся стройки. Большая их часть предпочитает облетать участок возведения Лахта Центра по его северной границе. Самые смелые – в основном, чайки, «срезают» дорогу через площадку. В конструкции не врезаются, остекление хорошо различают. Одна из чаек – внимание! – свила гнездо в северной части стройки. 


Озерная чайка в Лахтинской гавани

«Антропогенные» виды в цифрах
В лидерах, конечно, чайки. У башни наблюдалось около 3000 озерных чаек, примерно столько же сизых, около 4000 – серебристых, и мало малых чаек – в районе 100 особей. Другие виды, наиболее распространенные в зоне влияния стройки – обыкновенные скворцы (±2000), большие синицы (±1500), чижи (±1000), серые вороны (±1000). Из Технических отчетов по оперативному орнитологическому мониторингу строительства Лахта Центра 
Город или нет?
Означает ли это, что лахтинская стройка идентифицирована птицами строго как территория мегаполиса и никаких других видов, кроме как «антропогенных» тут не водится? Птицы «дикой природы» тоже летают. И тоже без последствий. 


Утки-кряквы в Лахтинской гавани

Птицы «дикой природы» стройку просто аккуратно облетают. Радиус совсем небольшой – почему бы не облететь. Те, кто смотрит на башню сверху, а не сбоку — гуси и казарки проходящие на больших высотах, выше 200 метров, на небоскреб тоже не реагируют. Что есть он, что нет его… Дальних путешественников смутить сложно. Более существенного непосредственного влияния небоскреба, чем его облет, не отмечено. 

Краснокнижник
А вот главная новость. Возле небоскреба зафиксирована стоянка двух видов лебедей. Оба занесены в Красную Книгу Санкт-Петербурга. У малого лебедя – представителя Красной Книги России – на стоянке зарегистрировано крупное скопление — около 200 птиц всего в 350-500 метрах от стройки, что
 «… свидетельствует об отсутствии негативного влияния строительства на местообитания этого редкого вида… На участках Невской губы, непосредственно примыкающих к территории строительства, сохраняются условия ранневесенней стоянки водоплавающих птиц…» (Из технического отчета по оперативному орнитологическому мониторингу строительства Лахта Центра за апрель-июнь 2017). 

Малый лебедь. Красная книга России. Фото

Всего орнитологи зафиксировали 13 краснокнижных видов. Из Красной книги России – 6. Скопа, травник и клуша пролетали транзитом, а вот галстучники остались гнездовать. По наблюдениям, в общем на территории — 74 вида различных птиц. 
Для справки: всего в Петербурге и Ленобласти 328 видов птиц, 85 – в Красной Книге Ленобласти. 
Так ли все радужно?
Вообще-то, нет. Вторая новость — общая численность миграционного потока птиц с годами снижается. Это – общая тенденция, связанная со многими преобразованиями. Например, намыв песка из Лахтинского разлива фактически покончил с водными птичьими стоянками в этом месте – отметка дна ушла с минус 1-2 до 16 метров. А это уже совсем другой биотоп. 

Строительство дорог, сплошная многоэтажная застройка на северо-восточном берегу Лахтинского разлива и с двух сторон пролива – масштабные преобразования последних десятилетий. Город наступает. Дикие птицы отступают – вслед за естественной средой обитания. 


Лахтинский разлив и Юнтоловский заказник.

Это глобальная проблема, связанная с человеческим способом существования – цивилизацией. И тут — просто задача иного масштаба – научиться жить в добрососедстве с другими обитателями планеты — не важно, летают они, бегают или плавают. Да, а количество чаек и воробьиных меж тем в общем потоке растет…

В продолжении читайте — и все-таки, будут ли птицы врезаться в небоскреб? Что такое световые ловушки и есть ли у птиц компас?

Будут ли птицы атаковать небоскреб и другие вопросы воздушного общежития. Часть 2

 — 

Благодарим за помощь в представлении материалов специалистов Биологического факультета СПбГУ",35
2020-05-07,ClickHouse для продвинутых пользователей в вопросах и ответах,https://www.habr.com/ru/company/avito/blog/500678/,"В апреле инженеры Авито собирались на онлайн-посиделки с главным разработчиком ClickHouse Алексеем Миловидовым и Кириллом Шваковым, Golang-разработчиком из компании Integros. Обсуждали, как мы используем систему управления базами данных и какие сложности у нас возникают. 
По мотивам встречи мы собрали статью с ответами экспертов на наши и зрительские вопросы про бэкапы, решардинг данных, внешние словари, Golang-драйвер и обновление версий ClickHouse. Она может быть полезна разработчикам, которые уже активно работают с СУБД «Яндекса» и интересуются её настоящим и будущим. По умолчанию ответы Алексея Миловидова, если не написано иное. 
Осторожно, под катом много текста. Надеемся, что содержание с вопросами поможет вам сориентироваться.

Содержание

ClickHouse постоянно обновляется, а наши данные — нет. Что с этим делать? 
Какие лучшие практики есть на данный момент по резервному копированию данных из ClickHouse?
Можно ли будет организовать контролируемое отставание реплик в валах?
Как быть, если структура таблицы поменялась?
Какие сейчас лучшие практики в решардинге данных?
В ClickHouse есть утилита clickhouse-copier. Можете про неё рассказать?
У вас была пилотная штука, которая называлась решардинг. Что с ней?
Можно ли сливать все части данных воедино перед перемещением на медленные диски?
Как переезжать на новые версии ClickHouse, если нет возможности заранее проверить совместимость?
Kill query должен убивать запросы, но он этого не делает. Почему?
Как рассчитать время ответа при читающей нагрузке?
Что подтюнить в ClickHouse, чтобы больше данных было в кэше?
Как можно настроить storage_configuration для хранения в оперативке?
До какого количества уникальных значений эффективен Low Cardinality?
Какие лучшие практики по полнотекстовому поиску по таблице с пятью миллиардами строк? 
Как лучше организовать доступ в ClickHouse для большого количества пользователей? 
Можно ли отдать результаты одного запроса десяти клиентам?
Как быть с асинхронными операциями и материализованными представлениями?
В ClickHouse много логов. Как я могу видеть все, что происходит с сервером в моменте?
Как воздействовать на мерджи, чтобы сервер не падал в OOM? 
Как будет происходить разработка Golang-драйвера для ClickHouse?
Внешний словарь не поднимается после перезагрузки с включенной настройкой lazy_load. Что делать?
Как быть с тем, что system reload dictionaries не подгружает ни один из множества словарей, если хотя бы один из них падает с ошибкой?
Есть ли способ конфигурировать реквизиты в конфиге ClickHouse, но не светить их при ошибках?
Бонус: фоны для Зума с посиделок

Если не хочется читать текст, можно посмотреть запись посиделок на нашем ютуб-канале. Таймкоды — в первом комментарии под видео.
ClickHouse постоянно обновляется, а наши данные — нет. Что с этим делать?
ClickHouse постоянно обновляется, а наши данные, которые были optimize final обработаны, не обновляются и лежат в резервной копии. 

Предположим, у нас случилась какая-нибудь проблема, и данные были утеряны. Мы решили восстановиться, и оказалось, что старые партиции, которые лежат на сохранении в серверах бэкапов, очень сильно расходятся с используемой на данный момент версией ClickHouse. Что делать в такой ситуации, и возможна ли она?Ситуация, при которой вы восстановили из бэкапа данные в старом формате, а на новой версии они не подключаются, невозможна. Мы следим за тем, чтобы формат данных в ClickHouse всегда оставался обратно совместимым. Это гораздо важнее, чем обратная совместимость по функциональности, если изменилось поведение какой-то редко используемой функции. Данные, которые хранятся на диске, новая версия ClickHouse всегда должен уметь читать. Это закон. 
Какие лучшие практики есть на данный момент по резервному копированию данных из ClickHouse?
Как делать резервные копии с тем учетом, что у нас есть операции optimize final, огромная база данных на терабайты, и данные, которые обновляются, предположим, за последние три дня, а дальше с ними никаких процедур не происходит? 

Мы можем накостылять собственное решение и на баше написать: собирай так-то и так-то эти резервные копии. Может быть, костылять ничего не надо, и велосипед давно изобретён? Для начала по поводу лучших практик. Мои коллеги всегда советуют в ответ на вопросы про бэкапы напоминать про сервис «Яндекс.Облако», где эта задача уже решена. Так что пользуйтесь им, если есть такая возможность. 
Полного решения, на сто процентов встроенного в ClickHouse, для бэкапов нет. Есть некоторые заготовки, которые можно использовать. Чтобы получить полное решение, придётся либо немножко вручную повозиться, либо сделать обёртки в виде скриптов.
Начну с самых простых решений и закончу самыми навороченными в зависимости от объёма данных и размера кластера. Чем больше кластер — тем сложнее становится решение.
Если таблица с данными занимает всего несколько гигабайт, бэкап можно сделать так: 

Сохранить определение таблиц, то есть метаданные — show create table.
Сделать дамп с помощью ClickHouse клиента — select * from table в файл. По умолчанию вы получите файл в формате TabSeparated. Если хочется более эффективно — можно в формате Native. 

Если объём данных больше, то бэкап займёт больше времени и много места. Это называется логический бэкап, он не привязан к формату данных ClickHouse. Если он есть, то в крайнем случае вы сможете взять бэкап и загрузить в MySQL для восстановления. 
Для более продвинутых случаев в ClickHouse встроена возможность создать снапшот партиций в локальной файловой системе. Эта возможность доступна в виде запроса alter table freeze partition. Или просто alter table freeze — это снапшот всей таблицы. 
Снапшот будет создан консистентным для одной таблицы на одном шарде, то есть создать консистентный снапшот всего кластера таким образом невозможно. Но для большинства задач такой необходимости нет, и достаточно на каждом шарде выполнить запрос и получить консистентный снапшот. Он создаётся в виде хардлинков и поэтому не занимает дополнительного места. Далее этот снапшот вы копируете на бэкап-сервер или в хранилище, которое используете для бэкапов.
Восстановить такой бэкап достаточно легко. Первое — создаёте таблицы по имеющимся определениям таблиц. Далее копируете сохраненные снапшоты партиций в Directory-Detached для данных таблиц и выполняете запрос attach partition. Такое решение вполне подходит для самых серьёзных объемов данных. 
Иногда требуется что-то ещё круче — в тех случаях, когда у вас десятки или даже сотни терабайт на каждом сервере и сотни серверов. Тут есть решение, которое я подсмотрел у коллег из «Яндекс.Метрики». Я бы не рекомендовал его каждому — прочитайте и сами решите, подходит оно или нет. 
Сначала нужно создать несколько серверов с большими дисковыми полками. Далее на этих серверах поднять несколько ClickHouse серверов и настроить их так, чтобы они работали как ещё одна реплика для тех же шардов. И дальше использовать на этих серверах файловую систему или некий инструмент, который позволяет создавать снапшоты. Тут есть два варианта. Первый вариант — это LVM снапшоты, второй вариант — ZFS на Linux. 
После этого каждый день нужно создавать снапшот, он будет лежать и занимать какое-то место. Естественно, если данные меняются, то со временем объём места будет увеличиваться. Этот снапшот можно достать в любой момент и восстановить данные, вот такое странное решение. Плюс ещё надо ограничить эти реплики в конфиге, чтобы они не пытались становиться лидерами.
Можно ли будет организовать контролируемое отставание реплик в валах?
В этом году вы планируете делать валы в ClickHouse. Можно ли будет в них организовать контролируемое отставание реплик? Мы хотели бы с его помощью обезопасить себя от негативных сценариев с альтерами и прочими изменениями. 

Можно ли сделать какие-то roll back для альтеров? Например, в существующем вале взять и сказать, что до этого момента применяй изменения, а с этого момента изменения перестань применять?

Если в наш кластер пришла команда и поломала его, то у нас есть условная реплика с отставанием в час, где мы можем сказать, что давайте будем именно её использовать на данный момент, но последние десять минут изменений в ней применять не будем? Для начала про контролируемое отставание реплик. Такой запрос от пользователей был, и мы создали issue на Гитхабе с просьбой: «Если кому-то это надо, ставьте лайк, ставьте сердечко». Никто не поставил, и issue закрыли. Тем не менее, уже сейчас можно получить такую возможность, настроив ClickHouse. Правда, только начиная с версии 20.3.
ClickHouse постоянно в фоне производит слияние данных — мердж. Когда мердж произведён, некоторый набор кусков данных заменяется на более крупный кусок. При этом куски данных, которые были раньше, продолжают оставаться на диске в течение некоторого времени.
Во-первых, они продолжают храниться до тех пор, пока есть запросы select, которые их используют, для того чтобы обеспечить неблокирующую работу. Запросы select спокойно читают из старых кусков.
Во-вторых, есть ещё и порог по времени — старые куски данных лежат на диске восемь минут. Эти восемь минут можно настроить и превратить даже в один день. Это будет стоить места на диске: в зависимости от потока данных получится, что за последний день данные не то что удвоятся, их может стать в пять раз больше. Но вы сможете при серьёзной проблеме остановить ClickHouse сервер и со всем разобраться.
Теперь возникает вопрос, как это защищает от альтеров. Здесь стоит посмотреть глубже, потому что в старых версиях ClickHouse альтер работал таким образом, что просто непосредственно менял куски. Есть кусок данных с какими-то файлами, и мы делаем, например, alter drop column. Тогда этот столбец физически удаляется из всех кусков.
Но начиная с версии 20.3, механизм альтеров был полностью изменён, и теперь куски данных всегда иммутабельные. Они не меняются вообще — альтеры теперь работают примерно так же, как мерджи. Вместо того, чтобы менять кусок на месте, мы создаём новый. В новом куске файлы, которые не изменились, становятся хардлинками, и, если мы удалили какой-то столбец, он просто будет отсутствовать в новом куске. Старый кусок удалится по умолчанию через восемь минут, и тут можно подкрутить настройки, о которых сказано выше. 
То же касается альтеров типа мутаций. Когда вы делаете alter delete или alter update, он не изменяет кусок, а создаёт новый. А потом удаляет старый.
Как быть, если структура таблицы поменялась?
Как поднять бэкап, который был сделан со старой схемой? И второй вопрос про кейс со снапшотами и средствами файловой системы. Годится ли здесь Btrfs вместо ZFS на Linux LVM?Если вы делаете attach partition партиции с другой структурой, то ClickHouse вам скажет, что так нельзя. Решение такое. Первое — создать временную таблицу типа MergeTree со старой структурой, прицепить туда данные с помощью attach, сделать запрос alter. Потом можно либо скопировать или перенести эти данные и сделать attach снова, либо использовать запрос alter table move partition.
Теперь второй вопрос — можно ли использовать Btrfs. Для начала, если у вас есть LVM, то достаточно LVM снапшотов, а файловая система может быть и ext4, это не имеет значения. С Btrts всё зависит от вашего опыта её эксплуатации. Это зрелая файловая система, но всё равно возникают некоторые подозрения по поводу того, как всё отработает на практике в конкретном сценарии. Я бы не советовал это использовать, если у вас нет Btrfs в продакшне.
Какие сейчас лучшие практики в решардинге данных?
Вопрос про перешардирование сложный и многогранный. Здесь можно ответить сразу несколькими вариантами. Можно зайти с одной стороны и сказать так — в ClickHouse встроенной возможности перешардирования нет. Но я боюсь, этот ответ никого не устроит. Поэтому можно зайти с другой стороны и сказать, что в ClickHouse есть много способов перешардирования данных. 
Если заканчивается место на кластере или он не справляется с нагрузкой, вы добавляете новые серверы. Но эти серверы по умолчанию пустые, данных на них нет, нагрузки никакой не идёт. Вам нужно переложить данные, чтобы они стали равномерно размазаны по новому, увеличенному в размерах, кластеру.
Первый способ, которым это можно сделать, — это скопировать часть партиций на новые серверы с помощью запроса alter table fetch partition. Например, были у вас партиции по месяцам, и вы берёте первый месяц 2017 года и копируете на новый сервер, потом — третий месяц копируете на какой-то ещё новый сервер. И так делаете, пока не станет более-менее равномерно.
Перенос можно осуществлять только для тех партиций, которые не меняются при записи. Для свежих партиций запись придётся отключить, потому что их перенос не атомарный. Иначе вы получите дубликаты или пропуски в данных. Тем не менее, этот способ практичный и работает достаточно эффективно. По сети передаются уже готовые сжатые партиции, то есть данные не пережимаются и не перекодируются.
У этого способа есть один недостаток, и он зависит от схемы шардирования, закладывались ли вы на эту схему шардирования, какой у вас был ключ шардирования. В вашем примере для случая с метриками ключ шардирования — это хеш от пути. Когда у вас идёт select в Distributed таблицу, он идёт сразу на все шарды кластера и забирает оттуда данные. 
Это значит, что фактически для вас не имеет значения, какие данные на каком шарде оказались. Главное то, что данные по одному пути оказываются на одном шарде, а вот каком именно, не принципиально. В этом случае перенос готовых партиций прекрасно подходит, потому что при запросах select вы тоже — что до перешардирования, что после, схема значения особо не имеет — будете получать полные данные.
Но бывают случаи и более сложные. Если на уровне логики приложения вы закладываетесь на специальную схему шардирования, что этот клиент расположен на таком-то шарде, и запрос можно отправить сразу туда, а не в Distributed таблицу. Или вы используете достаточно свежую версию ClickHouse и включили настройку optimize skip unused shards. В этом случае во время запроса select выражение в секции where будет проанализировано, и будет вычислено, на какие шарды необходимо пойти согласно схеме шардирования. Это работает при условии, что данные разложены именно в соответствии с этой схемой шардирования. Если вы их переложили вручную, соответствие может поменяться.
Итак, это способ номер один. И я жду вашего ответа, подходит способ, или идём дальше.
Владимир Колобаев, lead system administrator в Авито: Алексей, тот способ, который вы упомянули не очень хорошо ложится, когда надо размазать нагрузку в том числе и на чтение. Мы можем взять партицию, которая месячная и можем предыдущий месяц унести на другую ноду, но когда придёт запрос за этими данными, мы будем нагружать только её. А хотелось бы нагружать весь кластер, потому что, в противном случае, у нас какое-то время вся нагрузка на чтение будет обрабатываться двумя шардами.
Алексей Миловидов: Ответ тут странный — да, плохо, но может и прокатить. Объясню, как именно. Стоит посмотреть на сценарий нагрузки, который идёт за вашими данными. Если это данные мониторинга, то почти наверняка можно сказать, что подавляющее большинство запросов идёт за свежими данными. 
Вы поставили новые серверы, перенесли старые партиции, но также изменили то, как записываются свежие данные. И свежие данные будут размазаны по всему кластеру. Таким образом, уже через пять минут запросы за последние пять минут будут равномерно нагружать кластер, через день запросы за сутки будут равномерно нагружать кластер. А запросы за предыдущий месяц, к сожалению, пойдут только на часть серверов кластера.
Но зачастую у вас не будет запросов именно за февраль 2019 года. Скорее всего, если уж запросы идут в 2019 год, то они будут за весь 2019 год — за большой интервал времени, а не за какую-то маленький диапазон. И такие запросы тоже смогут равномерно нагрузить кластер. Но в целом ваше замечание совершенно верно, что это такое ad hoc решение, которое не размазывает данные полностью равномерно.
У меня есть ещё несколько пунктов для ответа на вопрос. Один из них про то, как изначально сделать схему шардирования такой, чтобы от перешардирования было меньше боли. Это возможно не всегда.
Например, у вас есть данные мониторинга. Данные мониторинга растут по трём причинам. Первая — накопление исторических данных. Вторая — рост трафика. И третья — увеличение количества тех вещей, которые подпадают под мониторинг. Появляются новые микросервисы и метрики, которые нужно сохранять. 
Возможно, что из них самый большой рост связан именно с третьей причиной — это увеличение использования мониторинга. И в этом случае стоит посмотреть на характер нагрузки, каковы основные запросы на select. Основные запросы на select, скорее всего, будут идти по некоторому подмножеству метрик.
Например, использование CPU на каких-то серверах каким-то сервисом. Получается, что есть некоторое подмножество ключей, по которому вы эти данные достаёте. И сам запрос за этими данными, скорее всего, достаточно простой и выполняется за десятки миллисекунд. Используется для сервисов мониторинга, для дашбордов. Надеюсь, я правильно это понимаю.
Владимир Колобаев: Дело в том, что мы очень часто апеллируем к историческим данным, так как мы в режиме реального времени сравниваем текущее положение с историческим. И для нас важно иметь быстрый доступ к большому объёму данных, и ClickHouse с этим отлично справляется.
Вы абсолютно правы, большинство запросов на чтение мы испытываем за последний день, как и любая система мониторинга. Но при этом на исторические данные нагрузка тоже достаточно большая. Она в основном от системы алертинга, которая каждые тридцать секунд ходит и говорит ClickHouse: «Отдай мне данные за последние шесть недель. А теперь построй-ка мне из них какую-нибудь скользящую среднюю, и давай сравним текущее значение с историческим». 
Я хотел бы сказать, что у нас для таких очень свежих запросов существует ещё одна маленькая табличка, в которой мы храним всего два дня данных, и основные запросы летят в неё. В большую шардированную таблицу мы отправляем только большие исторические запросы.
Алексей Миловидов: К сожалению, для вашего сценария получается плохо применимо, но я расскажу описание двух плохих и сложных схем шардирования, которые не нужно использовать, но которые используются в сервисе моих друзей. 
Есть основной кластер с событиями «Яндекс.Метрики». События — это просмотры страниц, клики и переходы. Большинство запросов идёт к конкретному веб-сайту. Вы открываете сервис «Яндекс.Метрика», у вас есть сайт — avito.ru, заходите в отчёт, и идёт запрос по вашему сайту.
Но есть и другие запросы — аналитические и глобальные, которые делают внутренние аналитики. На всякий случай отмечу, что внутренние аналитики делают запросы только по сервисам «Яндекса». Но тем не менее, даже сервисы «Яндекса» занимают существенную долю от всех данных. Это запросы не по конкретным счётчикам, а по более широкой фильтрации.
Как организовать данные таким образом, чтобы и по одному счётчику всё работало эффективно, и глобальные запросы тоже? Сложность ещё состоит в том, что количество запросов в ClickHouse на кластер «Метрики» — несколько тысяч в секунду. При этом нетривиальных запросов, например, несколько тысяч в секунду один сервер ClickHouse не тянет.
Размер кластера — шестьсот с чем-то серверов. Если над этим кластером просто натянуть Distributed таблицу и отправлять туда несколько тысяч запросов, то станет ещё хуже, чем отправлять их на один сервер. С другой стороны, вариант с тем, что данные размазаны равномерно, а мы идём и запрашиваем со всех серверов, сразу отметаем.
Есть вариант диаметрально противоположный. Представьте, если мы данные будем шардировать по сайтам, и запрос для одного сайта пойдёт на один шард. Теперь кластер вполне сможет вытянуть десять тысяч запросов в секунду, но на одном шарде какой-то один запрос будет работать слишком медленно. Он уже не будет масштабироваться по пропускной способности. Особенно если это сайт avito.ru. Я не раскрою секрет, если скажу, что Авито — это один из наиболее посещаемых сайтов в рунете. И обрабатывать его на одном шарде было бы безумием.
Поэтому схема шардирования устроена более хитрым образом. Весь кластер разбит на некоторое количество кластерков, которые мы называем слоями. Внутри каждого кластерка от десятка до нескольких десятков шардов. А всего таких кластерков тридцать девять. 
Как это всё масштабируется? Количество кластерков не меняется — как было несколько лет назад тридцать девять, так и осталось. Но внутри каждого из них мы постепенно увеличиваем количество шардов по мере накопления данных. И схема шардирования в целом такая — разбиение на эти кластерки идёт по веб-сайтам, и для того чтобы понять, какой сайт на каком кластере, используется вообще отдельная метабаза в MySQL. Один сайт — на одном кластерке. А внутри него шардирование идёт по идентификаторам посетителей.
При записи мы их разбиваем по остатку от деления идентификатора посетителя. Но при добавлении нового шарда схема шардирования меняется, мы продолжаем разбивать, но при остатке от деления на другое число. Это значит, что один посетитель уже всё-таки расположен на нескольких серверах, и закладываться на это нельзя. Это сделано исключительно для того, чтобы данные лучше сжимались. А при запросах мы идем в Distributed таблицу, которая смотрит на кластерок и обращается к десяткам серверов. Вот такая дурацкая схема.
Но мой рассказ будет неполным, если я не скажу, что от этой схемы мы отказались. В новой схеме мы всё изменили и все данные скопировали с помощью clickhouse-copier.
В новой схеме все сайты делятся на две категории — большие и маленькие. Я не знаю, как там выбран порог, но в результате получилось так, что большие сайты записываются на один кластер, где 120 шардов по три реплики в каждом — то есть 360 серверов. И схема шардирования такова, что любой запрос идёт сразу на все шарды. Если вы сейчас в «Яндекс.Метрике» откроете любую страницу отчёта для avito.ru, запрос пойдёт на 120 серверов. Больших сайтов в рунете мало. И запросов получается не тысяча в секунду, а даже меньше сотни. Всё это спокойно прожёвывает Distributed таблица, которую каждый из них обрабатывает 120 серверами.
А второй кластер — для маленьких сайтов. Здесь схема шардирования по идентификатору сайта, и каждый запрос идёт ровно на один шард.
В ClickHouse есть утилита clickhouse-copier. Можете про неё рассказать?
Сразу скажу, что это решение более громоздкое и несколько менее производительное. Преимущество в том, что оно размазывает данные полностью согласно той схеме, которую вы укажете. Но недостаток утилиты в том, что она вовсе не делает перешардирование. Она копирует данные из одной схемы кластера в другую схему кластера.
Это значит, что для её работы у вас должно быть два кластера. Они могут быть расположены на одинаковых серверах, но, тем не менее, данные не будут перемещаться инкрементально, а будут скопированы. 
Например, было четыре сервера, стало восемь. Вы создаёте на всех серверах новую Distributed таблицу, новые локальные таблицы и запускаете clickhouse-copier, указывая в нём схему работы, что он должен читать оттуда, принять новую схему шардирования и перекладывать данные туда. И вам на старых серверах потребуется места в полтора раза больше, чем есть сейчас, потому что старые данные должны на них оставаться, и сверху на них приедет половинка от этих же старых данных. Если вы заранее подумали о том, что данные нужно перешардировать и место есть, то такой способ подойдёт.
Как внутри устроен clickhouse-copier? Он разбивает всю работу на набор задач по обработке одной партиции одной таблицы на одном шарде. Все эти задачи могут выполняться параллельно, и clickhouse-copier может быть запущен на разных машинах в нескольких экземплярах, но то, что он делает для одной партиции — это не что иное как insert select. Данные читаются, разжимаются, переразбиваются, потом снова сжимаются, записываются куда-то, пересортируются. Это более тяжёлое решение.
У вас была пилотная штука, которая называлась решардинг. Что с ней?
У вас была ещё в 2017 году пилотная штука, которая называлась решардинг. Даже есть опция в ClickHouse. Я так понимаю, это не взлетело. Можете рассказать, почему так получилось? Вроде бы очень даже актуально.Вся проблема в том, что при необходимости перешардировать данные на месте требуется весьма сложная синхронизация для того, чтобы сделать это атомарно. Когда мы стали смотреть на то, каким образом эта синхронизация устроена, стало ясно, что есть фундаментальные проблемы. И эти фундаментальные проблемы не только теоретические, но и сразу же стали показывать себя на практике в виде того, что можно объяснить очень просто — ничего не работает.
Можно ли сливать все части данных воедино перед перемещением на медленные диски?
Вопрос по TTL с опцией move to slow disk в контексте мерджей. Есть ли способ, кроме как по cron, сливать все части в одну перед перемещением на медленные диски?Ответ на вопрос, можно ли как-то автоматически склеивать все куски в один до их переноса — нет. Мне кажется, в этом нет необходимости. Можно и не сливать все части в одну, а просто рассчитывать на то, что они будут переноситься на медленные диски автоматически. 
У нас два критерия правил переноса. Первый — по мере заполнения. Если на текущем уровне хранилища меньше какого-то процента свободного места, мы выбираем один кусок и переносим его на более медленное хранилище. Вернее не более медленное, а следующее — как настроите.
Второй критерий — по размеру. Он про перенос больших кусков. Вы можете отрегулировать порог по свободному месту на быстром диске, и данные будут переноситься автоматически.
Как переезжать на новые версии ClickHouse, если нет возможности заранее проверить совместимость?
Эта тема регулярно обсуждается в телеграм-чате ClickHouse с учётом разных версий, и всё же. Насколько безопасно обновляться с версии 19.11 на 19.16 и, например, с 19.16 на 20.3. Как лучше переезжать на новые версии, не имея возможности заранее проверить совместимость в песочнице?Тут несколько «золотых» правил. Первое — читайте changelog. Он большой, но там есть отдельные пункты про обратно несовместимые изменения. Не стоит относиться к этим пунктам как к красному флагу. Обычно это мелкие несовместимости, которые связаны с некоторой краевой функциональностью, которая, вполне вероятно, у вас не используется.
Второе — если нет возможности проверить совместимость в песочнице, и вы хотите обновиться сразу в продакшне, рекомендация такая — не надо этого делать. Сначала создайте песочницу и проверьте. Если тестовой среды нет, то у вас, скорее всего, не очень большая компания, а значит можно скопировать часть данных на свой ноутбук и на нём убедиться, что всё корректно работает. Можно даже поднять несколько реплик локально на своей машине. Или можно где-нибудь рядышком поднять новую версию, и залить туда часть данных — то есть сделать импровизированную тестовую среду. 
Ещё одно правило — не обновляться в течение недели после выхода версии по причине отлова багов в продакшне и последующих быстрых фиксов. Давайте разберёмся с нумерацией версий ClickHouse, чтобы не запутаться. 
Есть версия 20.3.4. Число 20 обозначает год выпуска — 2020. С точки зрения того, что внутри, это никакого значения не имеет, так что обращать внимание на это не будем. Дальше — 20.3. Вторую цифру — в данном случае 3 — мы увеличиваем каждый раз, когда выпускаем релиз с какой-то новой функциональностью. Если мы хотим добавить в ClickHouse какую-то возможность, мы обязаны увеличить это число. То есть в версии 20.4 ClickHouse станет работать ещё лучше. Третья цифра — 20.3.4. Здесь 4 — это количество патч-релизов, в которых мы новых возможностей не добавляли, но исправляли какие-то баги. И 4 значит, что мы сделали это четыре раза.
Не стоит думать, будто это что-то ужасное. Обычно пользователь может установить самую свежую версию, и она будет работать без каких-либо проблем с аптаймом в год. Но представьте, что в какой-нибудь функции для обработки битмапов, которая была добавлена нашими китайскими товарищами, при передаче неправильных аргументов сервер падает. Мы обязаны это исправить. Мы выпустим новую патч-версию, и ClickHouse станет стабильнее.
Если у вас ClickHouse работает в продакшне, и выходит новая версия ClickHouse с дополнительными фичами — например, 20.4.1 — самая первая, не спешите ставить её в продакшн в первый же день. Зачем она вообще нужна? Если вы ещё не используете ClickHouse, то вы можете её установить, и, скорее всего, всё будет хорошо. Но если ClickHouse уже стабильно работает, то следите за патчами и обновлениями — какие проблемы мы исправляем.
Кирилл Шваков: Хочу дополнить немного про тестовые среды. Все очень боятся тестовых сред и почему-то считают, что, если у вас очень большой кластер ClickHouse, то и тестовая среда должна быть не меньше или хотя бы в десять раз меньше. Это совсем не так.
Могу сказать на своём примере. У меня есть проект, и там есть ClickHouse. Наша тестовая среда именно для него — это маленькая виртуалка в Hetzner за двадцать евро, где абсолютно всё развёрнуто. Чтобы это делать, у нас есть полная автоматизация в Ansible, и поэтому в принципе нет разницы, куда катить — на железные серверы или просто развернуться в виртуалках.
Что можно сделать? Было бы неплохо сделать в документации ClickHouse пример, как развернуть у себя небольшой кластер — в Docker, в LXC, возможно, создать Ansible playbook, потому что у разных людей разные деплои. Это многое упростит. Когда ты берёшь и за пять минут разворачиваешь кластер, гораздо проще пытаться в чём-то разобраться. Так гораздо удобнее, потому что катить в прод версию, которую ты не проверил — это путь в никуда. Иногда это работает, а иногда нет. И поэтому надеяться на успех — плохо.
Максим Котяков, senior backend engineer Авито: Немного дополню о тестовых средах из серии проблем больших компаний. У нас есть полноценный приёмочный кластер ClickHouse, по схемам данных и настройкам точная копия того, что есть в продакшне. Этот кластер развёрнут в достаточно жухлых контейнерах с минимумом ресурсов. Мы пишем туда некоторый процент от продакшн-данных, благо есть возможность отреплицировать в Кафке поток. Там всё синхронизировано и отскейлено — и по мощностям, и по потоку, и, в теории, при прочих равных должно по метрикам вести себя как продакшн. Всё потенциально взрывоопасное сперва катится на этот стенд и несколько дней там настаивается до готовности. Но естественно, это решение дорогое, тяжелое и с ненулевыми затратами на поддержку. 
Алексей Миловидов: Расскажу, что представляет собой тестовая среда наших друзей из «Яндекс.Метрики». Один кластер был на 600 с чем-то серверов, другой на 360, и есть ещё третий и несколько кластеров. Тестовая среда для одного из них — это просто два шарда с двумя репликами в каждом. Почему два шарда? Чтобы был не один. И реплики тоже чтобы были. Просто некоторое минимальное количество, которое можно себе позволить.
Эта тестовая среда позволяет проверить работоспособность запросов и не сломалось ли что-то по-крупному. Но часто проблемы возникают совершенно другого характера, когда всё работает, но есть некоторые небольшие изменения с нагрузкой.
Приведу пример. Решили установить новую версию ClickHouse. Она выложена на тестовую среду, пройдены автоматизированные тесты в самой «Яндекс.Метрике», которые сравнивают данные на старой версии и на новой, прогоняя весь конвейер. И естественно, зелёные тесты нашего CI. Иначе бы мы даже не предложили эту версию.
Всё прекрасно. Начинаем катить в продакшн. Мне приходит сообщение, что на графиках нагрузка выросла в несколько раз. Мы откатываем версию. Я смотрю на график и вижу: нагрузка действительно выросла в несколько раз во время выкатки, и обратно уменьшилась, когда выкатили. Потом мы стали откатывать версию. И нагрузка точно так же увеличилась и точно так же обратно упала. Так что вывод такой — нагрузка выросла в связи с выкладкой, ничего удивительного.
Дальше было сложно убедить коллег все-таки установить новую версию. Я говорю: «Всё нормально, выкатывайте. Держите кулачки, всё будет работать. Сейчас нагрузка выросла на графиках, но всё нормально. Держитесь». В общем, мы так сделали, и все — версия выложена на продашкн. Но чуть ли не при каждой выкладке возникают похожие проблемы.
Kill query должен убивать запросы, но он этого не делает. Почему?
Ко мне пришёл пользователь, какой-то аналитик, и создал некий запрос, который положил мой кластер ClickHouse. Какую-то ноду или кластер целиком — в зависимости от того, в какую реплику или шард запрос попал. Я вижу, что все ресурсы по CPU на этом сервере в полку, всё красное. При этом сам ClickHouse на запросы отвечает. И я пишу: «Покажи мне, пожалуйста, process list, какой запрос породил это безумие».

Я нахожу этот запрос и пишу ему kill. И вижу, что ничего не происходит. Мой сервер в полку, ClickHouse дальше отдаёт мне какие-то команды, показывает, что сервер жив, и всё здорово. Но у меня деградация во всех пользовательских запросах, начинается деградация по записи в ClickHouse, и мой kill query не отрабатывает. Почему? Я думал, что kill query должен убивать запросы, а этого не происходит.Сейчас будет довольно странный ответ. Дело в том, что kill query не убивает запросы. 
Kill query выставляет маленький флажок под названием «я хочу, чтобы этот запрос был убит». А сам запрос при обработке каждого блока смотрит на этот флажок. Если он выставлен, запрос прекращает работать. Получается, что никто запрос не убивает, он сам должен всё проверить и остановиться. И это должно работать во всех случаях, когда запрос находится в состоянии обработки блоков данных. Он обработает следующий блок данных, проверит флажок и остановится.
Это не работает в случаях, если запрос заблокирован на какой-то операции. Правда, скорее всего, это не ваш случай, потому что, по вашим словам, он использует кучу ресурсов сервера. Возможно, что это не работает в случае внешней сортировки и ещё в некоторых деталях. Но в целом такого быть не должно, это баг. И единственное, что могу посоветовать, — обновлять ClickHouse.
Как рассчитать время ответа при читающей нагрузке?
Есть таблица, в которой хранятся агрегаты по item — различные счетчики. Количество строк — примерно сто миллионов. Можно ли рассчитывать на предсказуемое время ответа, если налить 1K RPS по 1K item’ов? Судя по контексту, речь идёт про читающую нагрузку, потому что на запись проблем никаких — хоть тысячу, хоть сто тысяч, а иногда и несколько миллионов строк можно вставлять. 
Читающие запросы бывают самые разные. В select 1 ClickHouse может выполнять около десятков тысяч запросов в секунду, поэтому даже запросы по одному ключу уже потребуют некоторых ресурсов. И такие точечные запросы будут сложнее, чем в каких-нибудь key-value базах данных, потому что на каждое чтение необходимо прочитать блок данных по индексу. Индекс у нас адресует не каждую запись, а каждый диапазон. То есть придётся почитать весь диапазон — это 8192 строки по умолчанию. И придётся разжать сжатый блок данных с 64 Кб до 1 Мб. Обычно такие точечные запросы занимают от нескольких миллисекунд. Но это самый простой вариант.
Давайте попробуем сделать простую арифметику. Если умножить несколько миллисекунд на тысячу, получится несколько секунд. Как будто держать тысячу запросов по секунду нельзя, но на самом деле можно, потому что у нас несколько процессорных ядер. Так что в принципе 1000 RPS ClickHouse иногда может держать, но на коротких запросах, именно точечных.
Если нужно масштабировать кластер ClickHouse по количеству простых запросов, то я рекомендую самое простое — увеличить количество реплик и отправлять запросы на случайную реплику. Если одна реплика у вас держит пятьсот запросов в секунду, что полностью реально, то три реплики будут держать полторы тысячи.
Иногда, конечно, можно и ClickHouse настроить на максимальное количество точечных чтений. Что для этого нужно? Первое — уменьшить гранулированность индекса. При этом уменьшать её следует не до единицы, а из расчёта, что количество записей в индексе будет несколько миллионов или десятков миллионов на сервер. Если в таблице сто миллионов строк, то в качестве гранулированности можно выставить 64.
Можно уменьшить размер сжатого блока. Для этого есть настройки min compress block size, max compress block size. Их можно уменьшить, переналить данные, и тогда точечные запросы будут быстрее. Но всё равно ClickHouse — это не key-value база данных. Большое количество маленьких запросов — это антипаттерн нагрузки.
Кирилл Шваков: Дам совет на случай, если там обычные экаунтеры. Это достаточно стандартная ситуация, когда в ClickHouse хранят какой-то счётчик. У меня есть пользователь, он из такой-то страны, ещё какое-то третье поле, и нужно инкрементно что-то увеличивать. Берёте MySQL, делаете уникальный ключ — в MySQL он duplicate key, а в PostgreSQL он conflict — и плюсиком добавляете. Это будет работать сильно лучше. 
Когда у вас немного данных, смысла использовать ClickHouse особенно нет. Есть обычные базы данных, и они хорошо с этим справляются. 
Что подтюнить в ClickHouse, чтобы больше данных было в кэше?
Представим ситуацию — на серверах имеется 256 Гб ОЗУ, в ежедневной рутине ClickHouse берёт примерно 60—80 Гб, в пике — до 130. Что можно включить и подтюнить, чтобы больше данных было в кэше и, соответственно, было меньше походов на диск?Как правило, page cache операционной системы хорошо справляется с этой задачей. Если вы открываете просто топ, смотрите там cached или free — там тоже написано, сколько закэшировано — то можно заметить, что вся свободная память использована под кэш. И эти данные при чтении будут читаться не с диска, а из оперативки. При этом я могу сказать, что кэш используется эффективно, потому что кэшируются именно сжатые данные.
Тем не менее, если вы хотите ускорить некоторые простые запросы ещё больше, есть возможность включить внутри ClickHouse кэш в разжатых данных. Это называется uncompressed cache. В конфигурационном файле config.xml выставляете uncompressed cache size в нужное вам значение — я советую не больше половины свободной оперативки, потому что остальное уйдёт под page cache. 
Кроме того, есть две настройки уровня запроса. Первая настройка — use uncompressed cache — включает его использование. Её рекомендуется включать для всех запросов, кроме тяжёлых, которые могут все вообще данные прочитать и этот кэш вымыть. И вторая настройка — это что-то вроде максимального количества строк для использования кэша. Она автоматически ограничивает большие запросы, чтобы они были мимо кэша.
Как можно настроить storage_configuration для хранения в оперативке?
В новой документации ClickHouse я вычитал раздел, связанный с data storage. В описании есть пример с fast SSD. 

Интересно, как можно сконфигурировать то же самое с volume hot memory. И ещё один вопрос. Как работает select с такой организацией данных, будет ли он считывать весь набор или только тот, что лежит на диске, и сжимаются ли эти данные в памяти? И как отрабатывает секция prewhere на такой организации данных?Эта настройка влияет на хранение кусков данных, и их формат никак не меняется.
Давайте рассмотрим подробнее. 
Настроить хранение данных в оперативке можно. Всё, что конфигурируется для диска — это его путь. Вы создаёте tmpfs раздел, который подмонтирован по какому-то пути в файловой системе. Указываете этот путь в качестве пути для хранения данных для самого горячего раздела, туда начинают поступать и записываться куски данных, всё хорошо. 
Но я не рекомендую так делать из-за низкой надёжности, хотя, если у вас минимум три реплики в разных дата-центрах, то можно. Если что, данные будут восстановлены. Представим, что сервер вдруг выключили и включили обратно. Раздел подмонтировался снова, но там пустота. ClickHouse сервер при старте видит, что у него эти куски отсутствуют, хотя, согласно метаданным ZooKeeper они должны быть. Он смотрит, на каких репликах они есть, запрашивает их и скачивает. Таким образом данные будут восстановлены. 
В этом смысле хранение данных в оперативке принципиально не отличается от их хранения на диске, потому что при записи данных на диск они тоже сначала попадают в page cache и физически записываются отложенно. Это зависит от варианта монтирования файловой системы. Но на всякий случай скажу, что ClickHouse не делает fsync при insert.
При этом данные в оперативке хранятся в точно таком же формате, что и на диске. Запрос select точно так же выбирает куски, которые необходимо читать, в кусках выбирает необходимые диапазоны данных, и читает их. И prewhere работает абсолютно так же, независимо от того, были данные в оперативке или на диске.
До какого количества уникальных значений эффективен Low Cardinality?
Low Cardinality хитро устроен. Он составляет словари данных, но они локальные. Во-первых, словари свои для каждого куска, во-вторых, даже внутри одного куска они могут быть разными для каждого диапазона. Когда количество уникальных значений достигает порогового количества — по-моему, один миллион — словарь просто откладывается, и создаётся новый.
Ответ в целом: для каждого локального диапазона — скажем, для каждого дня — где-то до миллиона уникальных значений Low Cardinality эффективен. После будет просто fallback, при котором будет использоваться много разных словарей, а не один. Работать оно будет примерно так же, как обычный столбец типа string, может быть, несколько менее эффективно, но серьёзной деградации производительности не случится. 
Какие лучшие практики по полнотекстовому поиску по таблице с пятью миллиардами строк?
Есть разные варианты ответа. Первый — сказать, что ClickHouse — это не система для полнотекстового поиска. Для этого есть специальные системы например, Elasticsearch и Sphinx. Тем не менее, я всё чаще встречаю людей, которые говорят, что переходят с Elasticsearch на ClickHouse.
Почему такое происходит? Они объясняют это тем, что Elasticsearch перестаёт на некоторых объёмах справляться с нагрузкой, начиная с того, что касается построения индексов. Индексы становятся слишком громоздкими, и, если просто переложить данные в ClickHouse, получится, что они хранятся в несколько раз эффективнее по объёму. При этом поисковые запросы зачастую были не такие, что нужно найти во всем объёме данных какую-то фразу с учетом морфологии, а совершенно другие. Например, найти за последние несколько часов в логах по какой-то подпоследовательности байт.
В этом случае вы в ClickHouse создаёте индекс, первым полем в котором будет дата со временем. И самое большое отсечение данных будет именно по диапазону дат. Внутри выбранного диапазона дат уже, как правило, можно осуществить полнотекстовый поиск даже брутфорс-методом с помощью like. Оператор like в ClickHouse — это самый эффективный оператор like, который вы можете найти. Если найдете лучше — скажите мне. 
Но всё равно like — это full scan. И full scan может быть медленным не только по CPU, но и по диску. Если вдруг у вас один терабайт данных в сутки, и вы за сутки ищете какое-то слово, то придётся отсканировать терабайт. А он наверняка на обычных жестких дисках, и в итоге они будут загружены так, что вы на этот сервер по SSH не зайдёте.
В этом случае я готов предложить ещё один маленький трюк. Он из разряда экспериментальных — может сработает, а может нет. В ClickHouse есть полнотекстовые индексы в виде триграмных Блум-фильтров. Наши коллеги из компании Arenadata уже опробовали эти индексы, и зачастую они работают именно так, как предназначено.
Для того чтобы правильно их использовать, следует хорошо понимать, как именно они работают: что из себя представляет триграмный Блум-фильтр и как выбрать его размер. Могу сказать, что они помогут для запросов по каким-то редким фразам, подстрокам, которые редко встречаются в данных. В этом случае по индексам будут выбраны поддиапазоны, и будет прочитано меньше данных.
Недавно в ClickHouse появились ещё более продвинутые функции для полнотекстового поиска. Это, во-первых, поиск сразу кучи подстрок за один проход, в том числе варианты с учётом регистра, без учёта регистра, с поддержкой UTF-8 или только для ASCII. Выбирайте самый эффективный, который вам нужен. 
Появился также поиск нескольких регулярных выражений за один проход. Вам не нужно писать X like одна подстрока or X like другая подстрока. Сразу пишете, и всё выполняется максимально эффективно.
Третье — теперь есть приближенный поиск регэкспов и приближенный поиск подстрок. Если кто-то написал слово с опечаткой, оно будет искаться по максимальному соответствию.
Как лучше организовать доступ в ClickHouse для большого количества пользователей?
Расскажите, как лучше организовать доступ для большого количества потребителей и аналитиков. Как сформировать очередь, приоритизировать запросы max concurrent queries, и какими инструментами?Если кластер достаточно большой, то хорошим решением будет поднять ещё два сервера, которые станут точкой входа для аналитиков. То есть не пускать аналитиков на конкретные шарды кластера, а просто создать два пустых сервера, без данных, и на них уже настроить права доступа. При этом настройки пользователей при распределённых запросах передаются на удалённые серверы. То есть вы настраиваете всё на этих двух серверах, и настройки имеют эффект на всём кластере.
В принципе эти серверы без данных, но объём оперативки на них весьма важен для выполнения запросов. Диск тоже может использоваться для временных данных, если включена внешняя агрегация или внешняя сортировка.
Важно посмотреть на настройки, которые связаны со всеми возможными лимитами. Если я сейчас зайду на кластер «Яндекс.Метрики» как аналитик и задам запрос select count from hits, то мне сразу же выдадут исключение, что выполнить запрос я не могу. Максимальное количество строк, которое мне разрешено сканировать, — это сто миллиардов, а всего на кластере их пятьдесят триллионов в одной таблице. Это первое ограничение. 
Допустим, я уберу ограничение по количеству строк, и выполню запрос повторно. Тогда я увижу следующее исключение — включена настройка force index by date. Я не могу выполнить запрос, если я не указал диапазон дат. Не нужно рассчитывать на то, что аналитики будут указывать его вручную. Типичный случай — написан диапазон дат where event date between неделя. А потом просто не там указали скобку, и вместо and получился or — or URL match. Если ограничения нет, оно пойдет сканировать столбец URL и потратит просто тонну ресурсов.
Кроме того, в ClickHouse есть две настройки приоритетов. К сожалению, они очень примитивные. Одна называется просто priority. Если priority ≠ 0, и выполняются запросы с каким-то приоритетом, но при этом выполняется запрос с приоритетом, который имеет значение меньше, что значит более высокий приоритет, то запрос со значением приоритета больше, что обозначает более низкий приоритет, просто приостанавливается и не будет работать вообще за это время.
Это очень грубая настройка, и она не подходит для тех случаев, когда на кластере есть постоянная нагрузка. Но если у вас короткие, импульсные запросы важные, а в основном кластер простаивает, такая настройка подойдёт.
Следующая настройка приоритетов называется OS thread priority. Она просто выставляет для всех потоков выполнения запроса величину nice для шедулера Linux. Работает она так себе, но всё-таки работает. Если выставить самое минимальное значение nice — оно самое большое по величине, и значит самый низкий приоритет — а у запросов с высоким приоритетом выставить -19, то CPU будет потреблять низкоприоритетные запросы примерно в четыре раза меньше, чем высокоприоритетные. 
Ещё нужно настроить максимальное время выполнения запроса — скажем, пять минут. Минимальную скорость выполнения запроса — это самое крутое. Эта настройка есть давно, и она требуется, чтобы не просто утверждать, что ClickHouse не тормозит, а чтобы это форсировать.
Представьте, вы настраиваете: если какой-то запрос обрабатывает меньше одного миллиона строк в секунду — так делать нельзя. Это позорит наше доброе имя, нашу добрую базу данных. Давайте это просто запретим. Там на самом деле две настройки. Одна называется min execution speed — в строчках в секунду, а вторая называется timeout before checking min execution speed — по умолчанию пятнадцать секунд. То есть пятнадцать секунд можно, а потом, если медленно, то просто кинуть исключение — прервать запрос.
Ещё нужно настроить квоты. В ClickHouse есть встроенная возможность квот, которая считает потребление ресурсов. Но, к сожалению, не железных ресурсов типа CPU, дисков, а логических — количество обработанных запросов, строк и прочитанных байт. И можно настроить, например, максимум сто запросов в течение пяти минут и тысячу запросов в час.
Почему это важно? Потому что часть запросов аналитики будут выполнять вручную прямо из ClickHouse клиента. И всё будет хорошо. Но если у вас в компании продвинутые аналитики, они напишут скрипт, а в скрипте может быть ошибка. И эта ошибка приведет к тому, что запрос выполнится в бесконечном цикле. От этого и надо защититься.
Можно ли отдать результаты одного запроса десяти клиентам?
У нас есть несколько пользователей, которые любят приходить с очень большими запросами в один и тот же момент времени. Запрос большой, выполняется в принципе быстро, но из-за того, что таких запросов одновременно много, становится очень больно. Можно ли один и тот же запрос, который прилетел десять раз подряд, выполнить один раз, а результат его отдать десяти клиентам?Проблема в том, что именно результатов кэша или кэша промежуточных данных у нас нет. Есть page cache операционной системы, который позволит не читать данные с диска повторно, но, к сожалению, данные всё равно будут разжиматься, десериализовываться и обрабатываться повторно. 
Хотелось бы каким-то образом этого избежать, либо кэшируя промежуточные данные, либо выстроив похожие запросы в какую-то очередь и добавив кэш результатов. Сейчас у нас есть в разработке один pull request, который добавляет кэш запросов, но только для подзапросов в секции in и join — то есть решение неполноценное.
Тем не менее, у нас тоже возникает такая ситуация. Особенно канонический пример — это запросы с пагинацией. Есть отчёт, в нём есть несколько страниц, и идёт запрос limit 10. Потом то же самое, но limit 10,10. Затем ещё следующая страница. И спрашивается, зачем мы каждый раз это всё считаем? Но сейчас решения нет, и избежать этого никак нельзя.
Есть альтернативное решение, которое ставится сайдкаром рядом с ClickHouse — ClickHouse Proxy.
Кирилл Шваков: В ClickHouse Proxy есть встроенный рейт лимитер и встроенный кэш результатов. Там сделано очень много настроек, потому что решалась схожая задача. Proxy позволяет лимитировать запросы, выстраивая их в очередь, и настраивать, сколько по времени живёт кэш запросов. Если запросы были действительно одинаковые, Proxy отдаст их много раз, а сходит в ClickHouse всего однажды.
В Nginx тоже есть кэш в бесплатной версии, и это тоже будет работать. У Nginx даже есть настройки, что, если запросы пришли одновременно, он будет тормозить другие, пока один не выполнится. Но именно в ClickHouse Proxy настройка сделана гораздо лучше. Он делался именно под ClickHouse, именно под эти запросы, поэтому больше подходит. Ну и ставится просто. 
Как быть с асинхронными операциями и материализованными представлениями?
Есть такая проблема, что операции с реплейсинг-движком асинхронны — сперва записываются данные, потом происходит их схлопывание. Если под табличкой живёт материализованная табличка с какими-то агрегатами, то дубли в неё запишутся. И если нет какой-то сложной логики, то данные будут задублированы. Что можно с этим сделать?

Есть очевидное решение — реализовать триггер на определённый класс матвьюх при асинхронной операции схлопывания. Есть ли какие-нибудь «серебряные пули», планы по реализации подобных функциональностей?Стоит разобраться с тем, как работает дедупликация. То, о чём я сейчас расскажу, не относится к вопросу, но на всякий случай стоит об этом вспомнить.
При вставке в реплицированную таблицу есть дедупликация целиком вставленных блоков. Если вы повторно вставили один и тот же блок, содержащий такое же количество тех же самых строк в том же самом порядке, то данные дедуплицируются. Вы получите “Ok” в ответ на insert, но фактически будет записана одна пачка данных, и она продублирована не будет.
Это нужно для определённости. Если во время вставки вы получили “Ok”, значит ваши данные вставлены. Если вы получили ошибку от ClickHouse, значит они не вставлены, и нужно вставку повторить. Но если во время вставки разорвалось соединение, то вы не знаете, вставлены данные или нет. Единственный вариант — это повторить вставку снова. Если данные на самом деле были вставлены, и вы их вставили повторно, есть дедубликация блоков. Она нужна во избежание дубликатов. 
И важно ещё, как она работает для материализованных представлений. Если данные были дедуплицированы при вставке в основную таблицу, то в материализованное представление они тоже не пойдут.
Теперь по поводу вопроса. У вас более сложная ситуация, потому что вы записываете дубликаты отдельных строчек. То есть не пачка целиком задублирована, а именно конкретные строчки, и они в фоне схлопываются. Действительно, данные будут схлопываться в основной таблице, а в материализованное представление пойдут не схлопнутые, и при мерджах ничего с материализованными представлениями не произойдёт. Потому что материализованное представление — это не что иное как триггер на insert. При других операциях ничего дополнительно с ним не происходит.
И я здесь порадовать никак не могу. Надо только искать конкретное решение для этого случая. Например, можно ли в материализованном представлении тоже сделать его реплейсинг, и способ дедупликации, может быть, будет так же работать. Но к сожалению, не всегда. Если оно агрегирующее, то не получится. 
Кирилл Шваков: У нас тоже костылестроение в своё время ещё то было. Была проблема, что есть показы рекламы, и есть некоторые данные, которые мы можем показывать в реалтайме — это просто показы. Они редко когда дублируются, но, если такое происходит, мы их потом всё равно схлопнем. И были вещи, которые дублировать нельзя — клики и вся эта история. Но показывать тоже их хотелось практически сразу.
Как были сделаны материализованные представления? Были представления, куда пишется напрямую — идёт запись в сырые данные, и пишется во вьюшки. Там в какой-то момент данные не очень правильные, они дублируются и так далее. И есть вторая часть таблицы, где они абсолютно так же выглядят, как и материализованные представления, то есть по структуре они абсолютно одинаковые. Раз в какое-то время мы пересчитываем данные, досчитываем данные без дубликатов, пишем в те таблицы. 
Мы ходили через API — в ClickHouse руками это работать не будет. И API смотрит: когда у меня есть дата последнего добавления в таблицу, где гарантированно уже правильные данные, посчитанные, и он делает запрос к одной таблице и к другой таблице. Из одной запрос выбирает до определённого количества времени, и из другой добирает то, что ещё не посчитано. И это работает, но не средствами одного ClickHouse.
Если у вас API какое-то есть — для аналитиков, для пользователей — то в принципе, это вариант. Вы всегда досчитываете, всегда пересчитываете. Это можно делать раз в сутки или ещё в какое-то время. Вы сами для себя выбираете диапазон, который вам не нужен и не критичен.
В ClickHouse много логов. Как я могу видеть всё, что происходит с сервером, в моменте?
В ClickHouse очень большое количество различных логов, и это количество повышается. В новых версиях какие-то из них даже по умолчанию включены, в старых версиях их надо включать при обновлении. Тем не менее, их всё больше и больше. Хотелось бы видеть в конечном счёте, что происходит сейчас у меня с сервером, может быть, на каком-то сводном дашборде. 

Нет ли у вас в команде ClickHouse, или в командах ваших друзей, которые поддерживают некий функционал готовых дашбордов, которые бы эти логи отображали в виде уже готового продукта? В конечном счёте, просто так логи смотреть в ClickHouse — это здорово. Но очень классно, если бы это было уже в виде дашборда приготовлено. Я бы от этого кайфанул. Дашборды есть, правда они не стандартизированные. У нас в компании где-то 60 команд используют ClickHouse, и самое странное, что у многих из них дашборды, которые они сами себе сделали, и чуть-чуть другие. Некоторые команды используют внутреннюю инсталляцию «Яндекс.Облака». Там есть некоторые готовые отчеты, хотя и не все необходимые. У других своё. 
У моих коллег из «Метрики» есть свой дашборд в Grafana, а у меня есть свой по их же кластеру. Я там смотрю штуки типа кэш хит для кэша засечек. И даже ещё сложнее то, что мы используем разные инструменты. Свой дашборд я создавал на очень старом инструменте, который называется Graphite-web. Он совершенно некрасивый. И я так до сих пор им и пользуюсь, хотя Grafana, наверное, была бы удобнее и красивее. 
Базовая вещь в дашбордах одинаковая. Это системные метрики по кластеру: CPU, память, диск, сеть. Другие — количество одновременных запросов, количество одновременных мерджей, количество запросов в секунду, максимальное количество кусков для партиций таблиц MergeTree, лаг репликации, размер очереди репликации, количество вставленных строк в секунду, количество вставленных блоков в секунду. Это всё, что получается не из логов, а из метрик.
Владимир Колобаев: Алексей, я хотел бы немножко скорректировать. Есть Grafana. У Grafana есть datasource, которым является ClickHouse. То есть я могу из Grafana делать запросы сразу в ClickHouse. В ClickHouse есть таблица с логами, она у всех одинаковая. Я хочу в результате в Grafana обращаться к этой таблице логов и видеть те запросы, которые прикладывает мой сервер. Было бы здорово иметь такой дашборд.
Я его навелосипедил сам. Но у меня возникает вопрос — если оно всё стандартизированное, и Grafana используется всеми подряд, почему в «Яндексе» нет такого официального дашборда?
Кирилл Шваков: На самом деле datasource, который к ClickHouse, сейчас поддерживает Altinity. И я просто хочу дать вектор, куда копать и кого толкать. Можно спросить с них, потому что «Яндекс» всё-таки делает ClickHouse, а не историю вокруг него. Altinity — это основная компания, которая сейчас продвигает ClickHouse. Они его не бросят, а будут поддерживать. Потому что в принципе, чтобы загрузить дашборд на сайт Grafana, нужно только зарегистрироваться и залить его — проблем особых нет. 
Алексей Миловидов: За последний год в ClickHouse добавилось много возможностей по профилированию запросов. Есть метрики для каждого запроса по использованию ресурсов. А совсем недавно добавлен ещё более низкоуровневый профайлер запросов, чтобы смотреть, где запрос проводит каждую миллисекунду. Но чтобы воспользоваться этой функциональностью, мне приходится открыть консольный клиент и набрать запрос, который я постоянно забываю. Я его куда-то сохранил и постоянно забываю, куда именно. 
Я бы хотел, чтобы был инструмент, в котором просто написано — вот ваши тяжёлые запросы, сгруппированные по классам запросов. Нажал на какой-нибудь, и мне бы сказали, что он тяжёлый поэтому. Сейчас такого решения нет. И действительно довольно странно, что, когда люди меня спрашивают: «Скажите, есть какие-нибудь готовые дашборды для Grafana?», я говорю: «Зайдите на сайт Grafana, там комьюнити “Дашборды”, и там есть дашборд от Димка, есть дашборд от Костяна. Что это такое, я не знаю, я сам не пользовался».
Как воздействовать на мерджи, чтобы сервер не падал в OOM?
У меня есть таблица, в таблице всего одна партиция, она ReplacingMergeTree. Я в неё пишу данные в течение четырёх лет. Мне надо было сделать в неё альтер и удалить кое-какие данные.

Я это сделал, и в ходе обработки этого запроса была съедена вся память на всех серверах кластера, и все серверы кластера дружно ушли в OOM. Потом они все вместе встали, начали выполнять мердж этой же самой операции, этого блока данных, и снова упали в OOM. Потом они снова встали и снова упали. И эта штука не прекращалась.

Потом оказалось, что это на самом деле баг, который ребята пофиксили. Это очень здорово, спасибо большое. Но осадок-то остался. И теперь, когда я думаю о том, что надо делать некий мердж в таблице, у меня появляется вопрос — а почему я не могу взять и на эти мерджи каким-то образом воздействовать? Например, ограничить их по количеству требуемой оперативной памяти, или в принципе по их количеству, которое будет обрабатывать конкретно эту таблицу.

У меня есть таблица, которая называется «Метрики», обрабатывай мне её, пожалуйста, в два потока. Не надо плодить десять или пять мерджей параллельно, сделай в два. Я думаю, что в два у меня памяти хватит, а на то, чтобы десять обрабатывать, может не хватить. Почему страх остаётся? Потому что таблица растёт, и когда-нибудь я столкнусь с ситуацией, что в принципе уже не из-за бага, а из-за того, что данные будут меняться в таком большом количестве, что мне просто памяти на сервере не хватит. И тогда сервер будет падать в OOM при мердже. Причем мутацию я могу отменить, а мерджи уже нет.Вы знаете, при мерджах сервер не будет падать в OOM, потому что при мердже используется количество оперативки только на один маленький диапазон данных. Так что всё будет хорошо независимо от объёма данных.
Владимир Колобаев: Хорошо. Тут момент такой, что после того, как сделали баг фикс, я скачал себе новую версию, и на другой таблице, более маленькой, где партиций много, сделал подобную операцию. И в ходе мерджа на сервере было сожжено порядка 100 Гб оперативной памяти. У меня было 150 занято, 100 съело, и осталось окно на 50 Гб, поэтому я в OOM не упал.
Что меня на данный момент защищает от того, чтобы я не падал в OOM, если он действительно потребляет по 100 Гб оперативной памяти? Как быть в ситуации, если вдруг оперативная память на мерджах закончится?
Алексей Миловидов: Есть такая проблема, что расход оперативной памяти именно на мерджи не ограничивается. И вторая проблема состоит в том, что, если какой-то мердж был назначен, то его необходимо выполнить, потому что он записан в лог репликации. Лог репликации — это те действия, которые нужны, чтобы привести реплику в консистентное состояние. Если не сделать ручные манипуляции, которые этот лог репликации откатит назад, мердж придётся, так или иначе, выполнить.
Конечно, было бы не лишнем иметь ограничение по оперативке, которое «на всякий случай» защищает именно от OOM. Оно не поможет мерджу выполниться, он будет начинаться снова, доходить до какого-то порога, кидать исключение, а потом снова начинаться — ничего хорошего из этого не выйдет. Но в принципе ограничение это ввести было бы полезно.
Как будет происходить разработка Golang-драйвера для ClickHouse?
Golang-драйвер, который написал Кирилл Шваков, сейчас официально вроде как поддерживается командой ClickHouse. Он в репозитории ClickHouse, он теперь большой и настоящий.

Небольшая ремарка. Есть замечательное и всеми любимое хранилище нормальных форм бесконечного порядка — это Vertica. У них тоже есть свой официальный python-драйвер, который поддерживается разработчиками Vertica. И несколько раз было такое, что версии хранилища и версии драйвера весьма круто разъезжались, и драйвер в какой-то момент переставал работать. И второй момент. Поддержка этого официального драйвера, сдается мне, ведётся системе «ниппель» — ты пишешь им issue, и оно висит вечно.

У меня два вопроса. Сейчас Golang-драйвер Кирилла — это почти дефолтный способ коммуницировать из Golang с ClickHouse. Разве что кто-то через http интерфейс коммуницирует до сих пор, потому что ему так нравится. Как будет происходить разработка этого драйвера? Будет ли она синхронизироваться с какими-то breaking changes в самом хранилище? И каков порядок рассмотрения issue? Кирилл Шваков: Первое — как всё устроено бюрократически. Этот момент не обсуждался, поэтому ответить мне нечего.
Чтобы ответить на вопрос про issue, нужна небольшая история драйвера. Я работал в компании, в которой было много данных. Это была рекламная крутилка с огромным количеством событий, которые нужно было где-то хранить. И в какой-то момент появился ClickHouse. Мы налили туда данные, и первое время всё было хорошо, а потом ClickHouse упал. На тот момент мы решили, что оно нам не надо. 
Через год мы вернулись к идее использования ClickHouse, и нам нужно было как-то туда писать данные. Вводная была такая — железо очень слабое, ресурсов мало. Но мы всегда так работали, и поэтому посмотрели в сторону нативного протокола.
Так как мы работали на Go, было понятно, что нужен драйвер на Go. Я делал его практически фултайм — это была моя рабочая задача. До какого-то момента мы его довели, и в принципе никто не предполагал, что кто-то кроме нас будет его использовать. Потом пришёл CloudFlare ровно с такой же проблемой, и в какое-то время мы с ними работали очень ровно, потому что у них были одни и те же задачи. Причём мы это делали и в ClickHouse сам, и в драйвер. 
В какой-то момент я просто перестал им заниматься, потому что моя активность с точки зрения ClickHouse и с работой немножко поменялась. Поэтому issues не закрываются. Периодически в репозиторий коммитят люди, которым сами что-то нужно. Тогда я смотрю pull request и иногда даже что-то сам правлю, но это случается редко.
К драйверу хочется вернуться. Несколько лет назад, когда всё это дело начиналось, ClickHouse был тоже другой и с другими возможностями. Сейчас же есть понимание, как переделать драйвер, чтобы было хорошо. Если это произойдёт, то версия 2 будет в любом случае несовместима из-за накопленных костылей. 
Как это дело организовать, я не знаю. У меня самого времени не так много. Если какие-то люди будут допиливать драйвер, я смогу им помогать и рассказывать, что делать. Но именно активное участие «Яндекса» в развитии проекта пока никак не обсуждалось. 
Алексей Миловидов: На самом деле пока нет никакой бюрократии по поводу этих драйверов. Единственное — они вынесены в официальную организацию, то есть этот драйвер признан официальным решением по умолчанию для Go. Есть какие-то другие драйверы, но они идут отдельно. 
У нас внутри никакой разработки для этих драйверов нет. Вопрос — сможем ли мы нанять отдельного человека, не на конкретно этот драйвер, а на развитие всех комьюнити-драйверов, или сможем найти кого-то снаружи. 
Внешний словарь не поднимается после перезагрузки с включенной настройкой lazy_load. Что делать?
У нас включена настройка lazy_load, и после перезагрузки сервера словарь сам не поднимается. Он поднимается только после того, как пользователь обратится к этому словарю. И при первом обращении выдаёт ошибку. Можно ли как-то автоматически средствами ClickHouse загружать словари, или нужно самим всегда контролировать их готовность, чтобы пользователи не получали ошибок?

Возможно у нас старая версия ClickHouse, поэтому словарь автоматически не загружался. Может быть такое?Во-первых, словари можно форсированно загрузить с помощью запроса system reload dictionaries. Во-вторых, по поводу ошибки — если словарь уже загружен, то запросы будут работать по тем данным, которые были загружены. Если словарь ещё не был загружен, то он будет загружаться прямо во время запроса.
Для тяжёлых словарей это не очень удобно. Например, нужно притянуть миллион строк из MySQL. Кто-то делает простой select, но этот select будет ждать тот самый миллиона строк. Здесь есть два решения. Первое — выключить lazy_load. Второе — когда сервер поднимается, перед тем, как включить на него нагрузку, сделать system reload dictionary или просто выполнить запрос, который использует словарь. Тогда словарь будет загружен. Нужно самим контролировать доступность словарей со включенной настройкой lazy_load, потому что автоматом ClickHouse их не подтягивает.
На последний вопрос ответ — то ли версия старая, то ли надо отлаживать. 
Как быть с тем, что system reload dictionaries не подгружает ни один из множества словарей, если хотя бы один из них падает с ошибкой?
Есть ещё вопрос по поводу system reload dictionaries. У нас два словаря — один не прогружается, второй прогружается. System reload dictionaries в таком случае не подгружает ни один словарь, и приходится точечно подгружать конкретный по его названию c помощью system reload dictionary. Это тоже связано с версией ClickHouse?Хочу обрадовать. Это поведение менялось. Значит, если вы обновите ClickHouse, то оно тоже поменяется. Если вас не устраивает текущее поведение system reload dictionaries, обновитесь, и будем надеяться, что оно изменится в лучшую сторону.
Есть ли способ конфигурировать реквизиты в конфиге ClickHouse, но не светить их при ошибках?
Следующий вопрос про ошибки, связанные со словарём, а именно реквизиты. Мы прописали реквизиты подключения в конфиге ClickHouse к словарю, и при ошибке мы эти реквизиты и пароль получаем в ответ. 

Мы решили эту ошибку вынесением реквизитов в конфиг драйвера ODBC. Есть ли какой-то способ сконфигурировать реквизиты в конфиге ClickHouse, но не светить эти реквизиты при ошибках?Здесь решение действительно — указывать эти credentials в odbc.ini, а в самом ClickHouse указывать только ODBC Data Source Name. Для остальных источников словарей такого не будет — ни для словаря с MySQL, ни для остальных вы не должны видеть пароль при сообщении об ошибке. Для ODBC я тоже посмотрю — если такое есть, надо это просто убрать.
Бонус: фоны для Зума с посиделок
По клику на картинку для самых упорных читателей откроются бонусные фоны с посиделок. Тушим пожар вместе с маскотами технологий Авито, совещаемся с коллегами из комнаты сисадмина или олдскульного компьютерного клуба и проводим дейли под мостом на фоне граффити.
",32
2020-10-21,Новые вопросы о деревьях,https://www.habr.com/ru/post/523400/,"Несколько недель назад, после прогулки по лесам, я написал статью загадке разнообразия лесных деревьев. На своём пути я нашёл с десяток видов, имеющих общую среду обитания и, очевидно, конкурирующих за одинаковые ресурсы — в основном, за доступ к солнечному свету. Экологический принцип гласит, что один вид должен выиграть в этой конкуренции и вытеснить все остальные, но деревья, похоже, не читали учебников по экологии.

В своём эссе я также упомянул ещё три беспокоивших меня вопроса о деревьях. В статье-продолжении я хочу чуть глубже изучить эти три вопроса.
Вопрос 1: Почему листья деревьев имеют такую разнообразную форму? 
Сверху: белый дуб (Quercus alba), красный дуб (Quercus rubra), горный дуб (Quercus palustris), сахарный клён (Acer saccharum). Внизу: кария овальная (Carya ovata), берёза вишнёвая (Betula lenta). Все образцы были собраны вдоль тропы Роберта Фроста в Амхерсте, штат Массачусетс, с деревьев, находящихся на расстоянии не более ста метров друг от друга.

У ботаников есть сложный терминологический словарь для описания формы листьев: сердцевидный (как сердце на валентинке), клиновидный, мечевидный, стреловидный, копьевидный, обратноланцетный (перевёрнутый копьевидный), пальчатый (листья расходятся как пальцы), гитарообразный, почкообразный, крупнопильчатый, лопатообразный. И этот список ни в коем случае не исчерпывающий.

Стивен Вогел в своей книге The Life of a Leaf 2012 года перечисляет множество факторов и сил, которые могут иметь влияние на форму листа. Например, листья не могут быть слишком тяжёлыми, иначе они сломают черешок. С другой стороны, они не могут быть слишком хрупкими и тонкими, иначе их разорвёт ветер. Кроме того, листья не должны создавать слишком большое аэродинамическое сопротивление, иначе во время бури всё дерево может упасть.

Основная задача листа — фотосинтез: получение солнечного света, соединение молекул углекислого газа и воды, синтез углеводов. Эффективное выполнение этой задачи накладыает дополнительные ограничения на структуру листа. По мере возможности лист должен поворачивать свою поверхность к солнцу, максимизируя поток поглощаемых фотонов. Но важен и контроль температуры; биосинтезирующая система прекращает свою работу, если лист слишком горячий или холодный.

Вогел указывает, что малозаметные особенности формы листа могут иметь значимое влияние на тепловые и аэродинамические характеристики. Например, конвекционное охлаждение наиболее эффективно по краям листа; температура растёт с увеличением расстояния до ближайшего края. В средах, где существует риск перегрева, формы листьев минимизируют это расстояние; например, похоже, что лопастные формы дубовых листьев будут иметь преимущество над более простыми, округлыми формами. Но выбор между вычурными и компактными формами зависит и от других факторов. Широкие листья с выпуклыми формами получают больше всего солнечного света, но это не всегда может быть хорошо. Листья с кружевовидной структурой позволяют пятнам солнечного света проникать дальше и участвовать в фотосинтезе нескольким слоям листьев.

Естественный отбор — превосходный инструмент для подбора компромиссов между этих взаимосвязанных критериев. Если существует одна комбинация признаков, лучше всего подходящая для листьев, растущих в определённой среде обитания, то можно ожидать, что эволюция её найдёт. Но я не наблюдаю свидетельств схождения к оптимальному решению. Напротив, даже близко связанные виды имеют довольно сильно отличающиеся листья.

Взгляните на листья трёх дубов в левом верхнем углу представленной выше фотографии. Очевидно, что они являются различными вариациями одной темы. Общим для этих листьев является последовательность напоминающих полуострова выступов, ответвляющихся по очереди слева и справа от центральной линии. Вариации заключаются в количестве выступов (в этих образцах — от трёх до пяти на каждую сторону), их форме (закруглённые или острые) и глубине впадин между «полуостровами». Причинами таких вариаций могут быть генетические различия всего в нескольких локусах. Но почему листья приобрели такие различные характеристики? Из-за какой эволюционной силы для белого дуба лучше скруглённые края, а для красного и горного — острые?

Учёные многое узнали о механизмах развития, генерирующих форму листьев. С точки зрения биохимии основными действующими силами являются растительные гормоны, называемые ауксинами; их пространственное распределение и перемещение по тканям растения регулируют локальные скорости роста, а значит, и паттерн развития. (В обзорной статье 2014 года, написанной Джереми Дхаром и Ашвани Париком, подробно описываются эти аспекты формы листьев.) В математике Адам Рунионс, Милтос Тсиантис и Пшемыслав Прусинкевич вывели алгоритм, способный генерировать широкий диапазон форм листьев с поразительной похожестью на реальные образцы. (Их статья 2017 года вместе с исходным кодом и видео выложены по адресу algorithmicbotany.org/papers/leaves2017.html.) При разных значениях параметров одна и та же программа генерирует формы, которые можно распознать как дубы, клёны, платаны и другие деревья. Однако все эти работы отвечают на вопрос как, а не зачем.

Похоже, что ещё одно свойство листьев деревьев — их размер — реагирует на давление эволюции очень простым способом. Среди всех наземных растений (не только деревьев) площадь листа варьируется на порядок миллиона — от примерно 1 кв. миллиметра на лист до 1 кв. метра. В своей статье 2017 года Иэн Райт и его коллеги отмечают, что эта вариативность сильно коррелирует с климатом. В тёплых влажных регионах предпочтение отдаётся большим листьям; вспомним, например, банан. В холодных сухих средах, например, на альпийских хребтах, в основном растут крошечные растения с ещё более мелкими листьями. То есть естественный отбор в сфере листьев деревьев вполне процветает; нам просто кажется, что чётких предпочтений относительно формы листьев нет.

Или я упускаю что-то важное? Кое-где в природе мы находим вычурные вариации, которые кажутся неоправданными, если рассматривать их только с мрачной точки зрения выживания наиболее приспособленного. Подумайте, например, о красочной раскраске перьев птиц. На заднем дворе моего дома частыми гостями становятся кардиналы и голубые сойки, но я не трачу время на размышления о том, красный или синий цвет оптимальнее для выживания в этой среде обитания. Как и не ожидаю я, что эти два вида сольются в один, имеющий какой-нибудь оттенок фиолетового. Их броское оперение является не адаптацией к физической среде, а элементами системы коммуникаций; они отправляют сигналы конкурентам или потенциальным половым партнёрам. Может ли что-то подобное происходит с формой листа? Сохраняют ли разные виды дуба уникальные листья, чтобы демонстрировать себя животным, помогающим с опылением или распространением семян? Я считаю эту мысль маловероятной, но ничего лучше у меня нет.
Вопрос 2: Почему деревья такие высокие? Да, этот вопрос слишком прост! Мы знаем, почему деревья растут ввысь — они стремятся к небу. Это их единственная надежда сбежать из сумрачных глубин нижних ярусов леса и получить свою долю солнечных лучей. Другими словами, если ты лесное дерево, тебе нужно расти ввысь, потому что высоки твои соседи: они закрывают тебя тенью. А соседи растут ввысь, потому что высок ты. Это классическая гонка вооружений. У Вогела есть проницательный комментарий на эту тему:
В любом ряду поколений, независимо пришедших к форме древоподобных растений, множество видов достигает больших высот. Я воспринимаю это как высоту глупости… Мы с большой вероятностью видим живой пример ограничений эволюционного планирования.

Договорённость об ограничении размеров ствола позволила бы всем особям приносить больше семян и начинать выращивать семена в более раннем возрасте. Однако глупый процесс эволюции не смог этого понять — предвидение явно не является его сильной стороной. Разумеется, порицание Вогелом дарвиновкой эволюции — всего лишь шутка. Однако я считаю, что вопрос договоров об ограничении высоты заслуживает более серьёзного внимания.

Лесные деревья Востока США часто вырастают до 25 или 30 метров (около 100 футов). Для возведения подобной конструкции требуются огромные инвестиции материала и энергии. Для обеспечения достаточной прочности и жёсткости обхват ствола должен расти как степень  от высоты, а значит, площадь его сечения  растёт как куб от высоты. Из этого следует, что удвоение высоты дерева увеличивает его массу в 16 раз.

Большая высота создаёт необходимость ещё одних (постоянных) затрат — метаболических. Каждый день живое дерево должно поднимать 500 литров воды (массой 500 кг) от зоны корней на уровне земли до листьев кроны. Это подобно перетаскиванию воды, достаточной для заполнения четырёх-пяти ванн, из подвала здания на десятый этаж.

Также высота увеличивает угрозы жизни и здоровью дерева. Более высокий ствол создаёт более длинный рычаг для любой силы, которая может и свалить дерево. В дополнение к этому риску, средние скорости ветра растут с увеличением расстояния до земли.


Стоя на лесной почве, я запрокидываю голову и смотрю на лиственные кроны, находящиеся сверху огромных деревянных колонн. Я не могу не считать эти деревья на подпорках огромными пустыми тратами ресурсов. Они выглядят ещё глупее, чем иглоподобные башни апартаментов для миллиардеров, пронизывающие сегодня очертания Манхэттена. В таких зданиях все этажи имеют хоть какое-то применение. В лесу стволы деревьев оголяются от листьев, а иногда и от ветвей на 90 процентов от своей длины; здесь заняты только пентхаусы.

Если бы деревья каким-то образом могли собраться вместе и заключить сделку — установить порядок зонирования или кодекс строительства, то от этого бы выиграли они все. Возможно, они могли бы объявить максимумом высоту 10 метров. Для крон деревьев ничего бы не изменилось; это правило бы просто «урезало» нижние 20 метров ствола.

Если каждое дерево выиграло бы от такого соглашения, почему в природе эволюционно не возникают подобные «урезанные» леса? Обычно на вопрос «почему все не могут жить в согласии» отвечают, что эволюция работает не так. Общепринято, что естественный отбор является совершенно эгоистичным и индивидуалистским, даже если это вредит. Достигшее предела высоты в 10 метров дерево говорит себе: «Да, это хорошо: я получаю достаточно света без необходимости стоять на цыпочках. Но ведь может быть и ещё лучше – если я вытяну свой ствол ещё на один-два метра, то получу ещё большую долю солнечной энергии». Разумеется, другие деревья рассуждают точно так же, поэтому эта тщетная гонка вооружений продолжается. Как сказал Вогел, предвидение явно не является сильной стороной эволюции.

Я склонен согласиться с этим суровым взглядом на эволюцию, но не совсем уверен, что он на самом деле объясняет то, что мы видим в лесу. Если в подобных ситуациях у эволюции нет места совместным действиям, как получается, что все деревья прекращают рост примерно на одной высоте? В частности, если соглашение о пределе роста в 10 метров было бы нарушено неистовым жульничеством, то почему же то же самое не происходит на 30 метрах?

Можно предположить, что 30 метров являются физиологическим пределом, что деревья расли бы выше, если бы могли, но этому мешает какое-то физическое ограничение. Вероятно, они не могут поднимать воду выше. Я бы посчитал это очень многообещающей гипотезой, если бы не секвойи и калифорнийские мамонтовые деревья на Западе США. Эти деревья не слышали ни о каких подобных физических барьерах. Они спокойно вырастают до 70 или 80 метров, а некоторые образцы превышают 100 метров. Следовательно мы должны задать деревьям Западного побережья не только вопрос «Почему вы такие высокие?», но и «Почему вы не выше?»

Я могу придумать по крайней мере одну убедительную причину, по которой лесные деревья могут расти до одинаковой высоты. Если дерево ниже среднего, то оно будет страдать от нахождения в тени. Но высовывание головы и плеч из толпы тоже имеет свои недостатки: такое выделяющееся дерево будет подвергаться более сильным ветрам, большему весу льда и снега, а также, вероятно, иметь повышенную вероятность удара молнии. То есть слишком сильное отклонение в любую сторону от средней высоты может быть наказано снижением репродуктивного успеха. Однако остаётся важный вопрос: как все деревья достигают консенсуса в том, какая высота лучше?

Ещё один возможный вариант: может быть, высота лесных деревьев является не результатом гонки вооружений, а реакцией на хищников. Деревья поднимают свои листья вверх, чтобы спасти их от травоядных. Не могу сказать, что это не так, но мне кажется это маловероятным. В лесах Северной Америки не бродят жирафы (а если бы и бродили, то 10 метров было бы больше чем достаточно, чтобы защитить листья). Большинство поедающих листья деревьев животных – это членистоногие, которые или умеют летать (взрослые насекомые), или ползают по стволу (гусеницы и другие личинки). Следовательно, высота не может полностью защитить листья, и в лучшем случае способна служить лишь сдерживающим фактором. Листья деревьев – неполноценное питание; вероятно, некоторые мелкие травоядные посчитают, что за ними стоит взбираться на 10 метров, но не на 30.
Вопрос 3: Почему деревья представляют собой деревья (а не другие виды графов)?  Для биолога дерево – это древесное растение достаточной высоты. Для математика дерево – это граф без петель. Оказывается, математические и биологические деревья имеют общие важные свойства.

На представленной ниже схеме показано два математических графа. Это набор точек (более формально называемых вершинами), соединённый отрезками прямых (рёбрами).


Говорят, что граф связанный, если можно перейти от любой вершины к любой другой вершине по определённой последовательности рёбер. Оба показанных выше графа являются связанными. Математические деревья являются подвидом связанных графов. Они минимально связаны: между любыми двумя вершинами есть ровно один путь. 

[Тонкая техническая деталь: путь – это последовательность рёбер, в каждой любое ребро может встречаться не более одного раза. Это исключает бессмысленные возвраты туда-обратно. Последовательность вида x, y, x, z не является путём.]

Граф слева является деревом. Красной линией показан уникальный путь от a к b. Граф справа не является деревом. В нём есть два пути от a в b (красная и жёлтая линии).

Вот ещё один способ описания математического дерева: это граф, подчиняющийся антиматримониальному правилу — когда ветви расходятся в стороны, ни одна из них не соединяется снова. Биологические деревья в общем случае устроены так же: две ответвившихся от ствола ветки не вернутся к стволу и не объединятся друг с другом. Другими словами, в них нет циклов или замкнутых петель. Паттерн расходящихся ветвей, которые никогда не сойдутся вместе, очевидно заметен в повторяющейся структуре показанного ниже дерева. (Это дерево — сосна с острова Норфолк, аборигенная для южной части Тихого океана, но этот образец был сфотографирован в Сардинии.)


Деревья достигли больших успехов и без петель в ветвях. Зачем растению вообще может понадобиться, чтобы его структурные элементы росли кругами?

Я могу придумать две причины. Первая — это механическая прочность и устойчивость. Инженеры знают насколько ценны треугольники (минимально возможные замкнутые петли) в проектировании жёстких конструкций. Как ценны и арки — два вертикальных элемента, которые не могут стоять по отдельности. не опираясь друг на друга. Деревья не могут воспользоваться преимуществами подобных трюков; их ветви являются консолями, поддерживаемыми только в точке соединения со стволом или родительской веткой. Структуры с петлями позволили бы создавать различные виды распорок и креплений. Вторая причина — надёжность. Наличие множественных каналов от корней к листьям повысило бы надёжность системы циркуляции дерева. Травма рядом с основанием ветви больше бы не обрекала на смерть все структуры выше точки повреждения.

Сети с множественными путями между узлами применяются в других областях природы, и даже в других аспектах анатомии деревьев. Сетчатые каналы на показанном ниже изображении — это жилки, распределяющие жидкости и питательные вещества в листе красного дуба. Самые крупные жилы имеют древообразную структуру, однако каналы поменьше образуют вложенную иерархию петель внутри петель. (Паттерн напоминает мне карту старинного города.) Благодаря множеству избыточных путей насекомое, откусившее часть посередине этой сети, не перекроет коммуникации с остальной частью листа.


Отсутствие петель в структурах большего размера (стволах и ветвях) может быть естественным последствием программы развития, управляющей ростом дерева. Для описания такого роста венгро-голландский биолог Аристид Линдермайер изобрёл семейство формальных языков (называемых теперь L-системами). Языки — это перезаписываемые системы: мы начинаем с одного символа (аксиомы) и заменяем её на строку символов, определяемую правилами грамматики. Затем строка, полученная от этой замены, становится новыми входными данными того же процесса перезаписи, а каждый из её символов заменяется другой строкой, образованной согласно правилам грамматики. В конце символы интерпретируются как команды для построения геометрической фигуры.

Вот пример грамматики L-системы для построения мультяшных двухмерных деревьев:

     f  ⟶  f [r f] [l f]
     l  ⟶  l
     r  ⟶  r
Символы f, l и r являются базовыми элементами языка; в процессе интерпретации в качестве команд для рисования, они обозначают forward («вперёд»), left («влево») и right («вправо»). Первое правило грамматики заменяет любое вхождение f строкой f [l f] [r f]; второе и третье правила ничего не меняют, заменяя l и r на них же. Квадратные скобки являются границами подпрограммы. Дойдя до левой скобки, система запоминает свою текущую позицию и ориентацию рисунка. Затем она исполняет инструкции внутри скобок, а дойдя до правой скобки, возвращается назад к сохранённой позиции и ориентации.

Начав с аксиомы f, грамматика создаёт последовательность ещё более сложных последовательностей команд:

Этап 0:    f
Этап 1:    f [r f] [l f]
Этап 2:    f [r f] [l f] [r f [r f] [l f]] [l f [r f] [l f]]]
Когда этот процесс перезаписи продолжается ещё в течение нескольких этапов, а затем преобразуется в графический вывод, то мы видим побег, вырастающий в молодое дерево, форма которого напоминает вяз.

[Я упустил некоторые детали. На каждом этапе длина шага forward (вперёд) уменьшается на коэффициент 0,6. А все повороты, как влево (left), так и вправо (right) выполняются на угол 20 градусов.]


Подобные L-системы могут создавать широкий диапазон различных ветвящихся структур. Более сложные версии такой же программы способны создавать реалистичные изображения биологических деревьев. (На веб-сайте Algorithmic Botany Университета Калгари есть множество примеров.) Чего L-системы не могут, так это создавать замкнутые петли. Для этого потребовался бы фундаментально иной тип грамматики, например, правило трансформации, получающее два символа или строки и создающее соединённый результат. (Обратите внимание, что на этапе 5 показанной выше схемы две ветви дерева кажутся наложенными друг на друга, но они не объединены. Граф не имеет вершины в точке пересечения.)

Если бы биомеханические механизмы, управляющие ростом и развитием деревьев, работали с теми же ограничениями, что и L-системы, у нас было бы удобное объяснение отсутствия петель в ветвлении биологических деревьев. Но, вероятно, это объяснение слишком уж удобное. Я говорил, что у деревьев нет петель, и в общем случае это так. Но как насчёт показанного ниже дерева — сфотографированной мной несколько лет назад лягерстремии на улицах Роли, штат Северная Каролина? (Она напоминает мне выразительную скульптуру Генри Мура.)


Это растение является деревом в ботаническом смысле, но совершенно точно не в математическом. Один ствол поднимается из земли и сразу же разделяется. На высоте моей талии у дерева четыре ветви, а чуть выше три из них воссоединяются. На высоте моей груди есть ещё одно разделение и ещё одно слияние. Дерево-бунтарь надсмехается над всеми канонами и традициями деревьев.

И лягерстремия является не единственным нарушителем правил. Горизонтальные ветки аборигенных для Индии баньянов подпёрты множеством доходящих до земли упоров. Показанный ниже баньян из Хило, Гавайи, в месте, где должен быть ствол, имеет пустую полость, окружённую десятками или сотнями поддерживающих побегов с перемычками над ними. Описанная выше L-система никогда бы не смогла создать такую сеть. Но если баньян способен на это, почему же другие деревья не пользуются тем же трюком?


В биологии вопрос «Почему x?» является укороченной версией «Каково эволюционное преимущество x?» или «Какой вклад вносит x в выживание и репродуктивный успех организма?» Для ответа на подобные вопросы часто нужен полёт воображения. Мы видим пятнистого коричневого мотылька на коре дерева и предполагаем, что его раскраска — это камуфляж, скрывающий насекомое от хищников. Мы видим яркую бабочку и приходим к выводу, что её обличье отпугивает, это предупреждение, сообщающее «Я ядовита, ты пожалеешь, если съешь меня».

Подобные объяснения имеют опасность превращения в простые сказки, наподобие истории Киплинга о том, как слон получил хобот в борьбе с крокодилом. [Французы и в самом деле называют их «почему-сказками» — les contes des pourquoi.]. Вместо дарвиновского механизма мутаций и отбора мы склонны думать с точки зрения потребностей и желаний отдельной личности. Это сложно, когда личность является животным, чья психическая жизнь (если она вообще есть) сильно далека от нашей. Боится ли мотылёк быть съеденным? Радуется ли бабочка, попав на полную полевых цветов солнечную лужайку? Мы этого не знаем.

И если уж нам сложно представить ощущения животных, то жизнь растений ещё дальше от нашего предела познаний. Жаждет ли цветок прилёта несущей пыльцу пчелы? Скорбит ли дуб, когда его жёлуди съедают белки? Что деревья думают о дятлах? Встретившись с подобными вопросами, я могу только пожать плечами. Я понятия не имею, чего хотят и боятся растения.

Другие люди заявляют, что знают гораздо больше о чувствах растительности. Немецкий лесник Петер Воллебен опубликовал книгу под названием «Тайная жизнь деревьев: что они чувствуют, как они общаются» (The Hidden Life of Trees: What They Feel, How They Communicate). Он сообщает, что деревья вскармливает своё потомство, поддерживают дружеские отношения с соседями и защищают болеющих и раненных членов своего сообщества. В определённой мере эти идеи имеют научное обоснование, они позаимствованы из работы, проделанной в лаборатории Сюзанн Симард в Университете Британской Колумбии. Симард, являющаяся руководителем проекта Mother Tree, изучает коммуникационные сети, образованные корнями деревьев и связанными с ними почвенными грибами.

Работа Симард кажется мне интересной. Но я считаю антропоморфическую реторику бесполезной и агрессивной. Её цель, насколько я понимаю, заключается в том, чтобы мы больше заботились о деревьях и лесах, считая, что они во многом похожи на нас; у них есть семьи и сообщества, дружба, альянсы. На мой взгляд, это совершенно неправильно. Сильнее всего деревья интригуют тем, что они являются чужаками среди нас, живыми существами, чья долгая, неподвижная и тихая жизнь никак не напоминает нашу собственную неистовую суматоху. Деревья представляют огромную загадку сами по себе, без всяких попыток их очеловечивания.

Переводы других статей Брайана Хейеса на Хабре
Брайан Хейес — мой любимый автор научно-популярных статей, поэтому за годы на Хабре накопилась целая серия его переводов:


Почему единственный вид деревьев не победил все остальные?
Неразбериха с Boeing 737 MAX: анализ возможных причин аварий
1000-мерный куб: можно ли сегодня создать вычислительную модель человеческой памяти?
Считаем кур, пока их не заклевали
Короткое плечо совпадения
Структура и случайность простых чисел
Проблемы эгоистов: дорожные пробки и парадокс Браеса
Небольшое расхождение

Дополнительное чтение
Dkhar, Jeremy, and Ashwani Pareek. 2014. What determines a leaf’s shape? EvoDevo 5:47.

McMahon, Thomas A. 1975. The mechanical design of trees. Scientific American 233(1):93–102.

Osnas, Jeanne L. D., Jeremy W. Lichstein, Peter B. Reich, and Stephen W. Pacala. 2013. Global leaf trait relationships: mass, area, and the leaf economics spectrum. Science 340:741–744.

Prusinkiewicz, Przemyslaw, and Aristid Lindenmayer, with James S. Hanan, F. David Fracchia, Deborah Fowler, Martin J. M. de Boer, and Lynn Mercer. 1990. The Algorithmic Beauty of Plants. New York: Springer-Verlag. PDF edition available at http://algorithmicbotany.org/papers/.

Runions, Adam, Martin Fuhrer, Brendan Lane, Pavol Federl, Anne-Gaëlle Rolland-Lagan, and Przemyslaw Prusinkiewicz. 2005. Modeling and visualization of leaf venation patterns. ACM Transactions on Graphics 24(3):702-711.

Runions, Adam, Miltos Tsiantis, and Przemyslaw Prusinkiewicz. 2017. A common developmental program can produce diverse leaf shapes. New Phytologist 216:401–418. Preprint and source code.

Tadrist, Loïc, and Baptiste Darbois Texier. 2016. Are leaves optimally designed for self-support? An investigation on giant monocots. arXiv:1602.03353.

Vogel, Steven. 2012. The Life of a Leaf. University of Chicago Press.

Wright, Ian J., Ning Dong, Vincent Maire, I. Colin Prentice, Mark Westoby, Sandra Díaz, Rachael V. Gallagher, Bonnie F. Jacobs, Robert Kooyman, Elizabeth A. Law, Michelle R. Leishman, Ülo Niinemets, Peter B. Reich, Lawren Sack, Rafael Villar, Han Wang, and Peter Wilf. 2017. Global climatic drivers of leaf size. Science 357:917–921.

Yamazaki, Kazuo. 2011. Gone with the wind: trembling leaves may deter herbivory. Biological Journal of the Linnean Society 104:738–747.

Young, David A. 2010 preprint. Growth-algorithm model of leaf shape. arXiv:1004.4388.",41
2019-06-21,"Пятничный пост: вопросы, которые любят девочки",https://www.habr.com/ru/company/vivaldi/blog/457138/,"

Всем привет!

Да, заголовок может кое-кого ввести в состояние временной потери чёткого понимания причинно-следственных связей и виртуально-пространственной ориентации, но на самом деле всё очень просто, не сложнее теории вероятности. Дело в том, что девочки от природы хорошие маркетологи. В частности, в огромном арсенале их инструментов прогнозирования и контроля за текущей ситуацией есть такой невинный вопрос: а ты помнишь, как мы с тобой познакомились? В общем и целом ничего особенно сложного в этом вопросе нет, но только если вы действительно знаете ответ на заданный вопрос. Если же вы по какой-то причине запамятовали о таком, безусловно, знаковом и ключевом событии в ваших отношениях, то результат может оказаться непредсказуемым вплоть до катастрофического.

И, как бы странно это ни выглядело, но здесь можно поддержать девушек в их желании знать историю вопроса: возможно, знание этой информации поможет им в будущем не совершать ошибки повторно и не знакомиться при тех же обстоятельствах с молодыми людьми, а также не исключено, что девушка сможет поведать о правильном шаге, сделанном много лет назад, уже своим дочкам или внучкам, чтобы помочь им не совершать ошибок и не искать вторую половинку там, где её искать трудно или вообще противопоказано.

В общем, хватит ходить вокруг да около. Давайте начистоту: нам в компании вдруг очень захотелось узнать — а как нас нашли наши пользователи? Какие добрые люди посоветовали им наш браузер, с которым они связали свою сетевую жизнь? В отличие от любознательных девушек, заставляющих своих молодых людей вспоминать детали самостоятельно, мы пошли вам навстречу и сразу подготовили несколько вариантов ответа. Таким образом, вы сможете очень легко удовлетворить наше любопытство. Ну, а собственно опрос находится по данной ссылке:

Ответить на простой вопрос можно здесь

На этом всё, желаем всем отличных выходных и комфортного веб-сёрфинга, естественно, с браузером Vivaldi!",-21
2022-02-17,"Парадокс Ферми – вовсе не парадокс, а вопрос; в чём он состоит, и как его решать (часть 1)",https://www.habr.com/ru/post/652111/,"

Принято считать, что Энрико Ферми первым описал парадокс, носящий теперь его имя. Парадокс заключается в следующем – можно выдвинуть множество аргументов в пользу того, что в нашей Галактике должна существовать достаточно продвинутая внеземная цивилизация (и не одна), способная расселиться по множеству планет у множества звёзд, и каким-то образом обнаружить своё присутствие для других обитателей. Однако все эти аргументы разбиваются о простую практическую проверку – несмотря на все наши технологические достижения, мы до сих пор не получили ни одного неопровержимого свидетельства подобной деятельности.

Однако на самом деле всё немного сложнее. 

Энрико Ферми – американский физик итальянского происхождения, один из создателей первого в мире ядерного реактора. Он внёс огромный большой вклад в развитие ядерной физики, физики элементарных частиц, квантовой и статистической механики, и считается одним из «отцов атомной бомбы».

Физик Эрик Джонс опубликовал свои исследования, связанные с разговором, в котором Ферми высказывался на тему существования иных цивилизаций. Поскольку тема была не очень серьёзной, и не связанной с ядерной физикой, разговор, конечно же, происходил за обедом. Об этом разговоре, к сожалению, известно только через третьих лиц. Как утверждается, как-то раз в 1950-м году в университете за обедом встретились физики Эмил Конопинский, Эдвард Теллер и Герберт Йорк – и сам Энрико Ферми, разумеется.

Конопинский вспоминал, что началом разговора послужили многочисленные свидетельства очевидцев о наблюдении неопознанных летающих объектов – тема в 1950-е годы весьма популярная (скептики презрительно называли эти объекты «летающими тарелочками»). В шутку обсудили карикатуру, посвящённую актуальной тогда проблеме, освещавшейся в газетах – в Нью-Йорке куда-то пропадали с улиц мусорные контейнеры, и карикатурист изобразил в одном из номеров инопланетян, таскающих эти контейнеры в свой космический корабль. Постепенно разговор перешёл на тему того, могут ли материальные объекты перемещаться быстрее скорости света. И внезапно Ферми удивил всех присутствовавших вопросом: «А где все?»

Будучи умными людьми, присутствующие сразу же поняли, что имеет в виду Ферми, и, в частности из-за того, что все поняли смысл этого внезапного вопроса, он был встречен дружным смехом. Однако современной формулировки «парадокса» сам Ферми никогда не давал.

Правда, Йорк утверждает, что Ферми затем провёл более конкретные вычисления, перемножая вероятности появления землеподобных планет, возникновения на них жизни, появления разумной жизни, появления и длительности существования высоких технологий – и в результате пришёл к выводу, что визит инопланетян на Землю уже давно должен был произойти, причём не один раз. Йорк говорит, что Ферми тогда же выдвинул несколько предположений, объясняющих, почему этого не произошло. «Либо межзвёздные перелёты невозможны, либо они не стоят затраченных усилий, либо технологически развитые цивилизации долго не живут».

Получается, что сам Ферми вообще не рассматривал эту тему, как парадокс. Он просто задал вопрос: «А где все?» и попытался найти на него ответ. Примерно той же линии рассуждений придерживается и Роберт Х. Грэй, американский аналитик, писатель и астроном. Он опубликовал работу, в которой подробно доказывает, что Ферми не формулировал этот парадокс, и что сама эта тема парадоксом не является.

Рассуждения в ключе «поскольку к нам не прилетели инопланетяне, их не существует» опубликовал астроном Майкл Харт более 25 лет спустя той встречи за обедом. Затем в 1980-м году идею развил космолог Фрэнк Типлер. При этом их аргументацию нельзя назвать парадоксом – разве что поспешным выводом. Так что «парадокс Ферми» на самом деле следовало бы назвать «гипотезой Харта-Типлера», а часто встречающееся мнение о том, что Ферми сомневался в существовании внеземных цивилизаций, неверно: Ферми лишь ставил под сомнение возможность межзвёздных перелётов, перемещения материальных объектов со скоростью, превышающей световую.

Что до существования жизни на других планетах, то на эту тему размышляли и другие великие мыслители, задолго до Ферми. Например, Константин Эдуардович Циолковский в своём очерке «Планеты заселены живыми существами» описывает возникновение такой жизни как нечто само собой разумеющееся, как гипотезу, которая почти наверняка правдива.

А через 10 лет после рассуждений Ферми доктор Фрэнк Дональд Дрейк, профессор астрономии и астрофизики калифорнийского университета в Санта-Круз, решил формализовать этот вопрос и записал своё знаменитое уравнение, попытавшись определить число внеземных цивилизаций в Галактике, с которыми у человечества есть шанс вступить в контакт. Вероятность в нём получалась через перемножение скорости звездообразования, доли звёзд, обладающих планетами, вероятности возникновения на планетах разумной жизни, и т.п. – всего 7 параметров.

К сожалению, истинного значения большинства этих параметров мы не знаем, а открытия в космологии примерно раз в десять лет кардинально меняют наше представление по крайней мере об одном из них. Поэтому все оценки количества таких цивилизаций имеют огромный разброс. Судя по всему, гадать об истинной величине этих параметров нам предстоит ещё довольно долго.

И всё же – «а где все?»

Гипотеза уникальной Земли
Возможно, наша Земля и возникшая на ней жизнь – невероятно редкое и уникальное явление. Например, Солнечная система уже много сотен миллионов лет находится в промежутке между спиральными рукавами галактики, что позволяет нам избегать губительного излучения, возникающего при взрывах сверхновых. Подобный взрыв, произойди он достаточно близко от нас, вполне способен уничтожить всё живое на планете.

Удачное столкновение с небесным телом привело к появлению Луны. Та, в свою очередь, стабилизировала прецессию земной оси и организовала нам приливы и отливы – возможно, эти процессы очень важны для возникновения и поддержания жизни.

Кроме того, сам вопрос возникновения жизни пока не решён окончательно – неизвестно, является ли это закономерным процессом или очень редкой случайностью. Поэтому, внеземных цивилизаций, по крайней мере, в нашей Галактике, может просто не существовать. Это самый простой и в каком-то смысле грустный вывод.

Кротовые норы к лучшей жизни
Академик Николай Семёнович Кардашёв (создатель шкалы развития цивилизаций) как-то выдвинул предположение о том, что высокоразвитые цивилизации могли воспользоваться «кротовыми норами» (своего рода «туннелями в пространстве»), чтобы переместиться в другие вселенные – возможно, им, по его словам, «там более надежно и комфортно жить».

Склонность к самоуничтожению
По одной из гипотез, цивилизация, достигающая высокого уровня развития, рано или поздно сталкивается со слишком опасными технологиями (ядерное оружие, научные эксперименты с чем-то вроде чёрных дыр, биотехнологии, искусственные вирусы, и т.п.), которые в итоге приводят к её уничтожению.

Эпидемия
Актуальная в наше время версия гласит, что рано или поздно развитую цивилизацию может выкосить эпидемия, возбудитель которой появится либо естественным, либо искусственным путём. В результате цивилизация либо откатится на примитивный уровень развития, либо полностью исчезнет.

Невидимость
Вероятно, межзвёздные перелёты действительно невозможны, а никаких «кротовых нор» не существует. Но тогда мы должны были бы уже перехватить какие-нибудь радиосигналы — сообщения, которыми обмениваются представители этих цивилизаций, или просто радиоследы их деятельности. Однако высокоразвитые цивилизации могут использовать ещё не открытые нами способы связи, или их деятельность может быть настолько масштабной, что мы воспринимаем её как часть природных явлений. 

Правда, как в начале 1960-х годов заметил немецкий астрофизик, радиоастроном, теоретик космонавтики и SETI Себастьян фон Хорнер, располагая столь несовершенными и не приспособленными специально для поиска искусственных радиосигналов инструментами, невозможно заявлять о том, что «молчание Вселенной» — экспериментально установленный факт. А астроном Карл Саган говорил, что «отсутствие доказательства не является доказательством отсутствия».

При этом, по мнению канадского популяризатора науки Скотта Сазерленда, на 2014 год обнаружен единственный сигнал, который с некоторой вероятностью можно считать искусственным внеземным — это сигнал «Wow!».

«Тёмный лес»
Концепцию предложил китайский писатель-фантаст Лю Цысинь. Конкуренция за ресурсы или конфликты на другой почве могут приводить к тому, что развитые цивилизации стараются как можно тщательнее прятаться от всех остальных – конкурентов и потенциальных противников. Естественно, что и мы их деятельность в таком случае обнаружить не можем.

Виртуальные миры
Английский писатель-фантаст Чарльз Стросс предположил, что естественным путём развития цивилизации является наращивание вычислительных мощностей. В пределе цивилизация формирует в родной системе мощнейший вычислительный кластер, использующий, например, почти всю энергию звезды (по схеме «сферы Дайсона»), и полностью уходит в виртуальный мир, существуя в нём в цифровом виде. Физическая экспансия за пределы подобной системы становится ненужной.

Этический кодекс Галактики
Вероятно, цивилизация или цивилизации в нашей Галактике развились настолько, что пришли к выводу о необходимости ввести запрет на контакт с разумной жизнью и попытки вмешаться в развитие цивилизации до тех пор, пока она сама не освоит межзвёздные перелёты или не достигнет определённого уровня развития, параметры которого нам неизвестны.

Великий фильтр
Робин Д. Хенсон, пытаясь понять, почему мы не видим свидетельств существования инопланетян, поставил под сомнение высокие оценки вероятности существования технологически развитых внеземных цивилизаций. Неизвестные в настоящее время науке факторы могут уменьшать вероятность зарождения и развития форм жизни до состояния, когда следы их деятельности могут быть заметны посторонним наблюдателям.

Хенсон оценил эволюционные этапы, необходимые для появления межзвёздной цивилизации:

 Возникновение звёздной системы с планетами, на которых возможно появление жизни.
 Появление на одной из планет самовоспроизводящихся молекул (например, РНК).
 Появление простой одноклеточной жизни (прокариоты).
 Появление сложной одноклеточной жизни (эукариоты).
 Возникновение полового размножения.
 Появление многоклеточных организмов.
 Возникновение животных с развитым мозгом, которые используют орудия труда.
 Достижениe текущего состояния человечества.
 Распространение цивилизации через процесс колонизации космоса.


Судя по всему, вероятность прохождения одного из этих этапов крайне мала – эту гипотезу Хенсон назвал «великим фильтром».

Летняя спячка
В 2017 году учёные из Оксфордского «Института будущего человечества» – научные сотрудники Андерс Сэндберг и Стюарт Армстронг, а также астроном, астрофизик и философ Милан Чиркович – предложили свой вариант ответа на вопрос Ферми. Их работа «То не мертво, что вечно может спать: гипотеза летней спячки для парадокса Ферми» являлась развитием предыдущей работы от 2013 года, в которой они утверждают, что продвинутая цивилизация без особых проблем сможет не только колонизировать галактику, но и перемещаться между галактиками.

По последним оценкам только в наблюдаемой части Вселенной существует порядка 2 трлн галактик, большинство из которых образовалось порядка 13 млрд лет назад. Наверняка уж в какой-то из них должна была возникнуть цивилизация III типа (по шкале Кардашёва). А не видим мы эти цивилизации, утверждают авторы работы, из-за принципа Ландауэра. Согласно ему, любая вычислительная система в процессе работы обязательно увеличивает энтропию (выделяет тепло) пропорционально количеству обрабатываемой информации. И при использовании каких-либо мегаструктур, потребляющих энергию – сфера Дайсона, мозг-матрёшка, и т.д. – тепловые потери должны быть огромными.

Авторы работы отмечают тот факт, что согласно современным представлениям Вселенная постепенно и необратимо охлаждается. Наиболее реальным сценарием считается тепловая смерть Вселенной, также известная, как «Большое замерзание». Чем меньше температура Вселенной, тем эффективнее будут работать вычислительные мегаструктуры – причём эффективность будет расти экспоненциально. Авторы подсчитали, что задолго до «Большого замерзания», примерно через 1012 лет, вычисления станут эффективнее в 1030 раз. А раз так, то высокоразвитая цивилизация может просто впасть в «летнюю спячку», дожидаясь более холодных времён, оставаясь в таком состоянии невидимой для внешних наблюдателей.

Вторая часть",45
2009-04-09,Квартирный вопрос,https://www.habr.com/ru/post/56832/,"Вчера поссорился с хозяйкой квартиры, я у нее снимаю уже 2/3 года. Ссоры возникали и раньше, но я как-то сдерживал себя и не ввязывался, т.к. не склочный человек. Плачу за аренду я исправно по контракту, во время и в полном объёме.


Ссора исходила от нее, предметом было то, что я не мою квартирный коридор, не размораживаю холодильник во время (какая-то защелка там не клацает), и сушу свои трусы на полотенцесушителе (он может прогнить от этого, по ее мнению). Хотя за все время проживания, я приспособился ко всем этим ее идиотизмам и понял что лучше делать то что она говорит, чем не делать. Вы можете посмеяться от таких причин ссоры, и тем все присходило на повышенных тонах, эпилогом было то, что она сказала, что выгонит меня с нарядом милиции. Юридически она не имеет право это сделать, но когда у человека срывает башню, она говорит что в глубоком подсознании. Т.е. я не очень симпатичен ей как наниматель.

Мы с моей девушкой начали снимать квартиру в августе — за 24000 рублей, когда цены упали мы заключили дополнительное соглашение, что продолжим снимать за 21000 рублей. Все делалось через агенство абсолютно легально, при согласии сторон. Владелица квартиры в это время потеряла работу, я тоже, но я каким-то образом занимался халтурой и, фактически, первый месяц кормила меня моя вторая половинка, я же зарабатывал на аренду квартиры. Через пару месяцев стало попроще, я нашел новую стабильную работу, плюс остались халтуры. И вот тут-то у нее начала протекать крыша. Да..., еще — я не позволял своей девушке общаться с истиричной хозяйкой квартиры, потому что понимал, что это будет просто скандал.

Я — киевлянин, живу в Москве около 5 лет, получил гражданство, работаю в полиграфии на маках. За это время поменял 4 работы и меняю уже 7 место жительства: успел пожить у сестры в Химках, в Алтуфьево, Митино, на Сходненской в 2х местах, на Киевской в центре, и сейчас на Бауманской.

У меня возникали какие-то трения с арендаторами и до этого, хотя человек не склочный. Мне как-то не вернули депозит 17000 руб., меня кинули с подборм жилья. Я знаю, что очень многие сталкивались с подобными вещами. Абсолютно все люди, которые снимают — хотят независимости за те деньги, которые они платят. Не зависимо от того юридически грамотно вы заключили сделку или живете на птичьих правах, то как вы будете жить — в ссорах или без них, — целиком и полностью зависит от хозяина квартиры.

В общем и целом могу охарактеризовать 2 типа владельцев квартир:

1 тип. Человек, как правило, молодой, работающий и не плохо зарабатывающий, имеющий семью и рассматривающий сдачу в аренду квартиры, как второстепенный доход, оптимист. У такого человека всегда все хорошо. Он доволен жизнью и прост в общении.

2 тип. Пессиместично смотрящий на жизнь человек, рассматривающий сдачу в аренду как основной доход, т.к. зарплата существенно меньше, чем арендная плата. Даже если это и не так, то тараканов в голове — море. В чем-то даже ущербный человек, сетующий обычно на свою нелегкую жизь, обремененный всяческими заботами и проблемами.

Я понял, что чего-то между этими 2мя типами просто не бывает, человек прогрессирует и становится либо ущербным, либо успешным. Важно, понять тенденцию по общению, каким типом он все-таки станет оптимистом или пессимистом (большой палец вверх, большой палец вниз).

В моем случае мы расторгаем договор с ней, что мы должны сделать письменно за 30 дней до нашего съезда. Причина — постоянные ссоры с владелицей квартиры. В случае, если бы она расторгла договор с нами — нам бы могли не вернуть страховой депозит. Сейчас она не хочет его возвращать, но я полон решимости судиться с ней, я ее просто размажу. Поговорив с риэлтером, я понял что наниматель всегда прав оказывается в суде. И совершенно не в кризесе дело, когда мозги у людей протекают.

При всем при этом у меня положение более выигрышное чем у нее. Квартир сейчас много. Она квартирантов вместо нас, найдет не скоро.

Дарю идею для стартапа, с кожалению я в другой отрасли работаю, но хотел бы хоть чем-то посодействовать если этим кто-то заинтересуется. Стартап который действительно будет работать, поможет людям и позволит отследить историю квартир. Поверьте люди будут вас благодарить. Кажется, запрещены публикации «черных списков» в интернете. Пусть это будут просто отзывы привязанные к конкретным адресам, к географии города. Важно просто мнение человека, мнго информации не нужно. Владельцы квартир, риэлторы или фирмы набирают звездочки, как коньяк или уходят в безвылазные минуса.

Сайтов по аренде квартир тьма. Но, не все из них честные. Есть какие-то «черные списки риэлторов», но они разрозненны. Люди пишут фолианты, про то чего они натерпелись, конечно, в таких списках все плохие, списка порядочных людей мне не удалось найти. Я бывал в риэлторских фирмах, где у охранников разбита морда в кровь, людьми которых обманули. Видел риэлторов, которые хотят «впарить» голые стены без ключей от этих стен с бабушкой которая, как тень ходит вдоль стен и питается «эвкалиптовыми листиками». Нам повстречался владелец, который к нашему приходу был пьян в какаху, из квартиры он вышел с нами и пошел еще за пивом. Я снимал у женщины которая требовала деньги несвоевременно, за 2 недели до указанной в договоре даты, оплатить жилье, потому что у нее все плохо. Мало ли еще каких ситуаций существует.

Ниже некоторые рекомендации. Многие люди относятся к выбору квартиры поспешив с выводами, или из-за недостатка денег бросаются на все, что видят. Вообще, ни кто не ходит с каким-либо списком того чего он хочет. А ведь это не мало важно, всегда можно сбить цену из-за того-то и того-то, что не соответствует пункту в вашем списке. Риэлторы к вам будут относится как к серой массе, многие владельцы квартир палец о палец не захотят стукнуть что бы создать мало-мальски приемлемые условия жизни. К поискам жилья нужно относится как к поиску хорошей работы, на которой захочется работать до конца дней своих. Итак список, за что будут платиться не малые деньги:

1. Цена. Самый важный фактор.
2. Удаленность от метро. Для меня интересно не более 10-15 мин. пешком, т.к. в противном случае я трачу дополнительно деньги на наземный транспорт.
3. Район города и инфраструктура. Доводилось мне бывать в районах где синь полнейшая, пром-зона и рабочий клас веселится, а вечером тебя подгоняют лающие собаки. Любите себя, зачем вам это неблагонадежие вокруг.
4. Предпочтительные станции метро. Вы же знаете какие ветки перегружены по утрам, вы вправе иметь жилье рядом с работой — это нормально.
5. Стиралка. Не отечественная за 1500 руб., а нормальная стиральная машина. Вы хотите иметь геморой — стирайте на этих наших дешевых машинках. Человек ни чего не делая с месячной аренды квартиры в состоянии купить 3-4 нормальных импортных машинки.
6. Состояние сантехники. В так называемых «бабухкиных квартирах» ни чего ни когда по-настоящему не чинилось. Там вековая рухлять и даже если это как-то и работает, то скоро оно перестанет работать. Под ванной может быть мох, а туалет, действительно вида «сортир».
7. Техника и мебель.
На кухне должны быть обязательно холодильник, плита (не первобытная), кухонный гарнитур, нормальная мойка, стол и стулья (ни чего не должно шататься, везде должно хватать ручек и дверек, все должно быть полноценным и нормальным).
В комнате: шкаф 1 или 2, диван либо кровать, стол.
Как правило почти везде стенка, прикинте на ваш взгляд уместятся ли все ваши веши в этой стенке, на сколько она функциональна. Если диван бабушкин — вам все будет визуально понятно.
8. Телефон, интернет. Нет интернета — когда будет, возможности проведения? арендную плату уменьшаем.
9. Лоджия или балкон. Желательно застекленные, т.к. я люблю курить и зимой.
10. Вопросы:
 — можно ли курить?
 — можно ли завести животных?
 — у кого еще есть ключи от квартиры?
и т.д.
11. Квартира находится не ниже 3 этажа. Квартиры на 1м, 2м этажах в 5-этажках промерзают насквозь зимой, там очень сыро.
12. Если на стене висит ковер или на кухне у вас ощущение того, что все в жире — уходим сразу же.

Всем хорошего дня!",30
2022-06-19,Мозг мужской и женский. Причины различий и следствия,https://www.habr.com/ru/post/672226/,"ВступлениеТо, что мы разные, знают все. Отличаемся внешне, поведением, физиологией, возможностями. Но чем вызваны эти различия и почему они возникли?Все наши формы поведения обуславливаются структурными (морфологическими) особенностями нашего мозга и социальными инстинктами. Последние формируются в процессе воспитания и созревания нашего мозга. Они такие же прочные, что и геномные программы, позволяющие нам на инстинктивном уровне адаптироваться к условиям жизни. Социальные инстинкты делают нас людьми.Рассмотрим особенности женского и мужского мозга с точки зрения биологии.Масса мозгаЭти исследования проводились в 19 веке на тысячах образцах, в результате которых оказалось, что мозг женщин меньше. Аналогичные эксперименты проводились и с мозгом приматов (шимпанзе, орангутангов и горилл) и показали такие же результаты – мозг у самок тоже меньше. В обоих случаях мозг меньше, даже если не учитывать массу тела. Статистика о мозге женщин по всему миру снял вопрос о связи массы мозга и тела окончательно. Мозг у женщин меньше независимо от веса тела. Какова эта разница?Минимальные различия в массе мозга между женщинами и мужчинами у некоторых северных европейских народов составляет 30 г. В странах южно-азиатского, африканского региона, латиноамериканских стран разница достигает 250 г. Как оценить подобную разницу в массе? Достаточно вспомнить, что мозг шимпанзе 250 г.Такая разница в массе достаточно серьезная и она не может не сказаться на поведении.Небольшое пояснениеГоворя про разницу в массе мозга, надо учитывать, что сама по себе ее бОльшая величина не ведет к однозначно большей интеллектуальности или способностях, если речь не идет о минимально критичной массе, которая для женщин оценивается в 800 г, а у мужчин 900 г.Как известно, в истории были гении с мозгом порядка 1 кг, как у А. Франса, так и выше 2 кг, как у И. Тургенева.Но и клинический идиот имел мозг 2.6 кг. Тем не менее, корреляция существует, 75% гениев и выдающихся талантов имели мозг массой выше среднего (1350 г). Но порассуждаем не о гениальности, а о том, к чему приводят структурные и весовые различия мозга. Надо понимать, что меньший в популяции вес мозга у женщин вовсе не означает, что невозможно найти мужчину, у которого мозг меньше женского. Речь идет о средних статистических данных.Особенности эволюцииВ процессе нашей эволюции, а она исчисляется миллионами лет, условно от ранних австралопитеков, основные задачи были связаны с добычей пищи, размножением и социальной иерархией. На разных этапах, например в «райском периоде», когда условия обитания были близки к идеальным, инструменты эволюционного отбора отличались, но основные мотивации и биологические задачи оставались прежними.Поэтому, наш мозг формировался для выживания, адаптации и размножения определенным образом, что и отразилось на нашем современном поведении и устремлениях.Перед тем, как выяснить за счет каких областей женский мозг оказался меньшим и отличным от мужского, выясним основные особенности его формирования в процессе эволюции.Лобные области – это тормозные центры, подавляющие агрессивное поведениеВ животном мире никто так долго не выращивает детенышей, как мы и наши предки.В течение многолетнего периода выкармливания и заботы о потомстве необходимо было делиться с ним пищей. За эту естественную для нас способность, как оказалось, отвечают лобные области, в которых находится тормозной центр, подавляющий агрессию.Без него мы бы остались агрессивными животными, не умеющими жить в больших сообществах. В целом лобные области состоят из множества полей и подполей с различным назначением. Большая часть полей моторные, это тонкая двигательно-моторная координация. Но нам интересны другие, подавляющих наше агрессивное поведение, их называют ассоциативными областями или зонами.Именно они заставляют нас делиться пищей, а не съедать друг друга. Поэтому огромные лобные доли дали человечеству преимущество - мы смогли жить большими популяциями, мирно сосуществовать и выполнять общую совместную деятельность. Особенность этих ассоциативных областей в том, что они молчат даже при стимуляции.Надо сказать, что функции лобных долей обнаружились достаточно давно и связали их с проблемами анорексии у женщин, то есть отказом от пищи. Эффективно лечили подобные проблемы нейрохирургическим способом. Делали надрезы в височной области, вводили скальпель и подрезали связи в лобных долях. В результате через несколько дней у девушек появляется аппетит, а через пару месяцев восстанавливаются половые циклы.Подобные «неполиткорректные» операции продолжают делать лишь в Мексике.Показателен факт, что после этих хирургических вмешательств поведение у женщины не менялось, когнитивные способности оставались без изменений. Таким образом, был сделан вывод, что эти области, названные тормозными, нужны, чтобы делиться пищей. То есть эволюционно они появились, чтобы подавлять инстинктивную агрессию и желание отнять пищу. Для женщин это было необходимо для долгого выращивания и воспитания потомства.Т.о., наличие больших лобных областей у женщин прежде всего говорит о том, что она будет долго и успешно выращивать потомков, а не решать сложные научные задачи.Эволюция нашего мозга шла и продолжает идти путем отбора по самым востребованным качествам. Применительно к отбору женского мозга – он шел по лобным областям. Вызвано это было из необходимости долго выкармливать потомство, делясь с ним пищей.Как появились тормозные области у мужчинСтратегия и формы поведения мужчин всегда отличались от женских.Долго и постоянно возиться с потомством им неинтересно. Но счастливыми обладателями этих структур мужчины, однако, стали. Произошло это в результате геномного обмена. Тормозные области, как артефакт появились и у них. Но если женщины использовали эти области по прямому назначению, мужчины их использовали в более прикладном виде, для лучшей адаптации и решения разнообразных задач, в том числе и связанных с изобретательством и творчеством. Все современные прикладные дисциплины и способность к творчеству, которыми в основном занимаются мужчины, были вызваны именно с наличием этих центров и использованием их не по прямому назначению. Эту, теперь уже очевидную мысль, впервые высказал д.б.н. С.В. Савельев.Таким образом, причиной рассудочной деятельности у мужчин стали женщины.Откуда разница в весе мозга и в чем морфологические отличияТеперь, когда в целом стало понятна разница в формировании и использовании мозга женщин и мужчин можно рассмотреть за счет каких областей женский мозг меньше. Чем они могут безбоязненно пожертвовать, не став менее эффективными в реализации своих основных биологических задач, связанных с репродукцией?  Трудолюбие, терпение, аккуратность, хорошая моторика, слух, зрение – в этих качествах женщины, как правило превосходят мужчин или не уступают.Из школьного курса биологии можно вспомнить, что головной мозг состоит из двух нервных систем – древней и небольшой по размеру лимбической системы, которая досталась нам от обезьян и церебральной – рассудочной нервной системой, представленной корой – неокортексом – привет от рептилий.Мужчины, как известно, более рассудительные и творческие натуры. Ученые, поэты, художники и музыканты в основном мужчины. Почему? Этому есть вполне объективные причины, которые выше мы кратко рассмотрели. Использование нами одних и тех же структур в лобных областях разное. Но есть и другие основания.  Отличительная особенность женского мозга – в превалировании лимбических структур над рассудочной корой (неокортексом). Этим, в частности, вызвана загадочность и нелогичность женского поведения, при котором решения они принимают на инстинктивно-гормональном уровне, полагаясь на интуицию, то есть на лимбическую нервную систему. Но, учитывая их конечную биологическую цель, смысл их поступков оказывается вполне логичным.Поговорим подробнее об ассоциативных зонах. Для нашей темы они важны.Эти области можно назвать чисто человеческими. У приматов они либо очень плохо выражены или не выражены вовсе.Располагаются они в лобных долях и на границе заднего края теменной, височной и кусочка затылочной области. То есть у нас есть две ассоциативных области.Те, что в лобных долях отвечают за особенности поведения, индивидуальность характера – там есть поля, за это отвечающие. Если их повредить – изменится характер. Эти ассоциативные зоны в лобных долях небольшие и подключаются в случаях, когда человек попадает в критическую ситуацию. Занимают 10% от всей лобной доли. Помимо тормозных функций, за творческую деятельность, решение сложных не биологических задач именно они и отвечают.Оказывается, мужской мозг выигрывает в весе за счет больших размеров этих ассоциативных областей в лобных долях и нижнетеменнойобласти. К сожалению, включаются они достаточно редко и далеко не у всехмужчин, несмотря на наличие.Кроме этого, - небольшой участок нейронов в переднем ядре гипоталамуса у мужчин тоже в 2 раза больше. Некоторые другие центры, амигдалярный (отвечает за агрессию) и связанные с гиппокампом области, также имеют отличные от размеров у женщин. Это структуры лимбической системы, отвечающие за половое поведение.Например, гистологические исследования (то есть исследования на клеточномуровне) показали, отличительные особенности сосцевидных тел у женщин — комплексструктур заднего отдела гипоталамуса, входящих в состав лимбической системы. Поэтой разнице можно определить к какому полу относится мозг, не зная егопринадлежности. Эти структуры определяют половой интерес, который отличается уразных полов.Эти различия четко совпадают с изменением женской физиологии на протяжениижизни.Таким образом, даже часть перечисленных отличий в мозге мужчины и женщины обусловливает разницу в стратегии поведения, способностях и возможностях.ОсобенностиНаши основные генетические различия известны. По некоторым данным их более сотни и счет их растет.И одна из основных женских целей, заложенных на генетическом уровне – это репродуктивная цель. То есть воспроизведения себе подобных.Это непростое дело привело к тому, что женский мозг надежней. Биологически это целесообразней. Мозг мужчин более изменчив, это означает, что разница по мозгу внутри мужского пола более значительна. Это разница по массе лежит в диапазоне от 900 г до 2600 г. Кроме этого, что более важно, очень вариабельны по размерам функциональные области, которые определяют способности и потенциал деятельности в той или иной области. Отличие в этих структурах может быть не только количественным до 40 раз по подполям, но и качественным, когда у человека находят лишнее подполе или, наоборот его отсутствие. Подобная изменчивость во многом присуща именно лобным областям. Огромную изменчивость мозга у разных полов наглядно показывают кривые распределения Гаусса. Пологий график изменчивости мозга у мужчин, против крутого вида распределения у женщин.  Как видно из рисунка, у мужчин более широкий диапазон различных вариантов, как по массе мозга, так и по морфологическим особенностям.Условный график изменчивости мозга разных половУ женщин более узкая биологическая задача. Перенос генома в следующее поколение и последующая забота о потомстве, сформировал организм в более надежную систему. Дублирующий набор Х- хромосом избавляет их от многих болезней, которые передаются только мужчинам. С другой стороны, женщины менее защищены от депрессии.Сильные и слабые стороны женского и мужского мозгаФакт того, что при оплодотворении, мужчин появляется в 1.5-2 раза больше, чем женщин, но их большая относительная гибель при внутриутробном развитии или после рождения приводит к такому же количеству, что и женщин, говорит о менее надежном морфогенезе, связанном с хромосомными различиями.В качестве платы за огромную изменчивость организма мужчины оказались менее устойчивы к токсическим воздействиям.Но эта же изменчивость дает мужчинам с большими вариациями строения мозга возможность лучше приспособиться к изменяющимся условиям. То есть адаптационные возможности у мужчин выше.  Иными словами – женский мозг менее изменчив и более консервативен, но более надежен.У мужчин больший полиморфизм мозга и в первую очередь, связанный с ассоциативными центрами. Благодаря этому, мужчины принимают больше разных решений, в том числе и неверных... Сам по себе факт того, что структуры в лобных долях, отвечающие за творческую деятельность мужчины и женщины используют по-разному, не делает автоматически всех мужчин умными или творческими. Лишь малая часть их занимается творческой или интеллектуальной деятельностью, связанной с решением небиологических задач. То есть не связанными с добычей еды, денег, карьерным ростом и размножением.Можно найти среди женщин вполне творческие личности. (Примечательно, что наибольшая эффективность их творческой активности связана с высоким гормональным фоном.)Другое дело, что найти их среди женщин труднее. И все формы поведения, какие бы разнообразными они не были, связаны с репродукцией, социальной значимостью и добычей еды.Первым связал анатомические особенности мозга со способностями у человека Франц Галль. Основатель френологии и нейрофизиологии.В качестве примера связи между поведенческими реакциями и строением мозга можно привести следующий: зрительное восприятие мужчин запускает выброс половых гормонов. Потому что, эти центры рядом.У женщин иначе, подобные структуры лежат на пути слуховой системы и напрямую связано с половой системой. Поэтому, мужчины любят глазами, а женщины ушами.Есть отличия в восприятии цвета, пространственной ориентации, обонятельных и вкусовых центрах. Мы по-разному реагируем на стресс.Женский организм иначе реагирует на стресс, чем мужской. Американские исследователи объясняют это тем, что организмом в кровь выбрасывается больше гормонов стресса и когда причина стресса уже устранена с трудом прекращает их производство. Нормальную способность гормональной системы быстро отключать выделение гормонов стресса тормозит женский половой гормон прогестерон. Механизм и критерии выбора у нас тоже разные, но это уже тема другого разговора.ВыводыМозг мужчин и женщин отличается по массе и морфологическим (структурным) особенностям строения и использования.По эволюционным причинам одни и те же области мы можем использовать по-разному.Женщины более биологичны, в работе их мозга превалируют инстинктивно-гормональные – лимбические структуры. Основные центры у женщин заточены на репродуктивную стратегию. Постоянные скачки гормонального фона требуют колоссальных затрат, что б держать себя в социальных рамках.Женский мозг более надежен. Мужской мозг обладает большей изменчивостью, то есть более разнообразен. Женский мозг созревает раньше и стареет медленнее.Нет мозга лучше или хуже. Речь о разном результате в процессе эволюционного отбора, когда получается мозг с качествами оптимальными для решения своих задач в пределах пола.Формы поведения зависят не только от социальных инстинктов (воспитания, самовоспитания, образования), но и в большой мере от морфологии мозга.",7
2021-07-01,Интимный микробиом и как с ним сосуществовать,https://www.habr.com/ru/company/geltek/blog/565622/,"Однажды ко мне пришли дамы из лаборатории и сказали, что мы будем делать гель для интимной гигиены. Женской. Дальше мы поговорили с большим количеством девочек, девушек и женщин — и я с удивлением узнала, что мракобесие есть не только в области прививок и состава медсредств, но и во вполне бытовых вещах вроде интимной гигиены. Поэтому сегодня мы будем говорить о науке, стоящей за этим. Точнее, скорее, это научпоп, потому что науки будет не сильно много, а вот бытовых следствий — достаточно. МРТ органов таза девушки в сагиттальном срезеОсобенность анатомии девушек подразумевает постоянное сообщение полости влагалища с внешним миром, что в свою очередь сделало их зависимыми от состояния микрофлоры. У мужчин не так. Поэтому сегодня будем говорить про микрофлору влагалища и наружных половых органов, почему её так легко сломать и заработать, например, цистит. Которого, кстати, у мужчин почти не бывает. И про то, как сейчас пытаются продвигать средства гигиены с кучей странных эффектов, включая отбеливание ануса. В общем, пора поговорить про пестики и тычинки. Девушкой быть довольно непростоДевушка в сагиттальном разрезе  Эволюция — штука глупая, работающая на чистом переборе вариантов. Более того, никто никогда не обещал, что текущее состояние вещей — это идеальный оптимум. Чтобы понять, как это работает, давайте для начала посмотрим на особенности мужчин. У мужчин половая функция совмещена с мочевыделением. Уретра мужчин в целом нестерильна, и единичная кокковая флора считается нормальной, если не вызывает каких-то проблем. Микрофлора скудная, закрепиться в норме ей особо негде, если не брать в расчёт хронический простатит.  В отличие от мужчин с достаточно длинной уретрой, уретра женщин более короткая и широкая. Выход расположен в непосредственной близости от влагалища с его обильной микрофлорой. Плюс тут же в непосредственной близости расположено анальное отверстие с соответствующей микробиотой толстого кишечника, которая ведёт себя как патогенная, если закрепляется где-то ещё. Всё это приводит к тому, что любой перекос микробиома или проблемы с гигиеной немедленно приводят к воспалительным процессам со стороны мочевого пузыря и влагалища.У мужчин, например, почти не бывает циститов. Просто за счёт длинной уретры все микроорганизмы «смывает», и они не могут закрепиться в слизистой мочевого пузыря. У женщин, это, напротив, одна из часто распространённых проблем. Ряд исследований показывает, что причина тут может быть в хроническом микоплазмозе, который крайне сложно лечится. Обычно это Ureaplasma urealyticum и Mycoplasma genitalium. Передаётся преимущественно половым путём, но может быть и врождённой инфекцией, переданной от матери. В итоге получается порочный круг: вылечили цистит — бактериальная флора из влагалища «переползла» в уретру — новый цикл воспаления. Аналогично агрессивный штамм кишечной палочки из толстого кишечника, попавший во влагалище, может начать вытеснять естественную флору и провоцировать воспалительные процессы. Мужчины по большей части подобных проблем лишены в силу анатомии. Хроническим пиелонефритом женщины тоже болеют чаще в два–пять раз, чем мужчины.Кроме этого, сама кожа наружных половых органов тоже уникальна. Кожа тут не просто нежная. Участки кожи в районе преддверия влагалища довольно тонкие и не кератинизированы. В итоге они очень легко травмируются и склонны к воспалительным процессам. За счёт отсутствия кератина кожа в этих участках значительно более проницаема, если сравнивать, например, с предплечьем. В результате если постирать нижнее бельё неудачным стиральным порошком или тем более плохо его смыть, можно заработать очень серьёзный контактный дерматит. Повышенная проницаемость также обусловливает больший риск проникновения инфекции. Бактериям проще внедриться в такой малозащищённый участок. В общем, девушкой быть довольно сложно. Микроорганизмы со всех сторон, живут в разных локациях и друг с другом не дружат.МикробиомСобственно, становится понятно, что быть девушкой, значит пытаться постоянно подружиться со своей микрофлорой. Есть, конечно, счастливые, у которых свой микробиом влагалища и наружных половых органов устойчивый и быстро убивает всех, кто пытается подселиться со стороны. Большинство же время от времени страдает от её перекосов. Причин может быть много — это и антибиотикотерапия, и новый половой партнёр, который принёс своей флоры. Ну или просто луна не в той фазе.Микрофлора наружных половых органов нестабильна. Единого стандартного варианта для всех нет. У здоровой женщины могут встречаться стафилококки, микрококки, дифтероиды, лактобактерии, стрептококки, дрожжи и часть видов фекального происхождения. Если с этим микробиомом есть какие-то проблемы, то он может стать причиной вагинальной и уретральной инфекции — всё расположено близко, а бактерии могут быстро колонизировать соседние области.Lactobacillus около клеток вагинального эпителияВагинальная флора, напротив, более стандартная. Раньше считалось, что основу здоровой вагинальной флоры составляют бактерии из рода Lactobacillus, в частности, те же палочки Дедерлейна. И да, часть из них — это те же самые бактерии, которые производят сыр, йогурты и прочие кисломолочные продукты. Последние исследования говорят о том, что встречаются и варианты здоровых женщин, у которых нет лактобактерий, а их роль выполняют другие микроорганизмы, выделяющие молочную кислоту —Atopobium vaginae, Megasphaera spp. и Leptotrichia spp. Например, Lactobacillus преобладает у 80,2 % и 89,7 % европеоидов и азиатов соответственно. У латиноамериканцев и негроидов они встречались сильно реже — 59,6 % и 61,9 %.Микрофлора сильно зависит от того, как вас родили — кесаревым сечением или обычными родами. Мать передаёт ребёнку свою флору, засевая кишечник детям обоих полов и будущую вагинальную флору девочек. В течение жизни флора так же меняется в зависимости от диеты. Часть лактобактерий из молочнокислых продуктов колонизирует кишечник, затем наружные половые органы и, наконец, влагалище.Защита от инфекцииВсе ключевые бактерии вагинального биома объединяет основная общая черта — синтез молочной кислоты до очень жёстких pH 3–4. Благодаря способности выживать в такой агрессивно кислой среде молочнокислая флора очень быстро отравляет среду вокруг себя и захватывает основную часть жизненного пространства. Часто те же самые штаммы не дают условному золотистому стафилококку заразить йогурт. Или испортиться квашеной капусте, которая спокойно может храниться при комнатной температуре. Хотя в последнем случае работает Lactobacillus plantarum, который во влагалище встречается редко.Именно такой агрессивный характер вагинальной микрофлоры позволяет успешно противостоять явно патогенным бактериям, для которых влагалище было бы идеальным инкубатором. Температура идеальная — в районе 37 градусов, много еды в составе слизистого секрета. И именно очень низкий pH позволяет держать их в полумёртвом состоянии, не давая активно размножаться.Причём такой низкий уровень pH не только подавляет рост бактерий, но и препятствует заражению вирусной инфекцией. Папилломавирус человека, например, легче проникает в условиях щелочного pH на 30 %.Как идеальная стерильность может вызвать хроническое воспалениеCandida albicans — классический пример неправильного леченияДрожжеподобный гриб из рода Candida есть в норме у 80 % людей и не вызывает проблем. Естественный биом не даёт возможности этим грибам размножаться. Ровно до тех пор, пока мы не начинаем этот самый бактериальный микробиом убивать. Типичная причина резкого роста этих грибов — длительное применение антибиотиков широкого спектра действия без прикрытия противогрибковыми препаратами. Как только бактерии покидают свою экологическую нишу, её тут же занимает Candida и провоцирует заболевание — кандидоз. В полости рта он тоже часто проявляется после антибиотиков в виде белого творожистого налёта на языке и слизистой щёк.Ещё одной причиной проблем со здоровьем являются попытки некоторых девушек добиться идеальной гигиены на грани стерильности. Это мало того, что невозможно, так ещё и приводит к тому, что «добрые» симбионты замещаются на явно патогенную флору. Я знала одну девушку, которая регулярно заливала себя изнутри мирамистином просто с профилактическими целями. Да, у неё был один постоянный половой партнёр, но ей казалось, что нужно обязательно убить всех бактерий, чтобы всё было идеально чисто и красиво. Это вполне предсказуемо вылилось в хронические воспалительные проблемы и долгие попытки восстановить микрофлору.Вообще идея с антибактериальным эффектом средств гигиены подразумевает, что вы чем-то болеете. То есть вас уже поедает патогенная флора, и вы вынуждены её массово уничтожить, чтобы потом заселить нормальной. Например, в той же стоматологии есть лечебные зубные пасты. Они содержат такие антибактериальные компоненты, как хлоргексидин, для лечения обострения пародонтита. Для постоянного применения они не подходят, так как пациент очень быстро обрастёт грибами и будет страдать от кандидоза.Для средств гигиены, на мой взгляд, антибактериальный эффект — это скорее минус. В повседневной жизни более чем достаточно просто смыть бактериальную плёнку и загрязнители мягким ПАВ со слабокислым pH. Да, есть специальные средства для лечения стрептодермии и грибковых поражений кожи, но они применяются отдельно от моющих средств. Агрессивное мыло с щелочным pH и триклозаном в составе действительно отмоет вашу кожу до скрипа, но одновременно высушит её, уничтожит защитный липидный слой и заменит нормальную микрофлору на агрессивные грибки и какого-нибудь золотистого стафилококка.Правильная гигиенаТут хочу сразу вставить маленькую памятку папам с мелкими девочками. Мужчины часто немного теряются с ребёнком, которого надо вымыть, если ребёнок — девочка. На самом деле ничего сложного нет. Ключевые принципы сформулировала ещё Матушка Ветровоск из романов сэра Терри Пратчетта: «С одного конца вливаешь молоко, а с другого поддерживаешь чистоту». Главное помнить, что в отличие от мальчиков мыть нужно в направлении от живота к спине, иначе есть риск занести микрофлору кишечника в вагинальную область, где она совсем неуместна.В целом интимная гигиена девушек базируется на нескольких простых принципах. Вот ключевые мысли из гайда от Royal College of Obstetricians and Gynaecologists.Не пытайтесь сделать стерильным то, что им быть не должно. Не надо пытаться прополоскать себя насквозь всем подряд.Если пытаться мыться слишком часто, можно заработать раздражение и контактный дерматит.Не используйте губки или другие вещи с абразивным эффектом. Рук будет вполне достаточно, а риск повредить нежную кожу без кератинового слоя будет ниже.Не стирайте нижнее бельё с кондиционерами и агрессивными ПАВ.Не используйте обычное мыло, гель для душа, пену для ванн и другие подобные вещи для гигиены наружных половых органов.Не используйте антисептики в области наружных половых органов.Старайтесь носить свободное шёлковое или хлопковое бельё или просто длинные юбки без нижнего белья.Спите без нижнего белья.По сути, ключевые требования — не раздражай кожу и не нарушай микрофлору. Всё просто.Тем не менее на рынке сейчас огромное количество средств, которые вываливают на этикетку километровый состав с множеством растительных экстрактов и компонентов невнятного предназначения. В погоне за маркетингом многие продвигают совершенно неадекватную гигиену с кучей пенок, присыпок, кремов и кучей всего, что с большой вероятностью может дать в итоге стойкий аллергический дерматит. А сейчас ещё стали часто декларировать эффект снижения пигментации гениталий.Отбеливание гениталий и прочая эстетикаКогда роешься в картинках из атласов, очень забавно находить довольно старые иллюстрации, посвящённые, например, развитию вторичных половых признаков. Важная штука, чтобы определить гормональный фон.Для этого используется шкала ТаннераОтличная шкала, которая верой и правдой служила гинекологам и эндокринологам. К сожалению, или к счастью, появилась лазерная эпиляция и фотоэпиляция, из-за которых лобковым вшам грозит вымирание, а эндокринологам сложно записать что-то осмысленное в этот раздел истории болезни.Люди всегда изобретали новые стандарты красоты и всячески старались им соответствовать. С фигурными стрижками, тотальной эпиляцией, всеми возможными вариантами пирсингов мы уже как-то свыклись. Теперь постепенно набирает актуальность концепция отбеливания гениталий. Нет, на функциональность это никак не влияет и нужно только для улучшения эстетического самоощущения некоторых девушек. Я, если честно, даже почувствовала себя немного отставшей от трендов, так как отбеливанием гиперпигментации на лице мы довольно долго занимались, но вот генитальный вариант как-то в голову не приходил. Даже нашла интереснейшее издание Costa, A. D. (Ed.). (2020). Minimally Invasive Aesthetic Procedures. DOI: 10.1007/978-3-319-78265-2, где в отдельном разделе описывался один из вариантов подобной терапии. Как и ожидалось, из-за большого числа меланин-продуцирующих клеток, отбеливание этой области относится к весьма сложным и болезненным процедурам. Несколько впечатлила фраза We only noticed the patient experienced a lot of pain during laser treatment, but we did not use any kind of anesthetic. Есть же отличные препараты для трансдермального введения того же лидокаина, но тут уже авторам методики виднее. Если интересно — можете сами поискать издание. Оно есть в открытом доступе.В целом, если человеку хочется, это не вредит здоровью, то я не вижу причин отказываться от подобного. Хотя это, конечно, вопрос вкуса. Если что, у нас есть средство для отбеливания кожи лица в виде сыворотки Brightening skin с койевой кислотой в составе. Честно признаюсь, на кожу анальной области не мазали, но могу предположить, что те же принципы сработают и тут. Поэтому, если очень хочется, — можете попробовать. Раздражение вы вряд ли получите, но мощного эффекта скорее всего тоже не будет. Всё-таки типовой вариант для перианальной зоны предполагает интенсивное воздействие лазером, помимо местных препаратов.Короче, мы пока не планируем расширять наши линейки специализированными средствами для уменьшения пигментации интимной зоны. У нас как раз минималистичный продукт без лишних компонентов. Мы не используем то, что не работает, в маркетинговых целях. Это лишние проблемы в синтезе и сложности в стабильности продукта. Что мы запустилиМы стараемся придерживаться разумного минимализма. Запихивать в один флакон десятки экстрактов — плохая идея. С высокой вероятностью нарвёмся на аллергический дерматит, и будет сложно стабилизировать формулу. Антисептики мы тоже не используем. Многие компании предлагают средства с подобным эффектом, но научные исследования свидетельствуют, что, разрушая микробиом кожи наружных половых органов, мы автоматически нарушим микробиом влагалища и мочеиспускательного канала. В итоге средство с непродуманным составом может со временем обернуться хроническим пиелонефритом и другими проблемами.Мы выпустили продукт с простым названием «Гель для интимной гигиены». Ничего лишнего. Состав тоже весьма функциональный и минималистичный.Коко-глюкозид и Амисофт (TEA-Cocoyl Glutamate) — мягкие ПАВ, которые не пытаются вместе с загрязнением смыть весь защитный липидный слой кожи. Они не вызывают раздражения и отлично себя показывают во всех тестах.Молочная кислота до уровня pH 4,5. Вода из крана у нас, как правило, очень щелочная, а нарушать кислотную защиту от патогенных бактерий не стоит. Поэтому моющее средство сразу корректирует кислотность до нормальной.Экстракт ромашки — успокаивающий, антисептический и противовоспалительный эффект.Экстракт зелёного чая — содержит компоненты с антиоксидантным эффектом, который уместен для снижения окислительного стресса при воспалительных реакциях, также обладает иммуностимулирующим эффектом, усиливая местный иммунный ответ. Это помогает противостоять патогенной микрофлоре. В целом, зеленый чай довольно активно используется в дерматологии.Экстракт солодки — антигистаминный и противовоспалительный эффект.Экстракт алоэ — выраженный увлажняющий и противовоспалительный эффект.В итоге мы мягко смываем загрязнения, не трогаем местный микробиом и снимаем воспаление, если оно есть. Кроме этого, снижается раздражающий эффект от ПАВ и высокого pH жёсткой воды. В целом, хочется рекомендовать придерживаться принципов минимализма в любой косметике и средствах ухода. Чаще всего, если по очереди вылить на себя содержимое десятка баночек, вы сделаете только хуже.Если интересно, как мы создаём новые средства, заходите к нам в telegram-канал (@geltek_cosmetics). Там мы рассказываем интересные штуки про хроники нашей уютной лаборатории.",92
2021-02-19,Une vie d’amour: моногамия и мозги лемура,https://www.habr.com/ru/company/ua-hosting/blog/543070/,"

Что отличает человека от подавляющего большинства представителей земной фауны? Очевидный ответ — интеллект, и это действительно так. Но что дает нам наш развитый мозг помимо умения создавать невероятные машины, сочинять симфонии и писать картины? Он дает нам выбор. Мы вольны выбирать себе свой собственный жизненный путь, который может разительно отличаться от оного у другого представителя нашего вида. Одни едят мясо, другие предпочитают вегетарианство; одни хотят жить в тропиках, а кого-то тянет в Гренландию; кто-то намеревается стать вторым Казановой, а кому-то нужен единственный партнер на всю жизнь. Касательно последней аналогии возникает вопрос — почему одни виды моногамны, а другие полигамны? Ученые из университета Дьюка (США) провели исследование рыжебрюхих лемуров, и выяснили, что секрет долгосрочных отношений таится в мозгах. Почему именно лемуры, что ученые нашли в их мозгах, и как эти находки объясняют склонность некоторых видов к моногамии? Ответы на эти вопросы мы найдем в докладе ученых. Поехали.

Основа исследования
Моногамия подразумевает длительные отношения с единственным партнером в течение всей жизни, нескольких лет или одного брачного сезона. В мире животных это проявляется по-разному. Альбатросы большую часть года проводят поодиночке, но в период гнездования они создают пары, которые воссоединяются каждый сезон для совместного ухода за гнездом, кладкой и потомством. 


Галапагосские альбатросы по праву считаются одними из самых верных птиц.

А вот лебеди-шипуны, создав пожизненную пару, все время проводят вместе, при этом также совместно ухаживают за потомством. Упоминание птиц в аспекте моногамии не случайно, ибо именно среди пернатых этот «образ жизни» весьма распространен, чего не скажешь про других представителей фауны. Среди млекопитающих моногамия встречается гораздо реже, особенно ее пожизненный вариант. 

И тут стоит немного рассказать о главном герое исследования — о рыжебрюхом лемуре. Эти эндемики Мадагаскара являются представителями низших приматов из семейства лемуровых. Свое название вид получил за необычный окрас самцов, чье брюшко окрашено в коричневато-красный оттенок. 


Самец рыжебрюхого лемура (слева) и самка с детенышем (справа).

Длина тела взрослой особи может достигать около 1 метра, при чем хвост длиннее тела на 20% (т.е. примерно 40 см длина тела и 60 см длина хвоста). Такое строение тела позволяет им отлично лазить по деревьям, коих в их ареале обитания, естественно, предостаточно.

В плане отношений рыжебрюхие лемуры (а также мангустовые лемуры) крайне отличаются от других представителей своего семейства, так как они живут парами многие годы. Именно эта особенность и породила в научном сообществе вопрос, почему в одном и том же семействе одни виды моногамны, а другие полигамны?

Как правило, ответы на этот вопрос ученые ищут в нейрологии и биохимии. К примеру, окситоцин и вазопрессин, два близкородственных нейропептида, считаются одними из основных источников подобного поведения, так как обладают социорегуляторными функциями, охватывающими диапазон поведения в широком спектре таксонов (семейств, видов и т.д.). 

Помимо поведенческих и когнитивных, эти нонапептиды регулируют массу других процессов: создание пар, спаривание, родительскую заботу, преодоление стресса, агрессию, социальное вознаграждение и социальное признание.

Окситоцин и вазопрессин стали основными кандидатами на роль решающего фактора в формировании поведенческих особенностей за счет результатов множества исследований нейронных цепей у грызунов. В данном же труде ученые решили провести первый в своем роде анализ нейроанатомического распределения рецепторов окситоцина и вазопрессина у низших приматов, к которым относятся лемуровые.

На данный момент был полностью описан лишь один тип рецептора окситоцина, а именно OXTR — рецептор, связанный с G-белком. Но вот у вазопрессина имеется три известных рецептора: AVPR1a, AVPR1b и AVPR2. Из них рецептор AVPR1a присутствует центрально и, в теории, модулирует большинство социальных эффектов вазопрессина. 

Ранее исследования OXTR и AVPR1a проводились на полевках, поскольку в общем роду этих грызунов присутствовали как моногамные, так и полигамные виды, что позволяет изучать нейробиологические различия между филогенетически близкими, но социально отличными видами.

Стоит отметить, что нейронные распределения вазопрессина и иммунореактивных волокон окситоцина у позвоночных в целом схожи, но при детальном рассмотрении можно обнаружить существенные различия даже между близкородственными видами. Так в опытах с полевками было выявлено отличие в распределении OXTR и AVPR1a между моногамными степными полевками (Microtus ochrogaster) и полигамными горными и луговыми полевками (Microtus montanus и Microtus pennsylvanicus). Именно эта находка и подтолкнула ученых к мысли, что OXTR и AVPR1a играют решающую роль в образовании пар. 


Пара полевок вида Microtus ochrogaster.

Проблема вышеописанных исследований заключается в том, что их результаты сложно экстраполировать на других позвоночных. Существует множество поведенческих и нейрологических особенностей, которые в разной степени отличаются между представителями разных родов, видов или семейств. Если привести всех к общему знаменателю, то в результате можно слишком упростить и, как следствие, неверно интерпретировать фундаментальные основы того или иного явления (в данном случае, моногамии). Посему исследования на низших приматах так важны, ибо они расширяют данные, полученные от грызунов.

Как мы уже знаем, в данном труде все внимание уделялось роду Eulemur Strepsirrhine. Причин тому две, как говорят ученые. 

Во-первых, в аспекте их морфологии и сенсорной адаптации, лемуров можно считать «переходной» эволюционной ступенью между грызунами и более часто изучаемыми антропоидными (человекообразными) приматами. От грызунов лемурам достались усиленное обоняние, зрение и химической связи, т.е. функциональный вомероназальный орган. А от приматов — обращенные вперед глаза и визуальная обработка информации. Любопытно и то, что лемуры довольно далеки от человека в плане родства, но находятся примерно на половину ближе, чем те же грызуны.

Во-вторых, Eulemur является единственным приматом, который аналогично Microtus (полевка) имеет как моногамные, так и полигамные виды внутри одного семейства. В роду Eulemur насчитывается 12 видов, но лишь два из них проявляют моногамию — E. rubriventer и E. mongoz.


Изображение №1: виды лемуров из рода Eulemur (черный — не входят в данное исследование; зеленый — моногамные; оранжевый — полигамные).

Для данного исследования были использованы образцы мозга 12 особей (6 самок и 6 самцов), представляющих две различные системы спаривания среди семи близкородственных видов (изображение №1). Представители рода Eulemur весьма немногочисленны, статус их популяции варьируется от уязвимой до находящейся под угрозой исчезновения. По этой причине все образцы были получены из банка тканей Duke Lemur Center, который является одним из немногих мест за пределами Мадагаскара, где содержатся и/или разводятся несколько из видов Eulemur. Все особи, чьи образцы использовались в ходе исследования, умерли от естественных причин в возрасте от 16.6 до 34.0 лет (другими словами, для данного исследования лемуров никто не умерщвлял). 

Результаты исследования
В ходе исследования образцов мозга использовались радиолиганды 125I-OVTA и 125I-LVA, которые продуцируют различные схемы связывания в мозге лемуров.Радиолиганд — биохимическое вещество (в частности, лиганд с радиоактивной меткой), которое используется для диагностики или для исследования рецепторных систем организма.Как и в случае с человекообразными обезьянами, для низших приматов необходимо конкурентное связывание с антагонистом AVPR1a, чтобы точно идентифицировать области связывания OXTR.Антагонист — подтип лигандов к клеточным рецепторам, который блокирует, снижает или предотвращает физиологические эффекты, вызываемые связыванием агониста. 

Агонист — лиганд, который при взаимодействии с рецептором меняет его состояние, приводя к биологическому отклику.В данном труде используемый 125I-OVTA позволят помечать как OXTR, так и AVPR1a. SR49059 (антагонист AVPR1a) и ALS-II-69 (антагонист OXTR) значительно снижали связывание 125I-OVTA в центральном ядре миндалины (CeA от central amygdala), прилежащем ядре (NAcc от nucleus accumbens) и спинномозговом ядре тройничного нерва (Sp5).Центральное ядро ​​миндалины (CeA) — кластер нейронов (ядро) внутри миндалевидного тела. CeA соединяется с областями ствола мозга, которые контролируют выражение врожденного поведения и связанные с ним физиологические реакции. CeA отвечает за физиологические проявления эмоций (изменение сердцебиения, давления, дыхания и т.д.).Прилежащее ядро (NAcc) — группа нейронов в вентральной части полосатого тела (относится к базальным ядрам мозга). NAcc участвует в процессах, связанных с вознаграждением, удовольствием, смехом, зависимостью, агрессией, страхом и эффектом плацебо.Спинномозговое ядро тройничного нерва (Sp5) — кластер нейронов в продолговатом мозге (задний отдел головного мозга), принимающий информацию о боли, температуре и прикосновениях, ощущаемых лицом.Антагонист AVPR1a значительно снижал связывание 125I-LVA в CeA, в Sp5 и в первичной зрительной коре (V1). Но вот антагонист OXTR в этих же областях мозга никак не влиял на связывание 125I-LVA.Первичная зрительная кора (V1) — часть коры больших полушарий мозга, которая отвечает за обработку визуальной информации.Столь избирательное влияние на связывание 125I-LVA антагонистом AVPR1a показало, что 125I-LVA селективно связывается с AVPR1a, а не с OXTR у лемуров. Тогда как 125I-OVTA способен связываться с обоими подтипами рецепторов в некоторых регионах мозга.

Что касается SR49059 (антагонист AVPR1a) и ALS-II-69 (антагонист OXTR), то они показали разное влияние на OXTR и AVPR1a в зависимости от концентрации. 

В совокупности вышеописанный анализ с применением радиолигандов позволяет оценить распределение и концентрации как OXTR, так и AVPR1a в образцах мозга лемуров.


Изображение №2: распределения OXTR (A) и AVPR1a (B) в последовательных корональных срезах головного мозга немоногамного вида (E. macaco); снимки с контрастом AChE (C). 

Сильное связывание 125I-OVTA в присутствии антагониста AVPR1a можно было обнаружить лишь в некоторых областях мозга (2A, 3A и 3D), среди которых: паравентрикулярное ядро ​​таламуса (PVNth, участвует в формировании поведенческих реакций; 343.48 ± 39.17), первичная зрительная кора (V1; 86.66 ± 17.33), префронтальная кора (PFC; 76.82 ± 12.50), медиодорсальное ядро таламуса (MD Thal; 72.66 ± 32.97) и обонятельная луковица (Olf, которая имеется лишь у немоногамных видов; 61.99 ± 26.88).Префронтальная кора (PFC) — отдел коры больших полушарий головного мозга, участвующий в управлении мыслительной и моторной активности в соответствии со внутренними целями и планами.Медиальное дорсальное ядро таламуса (MD Thal) — кластер нейронов, участвующий в обработке болевой информации, формировании памяти (теоретически) и в саккадных движениях глаз.Обонятельная луковица (Olf) — часть обонятельного мозга, расположенная во внутричерепной полости между лобной долей сверху и решетчатой пластинкой решетчатой кости снизу. Olf участвует в восприятии запахов.В гипоталамусе наблюдалось довольно умеренное связывание OXTR. Но вот основным отличием Eulemur от образцов мозга полевок стало отсутствие каких-либо признаков связывания в боковой перегородке (LS) мозга или в ядре ложа терминальной полосы (BNST).Боковая перегородка (LS) — область мозга, соединяющая отдел гиппокампа (а именно CA3) с вентральной тегментальной областью. За счет этого осуществляется связь сигналов вознаграждения с контекстом, в котором они возникают.Ядро ложа терминальной полоски (BNST) — область миндалевидного тела мозга, отвечающая за обработку лимбической информации (страх, агрессия и т.д.).


Изображение №3: распределения OXTR (A и D) и AVPR1a (B и E) в последовательных коронарных срезах головного мозга моногамного вида (E. rubriventer); снимки с контрастом AChE (C и F).

Связывание AVPR1a, в отличие от OXTR, в мозге лемуров было гораздо более распространенным и было обнаружено в большем числе отделов мозга (2B, 3B и 3E).

В присутствии антагониста OXTR было обнаружено плотное связывание 125I-LVA в образцах в PFC (126.33 ± 17.43), V1 (116.80 ± 7.92) и в дугообразном ядре (Arc; 231.13 ± 43.40).Дугообразное ядро (Arc) — кластер нейронов медиобазального гипоталамуса, участвующий в гомеостазе.Также подобная картина наблюдалась и в нескольких областях лимбической системы (LS — 299.54 ± 45.03; BNST — 162.10 ± 13.73 и CeA — 170.28 ± 13.38), в таламусе (111.70 ± 20.97), в метаталамусе (MGN; 137.80 ± 18.57) и в стволе мозга (PAG (центральное серое вещество) — 119.40 ± 15.77 и Sp5 — 88.38 ± 18.56).

Собранные данные позволяют провести сравнительный анализ, который может объяснить причину моногамии некоторых видов внутри по большей степени полигамного рода или семейства.

Для этого были выбраны определенные области мозга грызунов (NAcc, PFC, LS и BNST) и обезьян тити (Hipp, LS, и CeA), которые в теории отвечают за формирование пар особей.


Обезьянки тити (Калифорнийский национальный центр исследования приматов, США).

В ранее проведенных исследованиях мозга грызунов указывалось на то, что связывание OXTR у моногамных особей происходит лучше, однако особых отличий в образцах моногамных и полигамных особей лемуров не было обнаружено.


Изображение №4: совокупность плотностей связывания по областям мозга у разных видов лемуров. Столбцы отображают среднюю плотность связывания в образцах мозга моногамных и немоногамных видов. Пустые ячейки указывают на отсутствие доступных измерений связывания радиолиганда в этой области.

Кроме того, во всех образцах в медиальном ядре миндалины не было обнаружено значительного связывания. В других же ядрах миндалины, где присутствовал OXTR, различия между моно- и полигамными видами было несущественным. Такая же картина наблюдалась и в участках NAcc, Hipp и PFC. Также не было выявлено значимых различий в связывании AVPR1a в исследуемых областях мозга грызунов и обезьян тити. 

Единственной областью, где наблюдались значительные различия OXTR между моно- и полигамными особями, было ретикулотегментное ядро (область в пределах среднего мозга), которое показало более сильное связывание у моногамных особей, чем у немоногамных. Что касается AVPR1a, то значительные отличия наблюдались в вентральном переднем таламусе и в префронтальной коре. В этих областях связывание AVPR1a также было значительно выше именно у моногамных видов.

Из вышеописанных результатов следует вывод, что предыдущие исследования, утверждающие, что грызуны могут случить лекалом формирования пар для других существ, не являются верными. В ходе данного исследования не было обнаружено каких-либо отличий в схемах распределения рецепторов окситоцина и вазопрессина среди моногамных и полигамных представителей рода Eulemur. Другими словами, то, что для грызунов является верным объяснением моногамии, нельзя применить к приматам. 

Для более детального ознакомления с нюансами исследования рекомендую заглянуть в доклад ученых и дополнительные материалы к нему.

Эпилог
В ходе данного труда было установлено, что распределение и плотность некоторых рецепторов окситоцина и вазопрессина отличается в зависимости от видовой принадлежности. Данные химические соединения присутствуют в разных участках мозга, что свидетельствует об их разных функциях, зависящих не только от положения, но и от клеток, на которые они воздействуют.

Несмотря на то, что предыдущие выводы, сделанные на основе опытов с грызунами, были опровергнуты в ходе данного исследования, ученым все же удалось установить ряд отличий между моногамными и полигамными видами внутри общего рода Eulemur. Проявляются эти отличия именно в схемах связывания окситоцина и вазопрессина в различных участках мозга.

В дальнейшем ученые намерены провести более практические опыты с живыми особями. Их интересует, как изменится поведение особи по отношению к своему партнеру и к другим особям, если активность окситоцина или вазопрессина будет искусственно подавлена. 

Как заявляют сами ученые, на данный момент окситоцин можно считать истинным секретом любви, но только для полевых мышей. С приматами, не говоря уже про людей, дела обстоят куда сложнее. А посему требуется еще немало опытов, исследований и тестов, чтобы установить истинные причины моногамии.

Вполне вероятно, что единого ответа нет, как нет и единого фактора, влияющего на моногамию/полигамию того или иного вида. К тому же не стоит забывать и внешние факторы (экология, доступность пищи, хищники и т.д.).

Как бы человек не хотел понять все, что его окружает, есть нечто, что объяснению не поддается (по крайней мере пока). Вполне вероятно, что любовь и верность относятся именно к таким необъяснимым, но все же прекрасным явлениям.


Пятничный офф-топ:

Семейство лемуров во главе с Ритой и Маугли, живущее в зоопарке Фридрихсфельде (Берлин, Германия).


Благодарю за внимание, оставайтесь любопытствующими и отличных всем выходных, ребята! :)

Немного рекламы 
Спасибо, что остаётесь с нами. Вам нравятся наши статьи? Хотите видеть больше интересных материалов? Поддержите нас, оформив заказ или порекомендовав знакомым, облачные VPS для разработчиков от $4.99, уникальный аналог entry-level серверов, который был придуман нами для Вас: Вся правда о VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps от $19 или как правильно делить сервер? (доступны варианты с RAID1 и RAID10, до 24 ядер и до 40GB DDR4).

Dell R730xd в 2 раза дешевле в дата-центре Maincubes Tier IV в Амстердаме? Только у нас 2 х Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 ТВ от $199 в Нидерландах! Dell R420 — 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB — от $99! Читайте о том Как построить инфраструктуру корп. класса c применением серверов Dell R730xd Е5-2650 v4 стоимостью 9000 евро за копейки?",12
2022-08-16,Психология звука в нейминге: как назвать компанию или продукт,https://www.habr.com/ru/post/682772/,"Выбирая название для своей компании, стоит подумать о благозвучности. Это имеет огромное значение для восприятия бренда целевой аудиторией. Нейминг, созданный с учетом психологии звука, привлекает больше внимания, быстрее запоминается, надолго остается в подсознании. Как дать удачное название бренду, продукту, сайту, стоит ли использовать фоносемантику, разберем в этой статье. Звук в неймингеРаньше бизнесмены не придавали большого значения названию компании. Однако с каждым годом ситуация меняется. Любой предприниматель пытается выделиться на рынке и стать «любимчиком». С 2000-х годов основным трендом в сфере нейминга были иностранные слова, в частности компании называли с использованием латиницы. Сейчас тактика изменилась, русскоязычные названия вновь набирают популярность, особенно в свете последних политических событий.Звучание в нейминге – это важно. Оно влияет на имидж бренда, восприятие продукта. Неймер-профессионал обязательно проверит наименование на благозвучность. Каждый звук имеет свои характеристики и оказывает воздействие на человека. В том числе побуждает к определенным действиям. Поэты часто используют звуки, чтобы передать настроение стихотворения, погрузить читателя в описываемую атмосферу:«Шипенье пенистых бокалов и пунШа пламень голубой», А.С. Пушкин, «Медный всадник».«ГРохочет эхо по ГоРам, как ГРом, ГРемящий…», Г.Р. Державин, «Водопад».В первом примере сразу слышится шипение пузырьков игристого в бокале. Во втором – атмосфера грозы и гремящие раскаты грома, громкий звук, от которого разносится эхо. Многие знакомые нам бренды были названы с учётом психологического восприятия звуков, например Schweppes. Вы наверняка сразу представляете пузырьки газировки, которые с характерным звуком покидают бутылку. А теперь ответьте на вопрос, какой фигуре соответствует слово «кики»? А слово «буба»?95% процентов ответят, что «кики» − это вторая фигура, а «буба» − первая. Объяснить, почему именно так, трудно. Это исследование в 1929 году провел психолог Вольфганг Келер. Правда, наименования звучали иначе. В 2001 году неврологи из Америки повторили исследование, используя слова «буба» и «кики». Результат был аналогичным.Знаменитый слоган «Mmm Danon» также является фонетически сильным. Он сразу вызывает ассоциации с наслаждением, легкостью. Именно этого эффекта добивался производитель творожков. Проведено огромное количество исследований и все они доказывают, что звук – это важно. Одно из интересных наблюдений: иностранцы, не зная значения слов, предпочитают мягкие и звучные названия (например, лилия, поляна) твердым и грубым (например, ворота, кружка). Если вы планируете выйти на иностранные рынки, то учитывать нужно звучание на всех языках и смысловое наполнение.Расскажем на звуках.Подбирая правильные звуки, можно не только дать успешное имя компании, но и расположить к себе человека. Зная о характеристиках звуков, вы с легкостью напишете речь для своего выступления, и она вызовет соответствующие эмоции. А чтобы имя компании красиво звучало, работало на вас и создавало нужные ассоциации, нужно проверить:Легко ли прочитать название потенциальному клиенту?Сможет ли клиент без труда воспроизвести нейминг вслух или на бумаге?Красиво ли звучит наименование?Немного ли слогов в словах?Не вызывает ли имя неприятных ассоциаций?Легко ли имя можно адаптировать к иностранному рынку?В основном звуки имеют одинаковое значение во всех языках, поэтому на их характеристики можно полагаться, если вы в будущем планируете выход на мировой рынок. Более того, российский лингвист Журавлев установил связь между звуками и цветами:  [а] – густо-красный, [я] – ярко-красный, [о] – светло-желтый, белый, [е] – зеленый и т.д. Этот факт говорит о том, что звуки способны вызывать ассоциации, создавать цветовую картинку, передавать настроение, и неважно, в каком языке их употребляют.Разберем подробно несколько самых часто встречающихся звуков в нейминге.Звук РПрочитайте список слов: рука, кровь, дар, мрак, нора, мрамор, рупор. Первое, что остается в памяти – звонкий, резкий звук «р». Человек, слыша название с «р», может почувствовать тревожность. Для некоторых отраслей такой эффект будет только на руку, но не для всех. Обычно «р» пытаются смягчить или использовать в словах с позитивной эмоциональной окраской: «Рассвет», «Релакс», «Роса», «Радуга», «Русь». Кстати, открытый звук [ра] побуждает человека совершить действие, открыться: «Рай», «Краб». Звук АЭтот звук считается самым простым и универсальным в любом языке мира. Он яркий и энергичный. Если ваша компания должна ассоциироваться с динамикой, то обязательно используйте в нейминге этот звук. Кстати, во многих названиях компаний, связанных со спортом, этот прием показал себя с лучше стороны: Адидас, Пума, Найк. Ярко выглядят слова: «Аист» − для магазина детской одежды, «Вилка» − для ресторана.Звук ЯЭтот звук также заставляет действовать, проявлять активность, но в нем есть некоторая эгоистичность. Прекрасно подходит для наименований элитных брендов, уникальной продукции и роскошных вещей: «Ягуар», «Яхонт», «Японика», «ЯППИ», «Якоб».Звук ДЗвук [д], несмотря на твердость, отлично подходит для нейминга детских товаров и женских брендов: «Диадема», «Диалог», «Динамика», «Медвежонок», «Наши дети». Он создает прямые ассоциации, делая название ярким, подвижным. Этим воспользовался КинДеР-сюРпРиз. Ранее мы говорили о том, что звук [р] – сложный и не всегда уместный, но при умелом сочетании он может добавить активности названию. Этот нейминг рассчитан на детскую аудиторию. К тому же слоган создан по такому же принципу: КинДеР СюРпРиз всегДа ДаРит РаДость.Исследователи выделили ряд звуков, которые помогают рассказать о размере, масштабе, половой принадлежности целевой аудитории и других характеристиках:Е, Э, И, Ч, Ф, Х, К (глухой), П (глухой), С, Ш, Т (глухой), В (фрикативный) – образ маленького размера, цвет – светлый, пол – мужской;О, У, А, Б, Д, Г, Ж, П (смычный), Л, М, В (звонкий), Н, Р, Т (смычный), Й, З, К (смычный) – образ большого размера, цвет – темный, пол – женский.Если нужно придумать название для небольшого бутика мужской одежды, лучше использовать первую группу. Примеры неологизмов: ФИКЭШ, ХЕТИЧ, СИТИШЕФ. Если нужно придумать название для большого магазина элитной женской косметики, то лучше использовать вторую группу: МУРМАРИ, ЛУРМУНО, БАДЖУ.Все вышеперечисленные названия придуманы исключительно, чтобы продемонстрировать возможности создания нейминга на основе предлагаемой информации, любые совпадения случайны. Некоторые исследователи утверждают, что название бренда, целевой аудиторией которого являются мужчины, должно оканчиваться на согласную, соответственно для женщин – на гласную букву. Кстати, ОДЖИ – это российская компания, которая использует в своем названии итальянское слово «сегодня», при этом оно относится ко второй группе и отлично характеризует большую сеть изначально женской, а впоследствии молодежной одежды.Помимо этого, при визуальном восприятии внимание обращают на очертания букв:Угловатые буквы подходят для наименований предметов с углами, острых изделий или брендов, которые хотят создать устойчивый и серьезный образ.Округлые буквы подойдут для наименований круглых и гладких предметов, мягких изделий и брендов, которые хотят создать уютный, дружелюбный образ.В исследованиях можно найти интересную закономерность. Угловатые буквы помогают мыслить конкретно, а округлые – абстрактно. Таким образом, если бренд настроен на краткосрочную выгоду использовать в названии лучше первую группу, а если на долгосрочную выгоду, то вторую. К тому же значение имеет количество букв:  короткое наименование подходит для продукта или бренда, который транслирует быстрое решение или небольшой объем, а также представляет собой эксклюзив;длинное наименование передаст сложность, экспертность и грандиозность бренда, компании или продукта. Что важно?Наиболее удачными названиями с точки зрения создания ассоциаций и охраноспособности являются неологизмы, которые не имеют собственного смысла. Это «чистый лист», который вам необходимо самостоятельно заполнить и представить потребителю. В этом случае характеристики звуков точно придут на помощь. К тому же зарегистрировать такое название легче, шанс, что кто-то уже придумал схожее наименование, минимальный. Однако такой вариант нужно выбирать при большом бюджете. Заполнять смыслом – дорого. К тому же не рекомендуется использовать неологизмы для нейминга одного продукта, лучше оставить этот прием для наименования компании. Товар должен иметь понятное название, чтобы его купили, а бренду можно добавить загадочности.При ограниченном бюджете стоит подумать о названии, которое не только будет хорошо звучать, но и сможет самостоятельно вызывать необходимые ассоциации. Обязательно проверьте нейминг по нескольким критериям:посмотрите перевод на основные мировые языки или языки тех стран, в которых будет работать ваш бренд;проверьте охраноспособность наименования: соответствие критериям Роспатента и уникальность;узнайте, есть ли похожие или тождественные домены, если планируете создать собственный сайт;подумайте, уместно ли название для вашей сферы деятельности.Самое главное – название должно запоминаться потребителям, вызывать нужные ассоциации, быть охраноспособным. Мы не рекомендуем упираться в фоносемантику и опираться исключительно на нее. Нужно найти золотую середину, тогда психология звука поможет вам создать действительно удачный и продающий нейминг. ",4
2020-08-19,Движение это жизнь: кинематика сперматозоидов,https://www.habr.com/ru/company/ua-hosting/blog/515582/,"

Человеческий организм можно без преувеличения причислить к ряду самых сложных биологических систем на планете. Наше тело состоит из миллиардов клеток, множества органов и систем. Но все это великолепие и разнообразие возникли благодаря слиянию лишь двух клеток — сперматозоида и яйцеклетки. Думаю, в пояснении, как происходит оплодотворение и что для этого требуется, нет необходимости (подсказка — аисты и капуста тут ни при чем). Но вот некоторые аспекты из жизни сперматозоидов долгие годы оставались неясными. Ученые из Бристольского университета, используя современные методики трехмерной микроскопии, смогли рассмотреть движения сперматозоида так, как это не удавалось ранее. Как и за счет чего движется сперматозоид мы узнаем из доклада ученых. Поехали.

Основа исследования 
Несмотря на то, что сперматозоиды участвовали в создании жизни задолго до появления научного метода, их путь в научной литературе начался достаточно недавно — в 1677 году. Студент медицинского университета Иоганн Гам поделился своими наблюдениями с коллегой и другом Антони ван Левенгуком (1632 — 1723), который в свою очередь детально рассмотрел и описал «семенных зверьков» (так он назвал сперматозоиды). 


Антони ван Левенгук / Ладзаро Спалланцани / Карл Эрнст фон Бэр

Левенгук предположил, что эти необычные клетки участвуют в оплодотворении, однако его теория, хоть и правдивая, была отвергнута научным сообществом. Еще долгое время считалось, что сперматозоиды это паразиты, а оплодотворением занимается исключительно семенная жидкость. 

Лишь спустя почти сто лет, в 1786 году, факт участия сперматозоидов в оплодотворении был доказан Ладзаро Спалланцани (1729 — 1799) в его работе «Experiencias Para Servir a La Historia de La Generación De Animales y Plantas». Однако его объяснения самого процесса были достаточно туманны: он считал, что яйцеклетка уже является началом нового организма, а сперма нужна лишь для активации процесса роста. 

Сам же термин «сперматозоид» ввел в начале XIX века Карл Эрнст фон Бэр (1792 — 1876). 

Что бы там ни думали ученые несколько веков назад, сперматозоиды имеют вполне четкую функцию, выполнение которой обеспечивается рядом специализированных инструментов. Главная задача сперматозоида человека — пройти через половые пути женщины, найти яйцеклетку и передать ей генетический материал мужчины. 


Строение сперматозоида

Мужская половая клетка похвастаться габаритами не может, ибо является самой малой в теле человека (если не учитывать хвост): размеры головки составляют 5.0х3.5х2.5 мкм (длина х ширина х высота), длина средней части — 4.5 мкм, а длина хвоста — 45 мкм.

При этом малые размеры не являются минусом, а продуманным аспектом повышения его скорости. В процессе созревания сперматозоида его ядро (несет в себе одинарный набор хромосом) уплотняется, большая часть цитоплазмы выбрасывается, а в клетке остаются только самые важные органеллы. 

Вторым по важности после ядра элементом сперматозоида можно без особых сомнений назвать жгутик, т.е. его хвост. Ибо именно благодаря ему осуществляется движения данной клетки по половым путям женщины. Забавно и то, что среда влагалища крайне губительна для мужских половых клеток, однако семенная жидкость частично снижает негативный эффект, воздействующий на сперматозоиды. Уровень рН внутри женских половых путей позволяет направлять движение сперматозоидов по направлению к матке, где их ждет куда более благоприятная среда. 

Ранее считалось, что сперматозоид движется вперед за счет симметричного перемещения своего жгутика из стороны в сторону.


Изображение №1: асимметрия движения жгутика в 3D (сверху); плоская проекция движения жгутика, создающая оптическую иллюзию двусторонней симметрии в 2D-микроскопии (снизу). 

Это утверждение высказывалось еще во времена Левенгука. А также привело к симметричной идеализации формы волны в трех измерениях, часто воспринимаемой как коническая спираль, похожая на расширяющийся штопор.

Ввиду двумерной микроскопии многие наблюдения были истолкованы неточно, а порой и совсем неверно. Утверждения касательно симметричности взмахов жгутика противоречит многим наблюдениям, показывающим структурную асимметрию внутри каркаса самого жгутика. 

Если взмахи жгутика сперматозоида во время движения все же асимметричны, то как тогда достигается симметрия движения жгутика из стороны в сторону и движение клетки по направлению вперед? Именно этот вопрос и является основным в данном исследовании.

Для получения ответа на него, ученые сопоставили молекулярные и микроскопические наблюдения, показавшие, что сперматозоид человека использует как асимметричный, так и анизотропный контроль для регулирования взмахов жгутика. Другими словами, симметрия реализуется за счет асимметрии: возникает эффект «прецессирующего волчка», когда головка вращается («сверля жидкость», слова авторов) одновременно и независимо от того, как жгутик сперматозоида вращается вокруг оси движения.

Результаты исследования
Быстрое движение жгутиков сперматозоидов человека было зарегистрировано с высоким пространственно-временным разрешением в 3D. Были исследованы две группы свободно плавающих сперматозоидов в жидкости с низкой вязкостью: сперматозоиды, плавающие рядом с покровным стеклом (ложится сверху образца во время микроскопии) и вдали от него.


Изображение №2

На 2А и 2С показаны взмахи жгутика сперматозоида, плавающего вблизи и вдали от покровного стекла. Взмахи жгутика характеризуются характерным перекатывающим движением вокруг направления движения сперматозоида.

Комбинированное вращение и поступательное движение жгутика сперматозоидов приводит к спиралевидным траекториям средней точки жгутика с сохраненной хиральностью (отмечено красным на 2А и 2С). Сперматозоиды демонстрируют двунаправленное вращение вокруг своей оси: все свободно плавающие клетки (28 штук) вращались против часовой стрелки, если смотреть с переднего конца (стрелки на 2B и 2D) и лишь 2 клетки вращались по часовой стрелке (они не двигались вперед из-за препятствий на их пути).


Микроскопия сперматозоидов, плавающих рядом с покровным стеклом (соответствует 2А).

Все сперматозоиды (30 клеток) двигались аналогично прецессирующему вращающемуся волчку, в котором вращение головки вокруг продольной оси сперматозоида (ωspin), происходит одновременно и независимо от того, как вращается жгутик относительно оси движения (ωroll).

На 2В и 2D показаны взмахи жгутика с точки зрения сопутствующей системы координат*, то есть в точке обзора, движущейся вместе со сперматозоидом, но не вращающейся вокруг своей оси движения. Это показывает, что взмахи жгутика крайне симметричны как в плоскостном (xy), так и во внеплоскостном (z) направлениях, что соответствует наблюдениям в 3D.Сопутствующая система отсчета* — система отсчета, связанная с рассматриваемым телом в определенный конкретный момент. Тело внутри этой системы неподвижно. Например, свободно падающий лифт является сопутствующей системой отсчета для свободно падающего в нем тела, а вот Земля не является таковой системой по отношению к телу в лифте.Проекция траектории середины жгутика (красные линии на 2В и 2D) показывает невероятное множество геометрических узоров, от вращающихся звезд до треугольников, квадратов и петлевых узоров с полярной симметрией. Неправильный узор жгутиков, показанный на 2D для сперматозоидов, плывущих от покровного стекла, также наблюдается и для сперматозоидов, плавающих рядом с покровным стеклом. Такая изменчивость в узорах может быть вызвана несовпадением фазового запаздывания между плоскостными и внеплоскостными компонентами взмаха для каждой клетки, которые увеличиваются во временной шкале перекатывающегося движения. Следовательно, жгутиковые узоры не являются отличительной чертой клеток, плавающих вблизи и далеко от покровного стекла.


Микроскопия и моделирование жгутика, показывающие вращение головки и жгутика вокруг оси движения. 

Амплитуда трехмерной волны характеризуется симметричной огибающей в форме пули кривой, в отличие от конической спирали (похожей на расширяющийся штопор), которая часто описывается в литературе. Сперматозоиды, плавающие далеко от покровного стекла, имели более симметричную форму волны, чем клетки, плавающие рядом со стеклом. Таким образом, расположенное рядом покровное стекло является слабым источником асимметрии для взмахов жгутика.

Сперматозоиды, плавающие рядом с покровным стеклом, имели сохраненный угол атаки* -7°, со средней ориентацией жгутика сперматозоидов, направленной к покровному стеклу.Угол атаки* — угол между направлением вектора скорости набегающего на тело потока (жидкости или газа) и характерным продольным направлением, выбранным на теле.
Изображение №3

На изображении выше показано сравнение взмахов жгутика в сопутствующей системы отсчета (верхний ряд) и сопутствующей системы отсчета качения (нижний ряд).

На 3E показана истинная природа биения жгутика, как видно с точки зрения сперматозоида, без каких-либо сдвигов при плавании и качении.

Сопутствующая система отсчета качения (3E) показывает, что взмахи жгутика являются анизотропными, т.е. характеристики волны в каждом поперечном направлении (перпендикулярные плоскости взмаха), обозначенные «b плоскость» (синяя плоскость) и «z плоскость» (красная плоскость), заметно отличаются.

Если сравнить светло-серые области на синей и красной плоскостях на 3Е, то видно, что взмахи сильно асимметричны в b плоскости и им характерна нарушенная симметрия влево-вправо, напоминающая C-образную форму.

Данное наблюдение сильно контрастирует с симметричными картинами, наблюдаемыми в сопутствующей системе отсчета на 3A.


Форма волны жгутика относительно лабораторной фиксированной системы отсчета (x, y, z). 

Анализ основных компонентов (PCA) трехмерной формы волны позволил ученым разложить взмах жгутика на несколько «основных режимов формы», называемых здесь режимами PCA. Трехмерную форму волны можно восстановить с хорошей точностью только с двумя режимами формы, как видно с 3B и 3F.

На 3C видно, что первые два режима PCA идентичны по форме, вплоть до поворота на 90°, таким образом фиксируя обтекаемую спиральную форму, вызванную качением сперматозоидов.

На 3G, однако, внутренняя асимметричная C-форма полностью обнаруживается только первым режимом PCA. Второй режим PCA на 3G (отмечено оранжевым) вносит небольшие отклонения перпендикулярно первому режиму PCA (отмечено синим), указывая на то, что форма волны может быть разложена на два независимых поперечных направления взмаха, анизотропных по своей природе.

Фурье анализ взмахов позволил реконструировать движение жгутика, используя только два режима Фурье на 3D и 3H. Если коротко, то каждый общий сигнал взмаха может быть аппроксимирован простой суммой двух функций:fr(s, t) ≈ f0(s) + |f1(s)| sin(ωt + φ(s))Первая функция f0(s) не зависит от времени, его называют «статическим режимом», и он фиксирует усредненную асимметрию сигнала по длине дуги (s) жгутика.

Вторая функция — это синусоидальная бегущая волна, называемая «динамическим режимом», колеблющаяся с частотой, захваченной первым пиком спектра мощности сигнала.

Амплитуда и фазовая модуляция бегущей волны вдоль жгутика равны, соответственно, |f1(s)| и φ(s) = arg(f1(s)).

Таким образом, фаза несет информацию о характеристиках бегущей волны. Например, если фаза φ(s) не изменяется вдоль s, то сигнал не является бегущей волной, а скорее стоячей волной.

Следовательно, статический режим фиксирует любое несоответствие формы сигнала. В таком случае черная прямая линия на 3D отражает симметрию взмаха в плоскостях xy и xz в сопутствующей системе отсчета. Напротив, в сопутствующей системе отсчета качения (3Н) статический режим (черная кривая) характеризуется большой асимметричной амплитудой, напоминающей перевернутую C.


Форма волны жгутика относительно сопутствующей системы отсчета.


Форма волны жгутика относительно сопутствующей системы отсчета качения.

Динамический режим в сопутствующей системе отсчета (красные кривые) на 3D имеет большую амплитуду и является высокосимметричным в плоскостях xy и xz из-за качения сперматозоидов.

А вот динамический режим в сопутствующей системе отсчета качения (красные кривые) на 3H имеет уменьшенную амплитуду формы волны и предпочтительное направление движения.

Фурье-реконструкция формы волны была выполнена за счет суммирования статического и динамического режимов (графики в центре на 3D и 3H), что хорошо согласуется с исходными наблюдениями (графики справа на 3D и 3H).


Изображение №4

Графики выше показывают результаты Фурье анализа трехмерного взмаха жгутика в свободно плавающей популяции сперматозоидов (20 клеток рядом с покровным стеклом и 8 вдали от стекла). В сопутствующей системе отсчета (4А-4С) амплитуды статического режима в обоих направлениях (yc и zc) очень малы (верхний ряд графиков на 4B и 4C) из-за симметрии взмахов. 

Кроме того, амплитуда (средний ряд) и фаза (нижний ряд) динамических режимов (yc и zc) на 4B и 4C фиксирует поперечную симметрию и превышает изотропию в этой системе отсчета из-за того, что сперматозоид вращается вокруг оси движения.

Характеристики бегущей волны для обеих координат (yc и zc) одинаковы для всех свободно плавающих клеток: частота 4 Гц, длина волны 100 мкм и скорость волны 400 мкм/с.

В сопутствующей системе отсчета качения (4D-4F) отчетливые статические режимы в b и z плоскостях показывают, что взмахи все же имеют анизотропию в свободно плавающей популяции клеток (4Е и 4F).

Статический режим b плоскости (ycr) сильно асимметричен и смещен в сторону положительных значений (верхний ряд графиков на 4Е). А вот для z плоскости (zcr) он колеблется симметрично вдоль длины дуги синусоидальным образом (верхний ряд на 4F).

Амплитуда динамического режима в b плоскости (y1cr) увеличивается до выхода на плато (средний ряд на 4E), в то время как динамический режим в z плоскости (z1cr) немонотонен по длине дуги (средний ряд на 4F). Характеристики бегущей волны ycr (b плоскость) составили: частота 8 Гц, длина волны 145 мкм и скорость волны 1120 мкм/с. Характеристики бегущей волны zcr (z плоскость): частота 6 Гц, длина волны 1526 мкм, а скорость 5174 мкм/с.

Небольшие изменения фазы на больших расстояниях по всей длине жгутика требуют очень высоких скоростей распространения волн. Следовательно, колебания z плоскости фактически ведут себя как стоячая волна, пульсирующая во времени.


Микроскопия не продвигающихся вперед и крутящихся сперматозоидов.

Совокупность вышеописанных данных говорит о том, что взмахи жгутиков используют два коактивных анизотропных поперечных регулятора, которые не слишком отличаются от бегущих электромагнитных волн. Однако каждая поперечная волна (ycr, zcr) представляет собой сумму статического и динамического режимов: асимметричной бегущей волны вдоль b плоскости (синий на 4D) и симметричной стоячей волны в z плоскости (красный на 4D).

Любопытно (но не удивительно) и то, что наличие рядом с траекторией движения сперматозоида покровного стекла также имеет свое влияние на амплитуду распространения волны.


Изображение №5

Стекло снижает амплитуду распространения волны из-за гидродинамических взаимодействий между жгутиком и твердой поверхностью покровного стекла.

В сопутствующей системе отсчета (5A и 5B) амплитуда обоих динамических режимов (yc, zc) уменьшается по направлению к концевой части жгутика для сперматозоидов рядом с покровным стеклом (графики в центре), в то время как статические режимы остаются без изменений (графики сверху).

Динамический режим zc лишь немного меньше yc (синие кривые) на графиках в центре 5A и 5B. Это контрастирует с симметричными, неизменными профилями обоих (yc, zc) динамических режимов для сперматозоидов, обнаруженных вдали от стекла (красные кривые на графиках в центре 5А и 5В).

Если же обратить внимание на сопутствующую систему отсчета качения, то природа влияния стекла достаточно анизотропна, поскольку оно влияет лишь на одну плоскость качения, т.е. на b плоскость (5C).

Покровное стекло влияет как на статические, так и на динамические режимы ycr (график вверху и в центре на 5С). А вот z плоскость (zcr) остается неизменной (график вверху и в центре на 5D).

Форма статического режима в сопутствующей системе отсчета качения одинакова среди всех сперматозоидов и определяет смещенную от центра правостороннюю спираль, обозначенную h(s) и показанную черной кривой на 5E. Проекция спирали на плоскость качения (зеленая плоскость) представляет собой спираль, направленную против часовой стрелки, которая не имеет полярной симметрии, т.е. смещена в одну сторону (серая проекция на 5E).

Спирали статического режима сильно напоминают логарифмические спирали, которые часто встречаются в природе. Однако в данном случае радиус спирали изменяется немонотонно, увеличиваясь/уменьшаясь с большей скоростью, чем у логарифмических спиралей где-либо еще в природе.

Правосторонняя логарифмическая спираль h(s) на 5E может быть выражена через ее радиус и тангаж (5G), который экспоненциально затухает по длине жгутика. Любое изменение знака в hy или hz приводит к переключению спирали на вращение по часовой стрелке, создавая таким образом левостороннюю спираль. Все свободно плавающие сперматозоиды генерировали спирали против часовой стрелки. Лишь два сперматозоида имели спирали по часовой стрелке, хотя и с формой, идентичной 5E. Именно эти две клетки не могли плыть вперед из-за каких-то препятствий на своем пути, однако могли и дальше вращаться вокруг собственной оси кручения.

Во всех случаях вращение спирали коррелирует с направлением качения сперматозоидов следующим образом: спираль против часовой стрелки для вращения по часовой стрелке (если смотреть с заднего конца) и спирали по часовой стрелке для вращения против часовой стрелки.


Изображение №6

Графики 6А и 6В показывают сложную последовательность бегущих волн, когда жгутик вращается вокруг своей оси качения. Изгибные волны распространяются линейно вдоль жгутика с немонотонной амплитудой по длине дуги, характеризующейся резким увеличением в средней части и дистальных областях.

Кручение формы волны характеризуется резкими поворотами по длине дуги (6B и 6C) с одновременными положительными и отрицательными витками. Спиральная форма центральной линии жгутика подвергается феномену, посредством которого участки противоположной хиральности вдоль жгутика сосуществуют. Однако, части жгутика с противоположной хиральностью перемещаются во время взмахов (6C и 6E). Бегущие волны кручения распространяются с той же скоростью, что и волна кривизны.


Изображение №7

Чтобы лучше понять разницу между результатами трехмерной микроскопии, полученными в данном исследовании, и результатами двумерной микроскопии, которые часто описываются в литературе, ученые создали 2D-проекцию из 3D формы волны.

Статический режим двумерной кривизны весьма незначителен (7F). В 2D не может быть обнаружена внутренняя асимметрия формы сигнала. Вместо этого частотный спектр характеризуется двумя частотными пиками (черные маркеры на 7F), а не одним основным частотным пиком, наблюдаемым для трехмерной кривизны (красная кривая на 7F).

Для более подробного ознакомления с нюансами исследования рекомендую заглянуть в доклад ученых и дополнительные материалы к нему.

Эпилог
В данном труде ученые смогли на практике показать, что за счет трехмерной микроскопии можно узнать то, что не даст двумерная — например, увидеть изменения направления спирали (изменения хиральности) во время колебаний жгутиков. 

На первый взгляд может показаться, что сперматозоиды просто плывут вперед, покачивая своими хвостами. Однако детальное рассмотрение кинематики этих клеток показало, что этот процесс куда сложнее. Взмахи и покачивания жгутиков, вращение самой клетки — все это в совокупности позволяет сперматозоиду двигаться вперед. 

Ранее часть этих сведений была доступна, но не все детали были описаны подробно, ввиду ограниченности двумерной микроскопии. По мнению ученых, понимание того, как именно сперматозоиды двигаются, может сильно помочь в области репродуктивной медицины. В частности новые данные позволят расширить спектр параметров, по которым определяются нездоровые половые клетки мужчины, что является причиной бесплодия у примерно половины пар. 

В любом случае, чем лучше мы понимаем те или иные явления и процессы, особенно происходящие в нашем собственном теле, тем больше вероятность улучшить качество нашей жизнь.

Благодарю за внимание, оставайтесь любопытствующими и хорошей всем рабочей недели, ребята. :)

Немного рекламы 
Спасибо, что остаётесь с нами. Вам нравятся наши статьи? Хотите видеть больше интересных материалов? Поддержите нас, оформив заказ или порекомендовав знакомым, облачные VPS для разработчиков от $4.99, уникальный аналог entry-level серверов, который был придуман нами для Вас: Вся правда о VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps от $19 или как правильно делить сервер? (доступны варианты с RAID1 и RAID10, до 24 ядер и до 40GB DDR4).

Dell R730xd в 2 раза дешевле в дата-центре Equinix Tier IV в Амстердаме? Только у нас 2 х Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 ТВ от $199 в Нидерландах! Dell R420 — 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB — от $99! Читайте о том Как построить инфраструктуру корп. класса c применением серверов Dell R730xd Е5-2650 v4 стоимостью 9000 евро за копейки?",40
